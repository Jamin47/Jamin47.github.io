(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pageBroadcast-view-live"],{"0228":function(n,e){n.exports="data:image/png;base64,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"},"27a5":function(n,e,t){"use strict";var i=t("b98b"),o=t.n(i);o.a},"360f":function(n,e,t){"use strict";t.r(e);var i=t("a3d1"),o=t("acf3");for(var a in o)"default"!==a&&function(n){t.d(e,n,(function(){return o[n]}))}(a);t("27a5");var r,v=t("f0c5"),s=Object(v["a"])(o["default"],i["b"],i["c"],!1,null,"19710d6b",null,!1,i["a"],r);e["default"]=s.exports},"37ba":function(n,e,t){n.exports=t.p+"static/img/ic_empty.ab8186cf.png"},"4d2d":function(n,e,t){"use strict";var i=t("4ea4");t("d81d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=t("c7e5"),a=i(t("93e3")),r=t("6195"),v={data:function(){return{liveForm:{inTask:!1,playType:"liveStatus",operationId:(0,r.uuid)(32,16),volume:50,sampleRate:16e3},authStatus:!0,recorderObj:null,recorderData:{type:"mp3",bitRate:16,sampleRate:16e3,realTime:!0},activeDev:[]}},onLoad:function(){this.loadEngineFn(),this.audioSocketFn()},onShow:function(){var n=this;n.activeDev=a.default.getters.playData.activeDev},onHide:function(){this.liveForm.inTask&&this.stopSubmit()},onUnload:function(){this.liveForm.inTask&&this.stopSubmit()},onNavigationBarButtonTap:function(n){this.pushDevFn()},methods:{loadEngineFn:function(){if(uni.showToast({title:"音频资源加载中...",icon:"loading",duration:1e4,mask:!0}),"function"===typeof window.Recorder)uni.hideToast();else{var n=document.createElement("script");n.src="static/recorder/recorder-core.js",document.head.appendChild(n),n.onload=function(){var n=document.createElement("script"),e=document.createElement("script");n.src="static/recorder/engine/mp3.js",e.src="static/recorder/engine/mp3-engine.js",document.head.appendChild(n),document.head.appendChild(e),uni.hideToast()}}},sliderChangeFn:function(n){this.liveForm.volume=n.detail.value},sliderEndFn:function(n){if(this.liveForm.inTask){var e=this.activeDev.map((function(n){return n.deviceId}));(0,o.$http)("/app/live/updateVolume","post",{deviceIds:e.join(","),volume:this.liveForm.volume,operationId:this.liveForm.operationId})}},pushDevFn:function(){this.liveForm.inTask?uni.showToast({title:"播放状态下不能操作！",duration:2e3,icon:"none"}):uni.navigateTo({url:"../../pageBroadcast/components/sel-device/sel-device"})},palySubmit:function(){this.activeDev.length?(this.liveForm.operationId=(0,r.uuid)(32,16),this.serverslogin()):uni.showToast({title:"请选择播放设备！",duration:2e3,icon:"none"})},audio_start:function(){var n=this,e=this,t=this.activeDev.map((function(n){return n.deviceId})),i={deviceIds:t.join(","),operationId:e.liveForm.operationId,volume:e.liveForm.volume,loginMode:6,encodeType:2};(0,o.$http)("/app/live/oralBroadcastPlay","post",i).then((function(t){e.authStatus=!0,t.code===n.my_config.success_status&&(uni.showToast({title:"开始口播！",duration:2e3,icon:"none"}),e.liveForm.inTask=!0,e.recorderObj.start())})).catch((function(){e.authStatus=!0}))},recorder_start:function(){var n=this;n.recorderObj=window.Recorder({type:n.recorderData.type,sampleRate:n.recorderData.sampleRate,bitRate:n.recorderData.bitRate,onProcess:function(e,t,i,o,a,r){var v=e[e.length-1];n.sendBuffer(new Blob([v],{type:"audio/pcm"}))}}),n.recorderObj.open((function(){n.audio_start()}),(function(e,t){n.authStatus=!0,uni.showToast({title:(t?"UserNotAllow，":"")+"无法录音:"+e,duration:2e3,icon:"none"}),n.recorderObj.close(),n.recorderObj=null}))},stopSubmit:function(){var n=this,e=this.activeDev.map((function(n){return n.deviceId})),t={operationId:this.liveForm.operationId,deviceIds:e.join(","),volume:this.liveForm.volume};(0,o.$http)("/app/live/oralBroadcastStop","post",t).then((function(e){e.code===n.my_config.success_status&&(n.audio_stop(),uni.showToast({title:"停止口播！",duration:2e3,icon:"none"}))}))},audio_stop:function(){var n=this;n.recorderObj.stop((function(e,t){n.recorderObj.close(),n.recorderObj=null,n.liveForm.inTask=!1}),(function(n){console.log("失败："+n)}))},serverslogin:function(){var n={name:a.default.getters.userData.username,token:a.default.getters.userData.token,uuid:a.default.getters.userData.uuid,loginMode:6,encodeType:2,sampleRateInHz:this.recorderData.sampleRate};this.$audioSocket.emit("adminLogin",n)},sendBuffer:function(n){(new Date).getHours(),(new Date).getMinutes(),(new Date).getSeconds(),(new Date).getMilliseconds();var e={uuid:a.default.getters.userData.uuid,name:a.default.getters.userData.username,token:a.default.getters.userData.token,blob:n};this.$audioSocket.emit("MsgToDev",e)},audioSocketFn:function(){var n=this;n.$audioSocket.on("authOk",(function(e){n.authStatus&&(n.authStatus=!1,n.recorder_start())})),n.$audioSocket.on("authError",(function(n){uni.showToast({title:n,duration:2e3,icon:"none"})}))}}};e.default=v},6195:function(n,e,t){t("ac1f"),t("1276");var i=function(n){var e="",t=String(n);return t.length>10&&(e=t.substr(0,3)+"****"+t.substr(7)),e},o=function(n,e){var t,i,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=[];if(e=e||o.length,n)for(t=0;t<n;t++)a[t]=o[0|Math.random()*e];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",t=0;t<36;t++)a[t]||(i=0|16*Math.random(),a[t]=o[19===t?3&i|8:i]);return a.join("")};n.exports={phoneFilter:i,uuid:o}},"7ea2":function(n,e){n.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAVFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU4H24AAAAHHRSTlMAikUyWB1Ud2gtIgqFYAU4EAJufIFCcyoZFk8mhjvBCQAAASBJREFUWMPt10mOwyAQheH3bAcPGAMeEid9/3u2GvegDAvaxcKR+A/wLUoCCuRy75tWNB7y7EzSipnuzK8KIeMMmQAaip4poHIKRl3JoNMYmH4ZSgnkKoYqBwRINpzxBEigdhvOVAISaP0eTjFAAmnFkHHAI9RZHcv4ZRvOuQOeoJasfZxzqQMzW48XUEXyFMNcG4ZuGvg3NJTFT2pjmiuwAzK8r74Au6B7Zl48UkCVBgTQ1IUMLRABaaXca6hGSLGNggw5JoEakhnKUIZiIfmhlV8jN+XiLzb5VTvshZpUl79eBM+R8IGUP9mK5JpiifjoOfoka81qh92L1iFWv6dl9Ajr8cPCfpAvxO+ojvTNSvbxC/m/r6g0XczGI5c7fp8Dzw+6aBxDWgAAAABJRU5ErkJggg=="},a030:function(n,e,t){var i=t("24fb");e=i(!1),e.push([n.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */.broadcast-live-page[data-v-19710d6b]{height:100%}.content-view[data-v-19710d6b]{padding-bottom:%?240?%;box-sizing:border-box}.content-view .device-list-view[data-v-19710d6b]{height:100%}.content-view .device-list-view .list-row[data-v-19710d6b]{height:%?100?%;font-size:%?26?%;border-bottom:1px solid #dbdbdb;padding:0 %?30?%}.content-view .device-list-view .list-row uni-image[data-v-19710d6b]{display:inline-block;width:%?50?%;height:%?50?%;margin-right:%?20?%}.content-view .null-view[data-v-19710d6b]{text-align:center;padding-top:30%}.content-view .null-view uni-image[data-v-19710d6b]{width:%?350?%;height:%?200?%}.content-view .null-view .null-view__tip[data-v-19710d6b]{font-size:%?24?%;color:#666;margin-top:%?40?%}.content-view .null-view .null-view__button[data-v-19710d6b]{font-size:%?24?%;color:#499ff5;margin-top:%?40?%}.operation-view[data-v-19710d6b]{width:100%;height:%?260?%;overflow:hidden;background-color:#f4f1f6;position:fixed;left:0;bottom:0;z-index:10}.operation-view .volume-view[data-v-19710d6b]{padding:%?10?% %?30?%}.operation-view .volume-view uni-image[data-v-19710d6b]{width:%?50?%;height:%?50?%}.operation-view .volume-view .slider-view[data-v-19710d6b] .uni-slider-handle{-webkit-transform:scale(.6);transform:scale(.6)}.operation-view .volume-view .slider-view[data-v-19710d6b] .uni-slider-thumb{-webkit-transform:scale(.6);transform:scale(.6)}.operation-view .volume-view .slider-view[data-v-19710d6b] .uni-slider-track{background-color:#499ff5!important}.operation-view .volume-view .volume-text[data-v-19710d6b]{font-size:%?30?%;color:#666}.operation-view .paly-btn[data-v-19710d6b]{padding:%?30?% %?30?%}.operation-view .paly-btn .out-btn[data-v-19710d6b]{width:100%;font-size:%?26?%;padding:%?15?% 0;background-color:#499ff5}',""]),n.exports=e},a3d1:function(n,e,t){"use strict";var i;t.d(e,"b",(function(){return o})),t.d(e,"c",(function(){return a})),t.d(e,"a",(function(){return i}));var o=function(){var n=this,e=n.$createElement,i=n._self._c||e;return i("v-uni-view",{staticClass:"broadcast-live-page"},[i("v-uni-view",{staticClass:"content-view"},[n.activeDev.length?i("v-uni-view",{staticClass:"device-list-view"},n._l(n.activeDev,(function(e,o){return i("v-uni-view",{key:e.terminalId,staticClass:"list-row flexbox flexbox-y-align"},[i("v-uni-image",{attrs:{src:t("7ea2"),mode:"scaleToFill"}}),i("v-uni-view",{staticClass:"text-ellipsis flexbox-flex1"},[n._v(n._s(e.terminalName))])],1)})),1):i("v-uni-view",{staticClass:"null-view"},[i("v-uni-image",{attrs:{src:t("37ba"),mode:""}}),i("v-uni-view",{staticClass:"null-view__tip"},[n._v("未选择播放设备，点击右上角添加或")]),i("v-uni-view",{staticClass:"null-view__button",on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.pushDevFn.apply(void 0,arguments)}}},[n._v("立即添加")])],1)],1),i("v-uni-view",{staticClass:"operation-view"},[i("v-uni-view",{staticClass:"volume-view flexbox flexbox-y-align"},[i("v-uni-image",{attrs:{src:t("0228"),mode:""}}),i("v-uni-slider",{staticClass:"slider-view flexbox-flex1",attrs:{value:n.liveForm.volume},on:{changing:function(e){arguments[0]=e=n.$handleEvent(e),n.sliderChangeFn.apply(void 0,arguments)},change:function(e){arguments[0]=e=n.$handleEvent(e),n.sliderEndFn.apply(void 0,arguments)}}}),i("v-uni-view",{staticClass:"volume-text"},[n._v(n._s(n.liveForm.volume))])],1),i("v-uni-view",{staticClass:"paly-btn"},[n.liveForm.inTask?i("v-uni-button",{staticClass:"out-btn",attrs:{type:"primary",size:"mini"},on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.stopSubmit.apply(void 0,arguments)}}},[n._v("停止口播")]):i("v-uni-button",{staticClass:"out-btn",attrs:{type:"primary",size:"mini"},on:{click:function(e){arguments[0]=e=n.$handleEvent(e),n.palySubmit.apply(void 0,arguments)}}},[n._v("开始口播")])],1)],1)],1)},a=[]},acf3:function(n,e,t){"use strict";t.r(e);var i=t("4d2d"),o=t.n(i);for(var a in i)"default"!==a&&function(n){t.d(e,n,(function(){return i[n]}))}(a);e["default"]=o.a},b98b:function(n,e,t){var i=t("a030");"string"===typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);var o=t("4f06").default;o("fb339cdc",i,!0,{sourceMap:!1,shadowMode:!1})}}]);
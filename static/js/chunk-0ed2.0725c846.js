(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0ed2","YelX","YelX","YelX"],{"+8LK":function(e,t,i){"use strict";i.r(t);var n=i("bS4n"),a=i.n(n),r=i("AlM9"),s=i("4HbD"),o=i("XVnh"),l=i("YelX"),d=i("8t5x"),c={name:"DriverAdminister",components:{TableView:r.a,drawerInit:s.default,notPerm:o.a},mixins:[l.default],data:function(){return{isTable:!0,selectKey:"username",fieldMap:{},resetData:{value:"motorcadeId",label:"name",children:"opMotorcadeNodes"},resetMenus:[],driverId:"",alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,checkDisabledOption:[{key:"bindStatus",value:1}],columns:[{type:"slot",name:"number",title:this.$t("driverAdminister.serial_number")},{title:this.$t("driverAdminister.name"),key:"username",type:"text"},{title:this.$t("driverAdminister.gender"),key:"sex",type:"tagText",tags:[{value:1,text:this.$t("driverAdminister.male")},{value:0,text:this.$t("driverAdminister.female"),option:{type:"danger"}}]},{title:this.$t("driverAdminister.mobile_number"),key:"phone",type:"text"},{title:this.$t("driverAdminister.license_type"),key:"allowModel",type:"text"},{title:this.$t("driverAdminister.driver_license_expires"),key:"drivingInvalidAt",type:"text"},{title:this.$t("driverAdminister.days_advance_reminder"),key:"drivingAdvanceNum",type:"text"},{title:this.$t("driverAdminister.bind_vehicle"),key:"licenseNum",type:"text"},{title:this.$t("driverAdminister.company"),key:"motorcadeName",type:"text"},{title:this.$t("driverAdminister.creation_time"),key:"createTime",type:"text"},{title:this.$t("operateCommon.operation"),type:"operate",key:"operate",fixed:"right",width:"120",buttons:[]}],buttonControls:[],searchControls:[{type:"selectInput",inputKey:"inputKey",selectKey:"selectKey",key:["inputKey","selectKey"],selectKey_value:"username",selectPlaceholder:this.$t("driverAdminister.select_type"),width:"340px",selectWidth:"130px",clearable:!0,options:[{name:this.$t("driverAdminister.driver"),value:"username"},{name:this.$t("driverAdminister.id_number"),value:"idCard"},{name:this.$t("driverAdminister.license_plate_number"),value:"licenseNum"}]},{type:"treeSelect",key:"companyId",valueKey:"companyId",placeholder:this.$t("driverAdminister.company"),width:"200px",treeOption:{defaultProps:{children:"sysCompanyNodes",label:"name"},nodeKey:"companyId",defaultExpandAll:!1,expandClickNode:!1,screenFn:{bindFn:function(e,t){return!e||-1!==t.name.indexOf(e)}}},treeDefinedData:[]},{type:"select",key:"bindStatus",placeholder:this.$t("driverAdminister.vehicle_binding"),width:"200px",clearable:!0,options:[{name:this.$t("driverAdminister.bound"),value:1},{name:this.$t("driverAdminister.unbound"),value:0}]}],searchMode:"immediate",footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1}}},computed:a()({},Object(d.b)(["elNorms","userData"])),created:function(){this.getCarTreeDataFn()},mounted:function(){var e=this;!0===this.$route.params.open&&this.details(),this.$nextTick(function(){e.$refs.table.searchParams.selectKey="username"})},methods:{handlePermissionShow:function(){this.tableOptions.buttonControls=[],this.isPermissionShow("driverCreate")&&this.tableOptions.buttonControls.push({text:this.$t("driverAdminister.add_driver"),type:"primary",size:"small",round:!1,icon:"el-icon-plus",funcName:"details"}),this.isPermissionShow("driverCreate")&&this.tableOptions.buttonControls.push({text:this.$t("driverAdminister.batch_import"),type:"null",size:"mini",round:!1,icon:"el-icon-folder-opened",funcName:"batchExport"}),this.isPermissionShow("driverExport")&&this.tableOptions.buttonControls.push({text:this.$t("driverAdminister.export_record"),type:"null",size:"small",round:!1,icon:"el-icon-download",funcName:"exportRecord"}),this.tableOptions.footerButtons=[],this.isPermissionShow("driverDelete")&&this.tableOptions.footerButtons.push({text:this.$t("operateCommon.delete"),type:"danger",size:"small",icon:"el-icon-delete",round:!1,funcName:"delete"});var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});this.tableOptions.columns[e].buttons=[],e>-1&&this.isPermissionShow("driverDetail")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("operateCommon.detailed"),icon:"iconfont Jamin_vehicle_ico_xq",type:"text",funcName:"detail"}),e>-1&&this.isPermissionShow("driverUpdate")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("operateCommon.edit"),icon:"iconfont Jamin_vehicle_icon_bj",type:"text",funcName:"edit"})},getCarTreeDataFn:function(){var e=this;this.$http.get("/company/treeList/driverAdminister").then(function(t){t.code===e.$config.API_STATUS.OK&&(e.tableOptions.searchControls[1].treeDefinedData=t.data,e.isTable=!1,e.$nextTick(function(){e.isTable=!0}))})},getTableData:function(e){var t=this;this.tableOptions.loading=!0;var i={companyId:e.companyId,bindStatus:e.bindStatus,username:""};e.selectKey&&(i[e.selectKey]=e.inputKey),this.$http.post("/driver/list?pageNum="+e.pageNum+"&pageSize="+e.pageSize,i).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.tableOptions.loading=!1,t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total)})},tableResponseFn:function(e,t,i){this[t.funcName].call(function(){},e,t,i)},details:function(e){this.$refs._drawer.details(e)},detail:function(e){this.$refs._drawer.detail(e)},edit:function(e){this.$refs._drawer.edit(e)},delete:function(e){var t=this;this.$confirm(this.$t("driverAdminister.delete_driver"),this.$t("operateCommon.prompt"),{confirmButtonText:this.$t("operateCommon.ok"),cancelButtonText:this.$t("operateCommon.cancel"),type:"warning"}).then(function(){var i=[];e.forEach(function(e,t){i[t]=e.driverId}),t.$http.deleteApi("/driver/delete",{ids:i.join(",")}).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$refs.table.initRequestTableData(),t.$message({type:"success",message:t.$t("confirm.message")}))})})},batchExport:function(){this.$refs._drawer.batchExport()},exportRecord:function(){var e=this;this.$confirm(this.$t("operateCommon.confirm_export_record"),this.$t("operateCommon.prompt"),{confirmButtonText:this.$t("operateCommon.ok"),cancelButtonText:this.$t("operateCommon.cancel"),type:"warning",closeOnClickModal:!1,beforeClose:function(t,i,n){e.fieldMap={},e.tableOptions.columns.forEach(function(t){e.$refs.table.columnCheckList.forEach(function(i){t.key===i&&"operate"!==t.key&&(e.fieldMap[i]=t.title)})});var a=e.$refs.table._data.searchParams,r=a.bindStatus,s=a.companyId,o=a.selectKey,l=a.inputKey;if("confirm"===t){var d={fieldMap:e.fieldMap,bindStatus:r,companyIds:s?[s]:null};o&&(d[o]=l),e.$http.download("/driver/export?isToken=true",d),n()}else n()}}).catch(function(){})},emitRequestFn:function(){this.$refs.table.initRequestTableData()}}},p=(i("akBJ"),i("ZrdR")),m=Object(p.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page-wrap"},[e.isTable&&e.isPermissionShow("driverList")?i("table-view",{ref:"table",attrs:{center:"","id-key":"driverId","is-search":!0,"check-memory":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"check-disabled-option":e.tableOptions.checkDisabledOption,checked:"","column-view":"","is-shadow":"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[i("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center"},slot:"number"})],1):e._e(),e._v(" "),e.isPermissionShow("driverList")||e.$store.state.app.permsDataLoading?e._e():i("notPerm"),e._v(" "),i("drawer-init",{ref:"_drawer"})],1)},[],!1,null,"0b03e3ec",null);m.options.__file="driverAdminister.vue";t.default=m.exports},"X+K5":function(e,t,i){},YelX:function(e,t,i){"use strict";i.r(t);var n=i("bS4n"),a=i.n(n),r=i("8t5x");t.default={data:function(){return{permissionList:{vehicleUpdate:"/vehicle/update/**",vehicleExport:"/vehicle/export",vehicleDelete:"/vehicle/delete",vehicleList:"/vehicle/list",vehicleCreate:"/vehicle/create",vehicleFastCreate:"/vehicle/fastCreate",vehicleMotorcadeCreate:"/vehicle/motorcade/create",vehicleMotorcadeUpdate:"/vehicle/motorcade/update",vehicleMotorcadeDelete:"/vehicle/motorcade/delete/**",companyList:"/company/list",companyCreate:"/company/create",companyExport:"/company/export",companyDetail:"/company/**",companyUpdate:"/company/update/**",companyPersonalization:"/company/personalization/**",companyDelete:"/company/delete",driverList:"/driver/list",driverCreate:"/driver/create",driverDetail:"/driver/get/**",driverUpdate:"/driver/update/**",driverDelete:"/driver/delete",driverExport:"/driver/export",labelList:"/label/list",labelCreate:"/label/create",labelUpdate:"/label/update/**",labelDelete:"/label/delete",labelExport:"/label/export",regionList:"/region/list",regionCreate:"/region/create",regionUpdate:"/region/update/**",regionDelete:"/region/delete",regionExport:"/region/export",routeList:"/route/list",routeCreate:"/route/create",routeUpdate:"/route/update/**",routeDelete:"/route/delete",routeExport:"/route/export",adminList:"/admin/list",adminCreate:"/admin/create",adminUpdate:"/admin/update/**",adminDelete:"/admin/delete",adminExport:"/admin/export",typeCreate:"/ef/type/create",typeUpdate:"/ef/type/update/**",typeDelete:"/ef/type/delete/**",drivingLicenseList:"/driving/license/list",drivingLicenseCreate:"/driving/license/create",drivingLicenseUpdate:"/driving/license/update/**",drivingLicenseDelete:"/driving/license/delete",drivingLicense:"/driving/license/export",transportList:"/transport/list",transportCreate:"/transport/create",transportUpdate:"/transport/update/**",transportDelete:"/transport/delete",transportExport:"/transport/export",maintainList:"/maintain/list",maintainCreate:"/maintain/create",maintainUpdate:"/maintain/update/**",maintainDelete:"/maintain/delete",maintainExport:"/maintain/export",insuranceList:"/insurance/list",insuranceCreate:"/insurance/create",insuranceUpdate:"/insurance/update/**",insuranceDelete:"/insurance/delete",insuranceExport:"/insurance/export",insuranceListAdvance:"/insurance/list/advance",annualList:"/annual/list",annualCreate:"/annual/create",annualUpdate:"/annual/update/**",annualDelete:"/annual/delete",annualExport:"/annual/export",annualListAdvance:"/annual/list/advance",repairList:"/repair/list",repairCreate:"/repair/create",repairUpdate:"/repair/update/**",repairDelete:"/repair/delete",repairExport:"/repair/export",accidentList:"/accident/list",accidentCreate:"/accident/create",accidentUpdate:"/accident/update/**",accidentDelete:"/accident/delete",accidentExport:"/accident/export",simList:"/sim/list",simCreate:"/sim/create",simUpdate:"/sim/update/**",simDelete:"/sim/delete",simExport:"/sim/export"}}},computed:a()({},Object(r.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[e])}}}},akBJ:function(e,t,i){"use strict";var n=i("X+K5");i.n(n).a},jcYt:function(e,t,i){e.exports=i.p+"static/img/not-perm.d97c442.png"}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6c61","Cy+k"],{"Cy+k":function(e,t,i){"use strict";i.r(t);var a=i("bS4n"),n=i.n(a),r=i("8t5x");t.default={data:function(){return{permissionList:{deviceList:"/device/list",deviceDetail:"/device/get/**",deviceCreate:"/device/create",deviceUpdate:"/device/update/**",deviceExport:"/device/export",deviceDelete:"/device/delete",vehicleFastCreate:"/vehicle/fastCreate",upgradeList:"/upgrade/list",upgradeListTask:"/upgrade/list/task",upgradeListRecord:"/upgrade/list/record",upgradeUpdate:"/upgrade/update/**",upgradeCreate:"/upgrade/create",upgradeDelete:"/upgrade/delete",upgradePush:"/upgrade/push",resetUpgradePush:"/upgrade/push/**",upgradeTaskPush:"/upgrade/task/push",upgradeTaskFailPush:"/upgrade/task/fail/push",deviceSettings:"/device/settings",deviceControlSetPassword:"/device/control/set/password",deviceControl:"/device/control",deviceControlDiskFormat:"/device/control/disk/format",deviceControlVehicle:"/device/control/vehicle",deviceTerminalText:"/device/terminal/text",deviceTerminalEvents:"/device/terminal/events",deviceTerminalQuestion:"/device/terminal/question",deviceTerminalNews:"/device/terminal/news",deviceTerminalCamera:"/device/terminal/camera",deviceTerminalSoundRecord:"/device/terminal/soundRecord",deviceTerminalVoiceMonitor:"/device/terminal/voiceMonitor",deviceOrderOffline:"/device/order/offline",deviceOrderOfflineExport:"/device/order/offline/export",deviceOrderDelete:"/device/order/delete",deviceOrderHistory:"/device/order/history",deviceOrderHistoryExport:"/device/order/history/export",simList:"/sim/list",simCreate:"/sim/create",simUpdate:"/sim/update/**",simDelete:"/sim/delete",simExport:"/sim/export"}}},computed:n()({},Object(r.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[e])}}}},MBcV:function(e,t,i){"use strict";i.r(t);var a=i("AlM9"),n=i("BHIJ"),r=i("Cy+k"),s={name:"InIssueHistoryComponents",components:{TableView:a.a,drawer:n.a},mixins:[r.default],data:function(){return{title:"",fieldMap:{},vehicleIds:[],drawerDisplay:!1,drawerData:{},alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:"序号"},{title:this.$t("view.license_num"),key:"licenseNum",type:"text",width:"130"},{title:this.$t("instructionPage.motorcade_name"),key:"motorcadeName",type:"text",minWidth:"120"},{title:this.$t("instructionPage.device_num"),key:"deviceNum",type:"text",width:"160"},{title:this.$t("instructionPage.order_type"),key:"orderType",type:"text",width:"160"},{title:this.$t("instructionPage.username"),key:"username",type:"text",width:"140"},{title:this.$t("instructionPage.push_time"),key:"createTime",type:"text",width:"160"},{title:this.$t("instructionPage.order_status"),key:"orderStatus",type:"tagText",width:"130",tags:[{value:0,text:this.$t("instructionPage.order_status_1"),option:{type:"danger"}},{value:1,text:this.$t("instructionPage.order_status_2"),option:{type:"success"}},{value:2,text:this.$t("instructionPage.order_status_3"),option:{type:"warning"}},{value:3,text:this.$t("instructionPage.order_status_4"),option:{type:"danger"}}]},{title:this.$t("instructionPage.fail_reason"),key:"failReason",type:"slot",name:"failReason"},{title:this.$t("instructionPage.content"),key:"content",type:"slot",name:"content"}],buttonControls:[],searchControls:[{type:"input",key:"licenseNum",placeholder:this.$t("view.license_num"),width:"200px"},{type:"treeSelect",key:"orderType",valueKey:"nameKey",placeholder:this.$t("instructionPage.order_type"),width:"200px",clearable:!0,treeOption:{defaultProps:{children:"list",label:"treeName"},nodeKey:"treeId",defaultExpandAll:!1,expandClickNode:!1,checkbox:!1,screenFn:{bindFn:function(e,t){return!e||-1!==t.typeName.indexOf(e)}}},treeDefinedData:this.$parent.$parent.$parent.treeResetData},{type:"datetimerange",key:"time",startPlaceholder:this.$t("view.start_time"),endPlaceholder:this.$t("view.end_time"),width:"360px"}],footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1},tableResetData:[],params:null}},computed:{},created:function(){this.tableResetData=this.$parent.$parent.$parent.tableResetData},mounted:function(){},methods:{handlePermissionShow:function(){this.tableOptions.buttonControls=[],this.isPermissionShow("deviceOrderHistoryExport")&&this.tableOptions.buttonControls.push({text:this.$t("operation.export_record"),type:"null",icon:"el-icon-download",funcName:"export",dataStatus:!0})},getTableData:function(e){var t=this,i={pageSize:e.pageSize,pageNum:e.pageNum,licenseNum:e.licenseNum,orderType:e.orderType,startTime:e.time&&e.time[0]?e.time[0]:"",endTime:e.time&&e.time[1]?e.time[1]:""};this.tableOptions.loading=!0,this.$http.post("/device/order/history",i).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.tableOptions.loading=!1,t.tableOptions.data=e.data.list,t.tableOptions.data.forEach(function(e){e.orderType=t.replaceStrFn(e.orderType),e.failReason=t.replaceStrFn(e.failReason)}),t.tableOptions.total=e.data.total)}),this.params=e},replaceStrFn:function(e){var t=e;if(t)for(var i=this.tableResetData.length-1;i>=0;i--){var a=this.tableResetData[i],n=a.nameKey;t=t.replace(new RegExp(n,"g"),a.treeName)}return t},tableResponseFn:function(e,t,i){this[t.funcName].call(function(){},e,t,i)},export:function(){var e=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),closeOnClickModal:!1,beforeClose:function(t,i,a){e.fieldMap={},e.tableOptions.columns.forEach(function(t){e.$refs.table.columnCheckList.forEach(function(i){i&&t.key===i&&"operate"!==t.key&&(e.fieldMap[i]=t.title)})});var n=e.params,r=n.licenseNum,s=n.time,o=n.orderType;if("confirm"===t){var l={fieldMap:e.fieldMap,licenseNum:r,orderType:o,startTime:s[0]?s[0]:"",endTime:s[1]?s[1]:""};e.tableOptions.total<e.$store.getters.userData.realtimeVideoUrl?e.$http.download("/device/order/history/export?isToken=true",l):e.$http.post("/device/order/history/export/async",l),a()}else a()}}).catch(function(){})},delete:function(e){var t=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel")}).then(function(){var i=[];e.forEach(function(e,t){i[t]=e.id}),t.$http.deleteApi("/driving/license/delete",{ids:i.join(",")}).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$refs.table.emitRequestTableData(),t.$message({message:e.message,type:"success"}))})})},diaClose:function(){this.$refs.table.emitRequestTableData(),this.drawerDisplay=!1},drawerCallback:function(e,t,i,a){this[e.handlerCallback.funcName].call(function(){},t,i,a)}}},o=(i("PEzB"),i("ZrdR")),l=Object(o.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"inIssue-history-components"},[i("table-view",{ref:"table",attrs:{center:"","id-key":"historyId","is-search":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"column-view":"","is-shadow":"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[i("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"}),e._v(" "),i("el-table-column",{attrs:{slot:"failReason",label:e.$t("instructionPage.fail_reason"),align:"center"},slot:"failReason",scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.failReason,placement:"top"}},[i("div",{staticClass:"text-ellipsis"},[e._v(e._s(t.row.failReason))])])]}}])}),e._v(" "),i("el-table-column",{attrs:{slot:"content",label:e.$t("instructionPage.content"),align:"center"},slot:"content",scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.content,placement:"top"}},[i("div",{staticClass:"text-ellipsis"},[e._v(e._s(t.row.content))])])]}}])})],1),e._v(" "),e.drawerDisplay?i("drawer",{ref:"drawer",attrs:{"drawer-data":e.drawerData},on:{diaClose:e.diaClose,handlerCallback:e.drawerCallback}}):e._e()],1)},[],!1,null,"a0e40838",null);l.options.__file="issueHistory.vue";t.default=l.exports},PEzB:function(e,t,i){"use strict";var a=i("sVoe");i.n(a).a},sVoe:function(e,t,i){}}]);
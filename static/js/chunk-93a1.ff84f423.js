(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-93a1"],{"1LbF":function(e,t,n){},"62dZ":function(e,t,n){"use strict";var i=n("6z9J");n.n(i).a},"6z9J":function(e,t,n){},"7wwX":function(e,t,n){"use strict";var i=n("1LbF");n.n(i).a},A2jl:function(e,t,n){e.exports=n.p+"static/img/replay_pic_qi-1.34ebdb8.png"},Cb1z:function(e,t,n){e.exports=n.p+"static/img/replay_pic_qi.32a2667.png"},EXUM:function(e,t,n){"use strict";n.r(t);var i=n("/uOT"),o=n.n(i),a=n("omC7"),r=n.n(a),l=n("bS4n"),s=n.n(l),c=n("cfOQ"),p=n.n(c),u=n("Lj9S"),g=n("8t5x"),m=n("A2jl"),h=n.n(m),d=n("k3dh"),y=n.n(d),f=n("Cb1z"),v=n.n(f),F=n("GNt7"),w=n.n(F),P=n("mh7c"),b=n.n(P),$={props:{tableData:{type:Object,default:function(){return{}}},company:{type:Array,default:function(){return{}}},icons:{type:Array,default:function(){return[]}},typeTitle:{type:String,default:""},isTaggingExist:{type:Boolean,default:!1},isShowForm:{type:Boolean,default:!1}},data:function(){return{defaultProps:{children:"sysCompanyNodes",label:"name"},companyInfo:{value:"",name:""},categoryProps:{children:"children",label:"label"},categoryInfo:{value:"",name:""},companyFilterText:"",flag:!1,options:u.regionData,qidian:h.a,zhong:y.a,jingguo:v.a,move:w.a,dragPointIcon:b.a,labelId:null,regionId:null,adminId:null,maps:"baidu",changeName:this.$t("electronicFence.new"),resetMenu:[],formshow:!1,infoWindow:null,search:"",num:0,map:null,point:null,zoom:null,lat:39.909652,lng:116.404177,circle:null,circleMarker:null,regionLableMarker:null,Bounds:null,Polygon:null,PolygonLine:null,polygonFlag:!0,mapClickTimer:null,radius:1200,points:[],opRouteTurns:[],driving:null,ruleForm:{companyId:null,typeId:null,labelName:null,region:null,icon:8,address:null,longitude:null,latitude:null,radiusRange:null,viewAngle:null,regionName:null,entryType:null,discription:null,regionType:null,routeName:null,endPoint:null,startPoint:null,adminName:null,adminRegion:null,areaId:[],mapType:this.maps},rules:{companyId:[{required:!0,message:this.$t("electronicFence.tip_18"),trigger:"change"}],typeId:[{required:!0,message:this.$t("electronicFence.tip_19"),trigger:"change"}],labelName:[{required:!0,message:this.$t("electronicFence.tip_20"),trigger:"blur"}],icon:[{required:!0,message:this.$t("electronicFence.tip_21"),trigger:"change"}],regionName:[{required:!0,message:this.$t("electronicFence.tip_22"),trigger:"blur"}],routeName:[{required:!0,message:this.$t("electronicFence.tip_23"),trigger:"blur"}],entryType:[{required:!0,message:this.$t("electronicFence.tip_24"),trigger:"blur"}],areaId:[{required:!0,message:this.$t("electronicFence.tip_25"),trigger:"change"}],adminName:[{required:!0,message:this.$t("electronicFence.tip_26"),trigger:"blur"}]},setPoinntMenuCss:{top:0,left:0},isShowSetPointMenu:!1,rightMenuEventData:null,dragPoint:null,isOverPoint:!1}},computed:s()({},Object(g.b)(["elNorms"])),watch:{companyFilterText:function(e){this.$refs.companySelectTree.filter(e)}},created:function(){},mounted:function(){this.initImg(),this.initInput()},methods:{handleChange:function(e){var t=this;if(t.map.clearOverlays(),e.length>0){this.ruleForm.areaId=e.join(","),this.ruleForm.adminRegion=u.CodeToText[e[e.length-1]];var n=[];(new p.a.Boundary).get(t.ruleForm.adminRegion,function(e){e.boundaries.forEach(function(e){var i=new p.a.Polygon(e,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6});t.map.addOverlay(i),n=n.concat(i.getPath())}),t.map.setViewport(n)})}else this.ruleForm.areaId=null,this.ruleForm.adminRegion=null},initImg:function(){var e=this;this.map=new p.a.Map("map"),this.point=new p.a.Point(116.404177,39.909652),this.map.centerAndZoom(this.point,14),this.map.enableScrollWheelZoom(!0),this.map.disableDoubleClickZoom();var t={offset:new p.a.Size(20,30),anchor:BMAP_ANCHOR_TOP_LEFT},n=new p.a.ScaleControl(t);function i(){this.defaultAnchor=BMAP_ANCHOR_TOP_RIGHT,this.defaultOffset=new p.a.Size(10,60)}this.map.addControl(n),i.prototype=new p.a.Control,i.prototype.initialize=function(e){var t=document.createRange().createContextualFragment('<div id="customZoomCtrl" class="custom-zoom-ctrl"></div>').querySelectorAll("#customZoomCtrl")[0],n=document.createRange().createContextualFragment('<div class="button" id="customZoomCtrlPlug">+</div>').querySelector("#customZoomCtrlPlug");n.onclick=function(){e.getZoom()<19&&e.zoomTo(e.getZoom()+1)};var i=document.createRange().createContextualFragment('<div class="button" id="customZoomCtrlMinus">-</div>').querySelector("#customZoomCtrlMinus");return i.onclick=function(){e.getZoom()>4&&e.zoomTo(e.getZoom()-1)},t.appendChild(n),t.appendChild(i),e.getContainer().appendChild(t),t};var o=new i;this.map.addControl(o),this.map.addEventListener("mousemove",function(t){if(e.typeTitle===e.$t("electronicFence.circle")){if(e.changeName===e.$t("electronicFence.details"))return;e.regionLableMarker||e.circle?e.regionLableMarker&&e.regionLableMarker.setPosition(t.point):(e.regionLableMarker=new p.a.Label(e.$t("electronicFence.tip_27"),{offset:{width:20,height:0},position:t.point}),e.map.addOverlay(e.regionLableMarker))}else if(e.typeTitle===e.$t("electronicFence.rectangle")){if(e.changeName===e.$t("electronicFence.details"))return;e.regionLableMarker||e.Bounds?e.regionLableMarker&&e.regionLableMarker.setPosition(t.point):(e.regionLableMarker=new p.a.Label(e.$t("electronicFence.tip_27"),{offset:{width:20,height:0},position:t.point}),e.map.addOverlay(e.regionLableMarker))}else if(e.typeTitle===e.$t("electronicFence.polygon")&&e.changeName===e.$t("electronicFence.new")){if(e.changeName===e.$t("electronicFence.details"))return;e.regionLableMarker||e.PolygonLine?e.regionLableMarker&&e.PolygonLine&&(e.map.removeOverlay(e.regionLableMarker),e.regionLableMarker=new p.a.Label(e.$t("electronicFence.tip_29"),{offset:{width:20,height:0},position:t.point}),e.regionLableMarker.enableMassClear(),e.map.addOverlay(e.regionLableMarker)):(e.regionLableMarker=new p.a.Label(e.$t("electronicFence.tip_28"),{offset:{width:20,height:0},position:t.point}),e.map.addOverlay(e.regionLableMarker)),e.regionLableMarker&&e.regionLableMarker.setPosition(t.point)}else e.typeTitle===e.$t("electronicFence.label_name")&&e.changeName===e.$t("electronicFence.new")?e.regionLableMarker?e.regionLableMarker&&e.regionLableMarker.setPosition(t.point):(e.regionLableMarker=new p.a.Label(e.$t("electronicFence.tip_30"),{offset:{width:20,height:0},position:t.point}),e.map.addOverlay(e.regionLableMarker)):e.typeTitle===e.$t("electronicFence.line")&&e.changeName===e.$t("electronicFence.new")&&(e.regionLableMarker?e.regionLableMarker&&e.regionLableMarker.setPosition(t.point):(e.regionLableMarker=new p.a.Label(e.$t("electronicFence.tip_31"),{offset:{width:20,height:0},position:t.point}),e.map.addOverlay(e.regionLableMarker)))}),this.map.addEventListener("click",function(t){clearTimeout(e.mapClickTimer),e.mapClickTimer=setTimeout(function(){if(e.changeName!==e.$t("electronicFence.details")&&!1===e.formshow&&(e.formshow=!0),e.typeTitle===e.$t("electronicFence.label_name")&&e.changeName!==e.$t("electronicFence.details")&&e.onClickMap(t),(e.typeTitle===e.$t("electronicFence.circle")||e.typeTitle===e.$t("electronicFence.rectangle")||e.typeTitle===e.$t("electronicFence.polygon"))&&e.changeName!==e.$t("electronicFence.details"))switch(e.onClickMap(t),e.point=t.point,e.typeTitle){case e.$t("electronicFence.circle"):e.circle||(e.map.clearOverlays(),e.regionLableMarker=null,e.newCircle());break;case e.$t("electronicFence.rectangle"):e.Bounds||(e.map.clearOverlays(),e.regionLableMarker=null,e.flag=!0,e.newBounds(t.point));break;case e.$t("electronicFence.polygon"):e.polygonFlag&&e.changeName===e.$t("electronicFence.new")&&(e.map.clearOverlays(),e.flag=!0,e.changePolygon(t.point))}e.typeTitle===e.$t("electronicFence.line")&&e.changeName!==e.$t("electronicFence.close")&&e.isShowSetPointMenu&&(e.isShowSetPointMenu=!1)},200)}),this.map.addEventListener("dblclick",function(t){e.typeTitle===e.$t("electronicFence.polygon")&&e.polygonFlag&&e.changeName===e.$t("electronicFence.new")&&(e.polygonFlag=!1,clearTimeout(e.mapClickTimer),e.points.push(t.point),e.map.clearOverlays(),e.map.removeOverlay(e.regionLableMarker),e.regionLableMarker=null,e.Polygon=new p.a.Polygon(e.points,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:0,enableClicking:!1}),e.Polygon.enableEditing(),e.map.addOverlay(e.Polygon))}),this.map.addEventListener("rightclick",function(t){e.typeTitle===e.$t("electronicFence.line")&&e.changeName!==e.$t("electronicFence.details")&&(e.rightMenuEventData=t,e.setPoinntMenuCss.left=t.Wa.x+"px",e.setPoinntMenuCss.top=t.Wa.y+"px",e.isShowSetPointMenu||e.isOverPoint||(e.isShowSetPointMenu=!0))})},companyFilterNode:function(e,t){return!e||-1!==t.name.indexOf(e)},nodeClick:function(e){this.ruleForm.companyId=e.companyId,this.companyInfo.value=e.companyId,this.companyInfo.name=e.name,this.$refs.companySelect&&this.$refs.companySelect.blur()},categoryNodeClick:function(e){this.ruleForm.typeId=e.value,this.categoryInfo.value=e.value,this.categoryInfo.name=e.label,this.$refs.categorySelect&&this.$refs.categorySelect.blur()},addVehicle:function(){var e=this;this.isShowForm&&(this.formshow=!0),this.changeName=this.$t("electronicFence.new"),this.ruleForm={companyId:null,typeId:null,labelName:null,region:null,icon:8,address:null,longitude:null,latitude:null,radiusRange:null,viewAngle:null,regionName:null,entryType:null,discription:null,regionType:null,routeName:null,endPoint:null,startPoint:null,adminName:null,adminRegion:null,areaId:[],mapType:this.maps},this.$nextTick(function(){e.$refs.ruleForm.resetFields()}),-1===this.$parent.resetMenus[0].value&&(this.resetMenu=JSON.parse(r()(this.$parent.resetMenus)).splice(-1,1)[0].children)},edit:function(e){this.ruleForm={companyId:null,typeId:null,labelName:null,region:null,icon:8,address:null,longitude:null,latitude:null,radiusRange:null,viewAngle:null,regionName:null,entryType:null,discription:null,regionType:null,routeName:null,endPoint:null,startPoint:null,adminName:null,adminRegion:null,areaId:[],mapType:this.maps},this.labelId=e.labelId,this.changeName=this.$t("operateCommon.edit"),-1===this.$parent.resetMenus[0].value&&(this.resetMenu=JSON.parse(r()(this.$parent.resetMenus)).splice(-1,1)[0].children),this.ruleForm=e,this.companyInfo.value=e.companyId,this.companyInfo.name=e.companyName,this.formshow=!0,this.point=new p.a.Point(e.latitude,e.longitude),this.map.centerAndZoom(this.point,14),this.map.addOverlay(this.newMarker(this.point)),this.map.panBy(400,400)},details:function(e){var t=this;this.changeName=this.$t("electronicFence.details"),this.formshow=!1,this.ruleForm.icon=e.icon,this.point=new p.a.Point(e.latitude,e.longitude),this.map.centerAndZoom(this.point,14),this.map.addOverlay(this.newMarker(this.point));var n='\n        <div style="padding-top: 10px">\n          <div style="font-size: 12px; padding-top: 10px; padding-bottom: 5px; border-top: 1px solid #E5E5E5">\n            <span>'+this.$t("electronicFence.region")+'：</span> \n            <span style="color: #666666">'+(e.region?e.region:"")+'</span>\n          </div>\n          <div style="font-size: 12px; padding: 5px 0;">\n            <span>'+this.$t("electronicFence.detailed_address")+'：</span>\n            <span style="color: #666666">'+(e.address?e.address:"")+'</span>\n          </div>\n          <div style="font-size: 12px; padding: 5px 0;">\n            <span>'+this.$t("electronicFence.radius_range")+'：</span>\n            <span style="color: #666666">'+(e.radiusRange?e.radiusRange+this.$t("electronicFence.meter"):"")+"</span>\n          </div>\n        </div>\n      ",i={width:0,height:0,title:e.labelName?e.labelName:"",enableCloseOnClick:!1};this.infoWindow=new p.a.InfoWindow(n,i),this.$nextTick(function(){setTimeout(function(){t.map.openInfoWindow(t.infoWindow,t.point)},500)}),this.map.panBy(400,400)},newMarker:function(e){var t=this.icons[this.ruleForm.icon].icon,n=null,i=this;n=this.ruleForm.icon<=5?new p.a.Icon(t,new p.a.Size(16,26)):new p.a.Icon(t,new p.a.Size(21,26));var o=new p.a.Marker(e,{icon:n});return this.changeName===this.$t("electronicFence.details")&&o.addEventListener("click",function(){i.map.openInfoWindow(i.infoWindow,i.point)}),o},iconFn:function(e){this.map.clearOverlays(),this.map.addOverlay(this.newMarker(this.point))},mapAnalysis:function(e){var t=this;this.point=e,this.map.clearOverlays(),this.regionLableMarker=null,(new p.a.Geocoder).getLocation(e,function(n){var i=n.addressComponents,o=n.surroundingPois.length>0?n.surroundingPois[0].title:"";t.ruleForm.longitude=e.lat,t.ruleForm.latitude=e.lng,t.ruleForm.region=i.province===i.city?""+i.city+i.district:""+i.province+i.city+i.district,t.ruleForm.address=""+i.street+i.streetNumber+o}),this.map.addOverlay(this.newMarker(e))},addRegion:function(){var e=this;this.points=[],this.polygonFlag=!0,this.addVehicle(),this.map.panBy(400,400),setTimeout(function(){e.map.panTo(new p.a.Point(116.404177,39.909652),{noAnimation:!0})})},newCircle:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.map.clearOverlays();var n=this,i=new p.a.Icon(w.a,new p.a.Size(15,29));if(n.circle=new p.a.Circle(this.point,this.radius,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:1}),n.map.addOverlay(n.circle),n.ruleForm.radiusRange=n.radius,t){var a=n.circle.getCenter();setTimeout(function(){e.map.panTo(a,{noAnimation:!0})},0)}if(this.changeName!==this.$t("electronicFence.details")){var r=null;n.circleMarker=new p.a.Marker(this.point,{icon:i,offset:{width:0,height:-22}}),n.map.addOverlay(n.circleMarker),n.circle.enableEditing(),n.circle.onlineupdate=function(t){r&&(clearTimeout(r),r=null),n.map.removeOverlay(e.circleMarker),r=setTimeout(function(){n.ruleForm.radiusRange=o()(n.circle.getRadius()),n.radius=n.ruleForm.radiusRange,n.point=n.circle.getCenter(),n.circleMarker=new p.a.Marker(n.point,{icon:i,offset:{width:0,height:-22}}),n.map.addOverlay(n.circleMarker),n.circleMarker.enableDragging(),n.circleMarker.ondragging=function(e){n.circleDragging(e)},n.circleMarker.ondragend=function(e){n.circleDragend(r,i)}},300)},n.circleMarker.enableDragging(),n.circleMarker.ondragging=function(e){n.circleDragging(e)},n.circleMarker.ondragend=function(e){n.circleDragend(r,i)}}},circleDragging:function(e){this.point=e.point,this.againRenderCircle()},circleDragend:function(e,t){var n=this;this.circle.onlineupdate=function(){n.map.removeOverlay(n.circleMarker),e&&(clearTimeout(e),e=null),e=setTimeout(function(){n.ruleForm.radiusRange=o()(n.circle.getRadius()),n.radius=n.ruleForm.radiusRange,n.point=n.circle.getCenter(),n.circleMarker=new p.a.Marker(n.point,{icon:t,offset:{width:0,height:-22}}),n.circleMarker.enableDragging(),n.circleMarker.ondragging=function(e){n.circleDragging(e,n.circleMarker)},n.circleMarker.ondragend=function(i){n.circleDragend(e,t)},n.map.addOverlay(n.circleMarker)},300)},this.circle.enableEditing()},againRenderCircle:function(){this.map.removeOverlay(this.circle),this.circle=new p.a.Circle(this.point,this.radius,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:1}),this.map.addOverlay(this.circle)},newBounds:function(e){var t=this;this.map.clearOverlays();var n=1e6*parseFloat(e.lng.toFixed(6)),i=1e6*parseFloat(e.lat.toFixed(6)),o=new p.a.Point((n+15e3)/1e6,(i+1e4)/1e6),a=new p.a.Point((n-15e3)/1e6,(i-1e4)/1e6);if(this.Bounds=new p.a.Polygon([new p.a.Point(o.lng,o.lat),new p.a.Point(a.lng,o.lat),new p.a.Point(a.lng,a.lat),new p.a.Point(o.lng,a.lat)],{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:1}),this.Bounds.enableMassClear(),this.map.addOverlay(this.Bounds),this.changeName!==this.$t("electronicFence.details")){var r=new p.a.Icon(b.a,new p.a.Size(15,15)),l=new p.a.Marker(new p.a.Point(a.lng,o.lat),{icon:r}),s=new p.a.Marker(new p.a.Point(a.lng,a.lat),{icon:r}),c=new p.a.Marker(new p.a.Point(o.lng,o.lat),{icon:r}),u=new p.a.Marker(new p.a.Point(o.lng,a.lat),{icon:r});this.map.addOverlay(l),this.map.addOverlay(s),this.map.addOverlay(c),this.map.addOverlay(u),l.enableDragging(),s.enableDragging(),u.enableDragging(),c.enableDragging(),l.ondragging=function(e){var n=e.point,i=n.lng,r=n.lat;o=new p.a.Point(o.lng,r),a=new p.a.Point(i,a.lat),t.setPolygonPath(o,a);var l=(o.lng+a.lng)/2,g=(o.lat+a.lat)/2;m.setPosition(new p.a.Point(l,g)),c.setPosition(new p.a.Point(o.lng,o.lat)),u.setPosition(new p.a.Point(o.lng,a.lat)),s.setPosition(new p.a.Point(a.lng,a.lat))},s.ondragging=function(e){var n=e.point,i=n.lng,r=n.lat;a=new p.a.Point(i,r),t.setPolygonPath(o,a);var s=(o.lng+a.lng)/2,g=(o.lat+a.lat)/2;m.setPosition(new p.a.Point(s,g)),c.setPosition(new p.a.Point(o.lng,o.lat)),u.setPosition(new p.a.Point(o.lng,a.lat)),l.setPosition(new p.a.Point(a.lng,o.lat))},u.ondragging=function(e){var n=e.point,i=n.lng,r=n.lat;o=new p.a.Point(i,o.lat),a=new p.a.Point(a.lng,r),t.setPolygonPath(o,a);var u=(o.lng+a.lng)/2,g=(o.lat+a.lat)/2;m.setPosition(new p.a.Point(u,g)),l.setPosition(new p.a.Point(a.lng,o.lat)),s.setPosition(new p.a.Point(a.lng,a.lat)),c.setPosition(new p.a.Point(o.lng,o.lat))},c.ondragging=function(e){var n=e.point,i=n.lng,r=n.lat;o=new p.a.Point(i,r),t.setPolygonPath(o,a);var c=(o.lng+a.lng)/2,g=(o.lat+a.lat)/2;m.setPosition(new p.a.Point(c,g)),l.setPosition(new p.a.Point(a.lng,o.lat)),s.setPosition(new p.a.Point(a.lng,a.lat)),u.setPosition(new p.a.Point(o.lng,a.lat))};var g=new p.a.Icon(w.a,new p.a.Size(15,29)),m=new p.a.Marker(e,{icon:g});this.map.addOverlay(m),m.enableDragging();var h=0,d=0;m.ondragstart=function(e){var t=(o.lng+a.lng)/2,n=(o.lat+a.lat)/2;h=Math.abs(o.lng-t),d=Math.abs(o.lat-n)},m.ondragging=function(e){o=new p.a.Point(e.point.lng+h,e.point.lat-d),a=new p.a.Point(e.point.lng-h,e.point.lat+d),t.setPolygonPath(o,a),c.setPosition(new p.a.Point(o.lng,o.lat)),u.setPosition(new p.a.Point(o.lng,a.lat)),l.setPosition(new p.a.Point(a.lng,o.lat)),s.setPosition(new p.a.Point(a.lng,a.lat))}}},setPolygonPath:function(e,t){this.Bounds.setPath([new p.a.Point(e.lng,e.lat),new p.a.Point(t.lng,e.lat),new p.a.Point(t.lng,t.lat),new p.a.Point(e.lng,t.lat)])},newPolygon:function(){this.map.centerAndZoom(this.point,14),this.points=[]},changePolygon:function(e){this.points.push(e),this.map.clearOverlays(),this.PolygonLine=new p.a.Polyline(this.points,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:1,enableClicking:!1}),this.PolygonLine.enableMassClear(),this.map.addOverlay(this.PolygonLine),this.Polygon=new p.a.Polygon(this.points,{strokeColor:"#409EFF",strokeWeight:1,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:0,enableClicking:!1}),this.Polygon.enableMassClear(),this.map.addOverlay(this.Polygon)},detailsRegion:function(e){var t=this;switch(this.map.clearOverlays(),this.points=[],this.changeName=this.$t("electronicFence.details"),e.regionType){case 1:this.$nextTick(function(){t.detailsCircle(e)});break;case 2:this.$nextTick(function(){t.detailsBounds(e)});break;case 3:this.$nextTick(function(){t.detailsPolygon(e)})}},detailsCircle:function(e){this.point=new p.a.Point(e.longitude,e.latitude),this.radius=e.radiusRange,this.viewAngle=e.viewAngle,this.map.centerAndZoom(this.point,this.viewAngle),this.formshow=!1,this.newCircle(!0),this.circle.disableEditing()},detailsBounds:function(e){var t=this;this.changeName=this.$t("electronicFence.details"),this.formshow=!1;for(var n=e.latitude.split(","),i=e.longitude.split(","),o=0;o<n.length;o++)this.points[o]=new p.a.Point(i[o],n[o]);this.point=JSON.parse(e.discription),this.viewAngle=e.viewAngle,this.Bounds=new p.a.Polygon(this.points,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:1,enableClicking:!1}),this.Bounds.disableEditing(),this.Bounds.enableMassClear(),this.map.addOverlay(this.Bounds),setTimeout(function(){t.map.panTo(new p.a.Point(t.point.lng,t.point.lat),{noAnimation:!0})},0)},detailsPolygon:function(e){var t=this;this.changeName=this.$t("electronicFence.details"),this.formshow=!1;for(var n=e.latitude.split(","),i=e.longitude.split(","),o=0;o<n.length;o++)this.points[o]=new p.a.Point(i[o],n[o]);this.point=JSON.parse(e.discription),this.viewAngle=e.viewAngle,this.Polygon=new p.a.Polygon(this.points,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:1,enableClicking:!1}),this.Polygon.enableMassClear(),this.Polygon.disableEditing(),this.map.addOverlay(this.Polygon),setTimeout(function(){t.map.panTo(new p.a.Point(t.point.lng,t.point.lat),{noAnimation:!0})},0)},editRegion:function(e){var t=this;switch(this.points=[],this.map.clearOverlays(),-1===this.$parent.resetMenus[0].value&&(this.resetMenu=JSON.parse(r()(this.$parent.resetMenus)).splice(-1,1)[0].children),e.regionType){case 1:this.$nextTick(function(){t.editCircle(e)});break;case 2:this.$nextTick(function(){t.editBounds(e)});break;case 3:this.$nextTick(function(){t.editPolygon(e)})}},editCircle:function(e){this.regionId=e.regionId,this.changeName=this.$t("operateCommon.edit"),this.formshow=!0,this.ruleForm=e,this.companyInfo.value=e.companyId,this.point=new p.a.Point(e.longitude,e.latitude),this.radius=e.radiusRange,this.viewAngle=e.viewAngle,this.map.centerAndZoom(this.point,this.viewAngle),this.newCircle(!0),this.map.panBy(400,400)},editBounds:function(e){var t=this;this.changeName=this.$t("operateCommon.edit");var n=e.companyId,i=e.entryType,o=e.radiusRange,a=e.regionId,r=e.regionName,l=e.typeId;this.ruleForm={companyId:n,entryType:i,radiusRange:o,regionId:a,regionName:r,typeId:l},this.companyInfo.value=e.companyId,this.regionId=a,this.formshow=!0;for(var s=e.latitude.split(","),c=e.longitude.split(","),u=0;u<s.length;u++)this.points[u]=new p.a.Point(c[u],s[u]);this.point=JSON.parse(e.discription),this.viewAngle=e.viewAngle,this.Bounds=new p.a.Polygon(this.points,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:1,enableClicking:!1}),this.Bounds.enableMassClear(),this.map.addOverlay(this.Bounds),setTimeout(function(){t.map.panTo(new p.a.Point(t.point.lng,t.point.lat),{noAnimation:!0})},0),this.map.panBy(550,300);var g=new p.a.Point(this.points[1].lng,this.points[1].lat),m=new p.a.Point(this.points[3].lng,this.points[3].lat),h=new p.a.Icon(b.a,new p.a.Size(15,15)),d=new p.a.Marker(new p.a.Point(m.lng,g.lat),{icon:h}),y=new p.a.Marker(new p.a.Point(m.lng,m.lat),{icon:h}),f=new p.a.Marker(new p.a.Point(g.lng,g.lat),{icon:h}),v=new p.a.Marker(new p.a.Point(g.lng,m.lat),{icon:h});this.map.addOverlay(d),this.map.addOverlay(y),this.map.addOverlay(f),this.map.addOverlay(v),d.enableDragging(),y.enableDragging(),v.enableDragging(),f.enableDragging(),d.ondragging=function(e){var n=e.point,i=n.lng,o=n.lat;g=new p.a.Point(g.lng,o),m=new p.a.Point(i,m.lat),t.setPolygonPath(g,m);var a=(g.lng+m.lng)/2,r=(g.lat+m.lat)/2;P.setPosition(new p.a.Point(a,r)),f.setPosition(new p.a.Point(g.lng,g.lat)),v.setPosition(new p.a.Point(g.lng,m.lat)),y.setPosition(new p.a.Point(m.lng,m.lat))},y.ondragging=function(e){var n=e.point,i=n.lng,o=n.lat;m=new p.a.Point(i,o),t.setPolygonPath(g,m);var a=(g.lng+m.lng)/2,r=(g.lat+m.lat)/2;P.setPosition(new p.a.Point(a,r)),f.setPosition(new p.a.Point(g.lng,g.lat)),v.setPosition(new p.a.Point(g.lng,m.lat)),d.setPosition(new p.a.Point(m.lng,g.lat))},f.ondragging=function(e){var n=e.point,i=n.lng,o=n.lat;g=new p.a.Point(i,o),t.setPolygonPath(g,m);var a=(g.lng+m.lng)/2,r=(g.lat+m.lat)/2;P.setPosition(new p.a.Point(a,r)),d.setPosition(new p.a.Point(m.lng,g.lat)),y.setPosition(new p.a.Point(m.lng,m.lat)),v.setPosition(new p.a.Point(g.lng,m.lat))},v.ondragging=function(e){var n=e.point,i=n.lng,o=n.lat;g=new p.a.Point(i,g.lat),m=new p.a.Point(m.lng,o),t.setPolygonPath(g,m);var a=(g.lng+m.lng)/2,r=(g.lat+m.lat)/2;P.setPosition(new p.a.Point(a,r)),d.setPosition(new p.a.Point(m.lng,g.lat)),y.setPosition(new p.a.Point(m.lng,m.lat)),f.setPosition(new p.a.Point(g.lng,g.lat))};var F=new p.a.Icon(w.a,new p.a.Size(15,29)),P=new p.a.Marker(new p.a.Point((g.lng+m.lng)/2,(g.lat+m.lat)/2),{icon:F});this.map.addOverlay(P),P.enableDragging();var $=0,k=0;P.ondragstart=function(e){var t=(g.lng+m.lng)/2,n=(g.lat+m.lat)/2;$=Math.abs(g.lng-t),k=Math.abs(g.lat-n)},P.ondragging=function(e){g=new p.a.Point(e.point.lng+$,e.point.lat-k),m=new p.a.Point(e.point.lng-$,e.point.lat+k),t.setPolygonPath(g,m),f.setPosition(new p.a.Point(g.lng,g.lat)),v.setPosition(new p.a.Point(g.lng,m.lat)),d.setPosition(new p.a.Point(m.lng,g.lat)),y.setPosition(new p.a.Point(m.lng,m.lat))}},editPolygon:function(e){var t=this;this.changeName=this.$t("operateCommon.edit");var n=e.companyId,i=e.entryType,o=e.radiusRange,a=e.regionId,r=e.regionName,l=e.typeId;this.ruleForm={companyId:n,entryType:i,radiusRange:o,regionId:a,regionName:r,typeId:l},this.companyInfo.value=e.companyId,this.regionId=a,this.formshow=!0;for(var s=e.latitude.split(","),c=e.longitude.split(","),u=0;u<s.length;u++)this.points[u]=new p.a.Point(c[u],s[u]);this.point=JSON.parse(e.discription),this.viewAngle=e.viewAngle,this.Polygon=new p.a.Polygon(this.points,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6,strokeOpacity:1,enableClicking:!1}),this.Polygon.enableMassClear(),this.Polygon.enableEditing(),this.map.addOverlay(this.Polygon),setTimeout(function(){t.map.panTo(new p.a.Point(t.point.lng,t.point.lat),{noAnimation:!0})},0),this.map.panBy(550,300)},setStartPoint:function(){this.onClickMap(this.rightMenuEventData),this.point=this.rightMenuEventData.point,this.routeIcon(this.rightMenuEventData.point,"start"),this.isShowSetPointMenu=!1},setPassPoint:function(){this.onClickMap(this.rightMenuEventData),this.point=this.rightMenuEventData.point,this.routeIcon(this.rightMenuEventData.point,"pass"),this.isShowSetPointMenu=!1},setEndPoint:function(){this.onClickMap(this.rightMenuEventData),this.point=this.rightMenuEventData.point,this.routeIcon(this.rightMenuEventData.point,"end"),this.isShowSetPointMenu=!1},addRoute:function(){this.addVehicle()},createTagging:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=new p.a.Icon(t,new p.a.Size(27,29)),a=new p.a.Marker(e,{icon:o});if(this.map.addOverlay(a),a.setZIndex(i),this.changeName!==this.$t("electronicFence.details")){a.enableDragging();var r=new p.a.ContextMenu,l=new p.a.MenuItem(this.$t("operateCommon.delete"),function(){var e=a.getPosition();n.points=n.points.filter(function(t){return t.lat!==e.lat&&t.lng!==e.lng}),n.map.removeOverlay(a);var t=n.points.some(function(e){return"start"===e.type}),i=n.points.some(function(e){return"end"===e.type});t&&i?n.routeLine():(n.map.clearOverlays(),n.batchCreateTagging())});r.addItem(l),a.addContextMenu(r),a.onmouseover=function(e){var t=a.getPosition(),i=t.lat,o=t.lng,r=n.points.find(function(e){return e.lat===i&&e.lng===o});n.dragPoint=r,n.isOverPoint=!0},a.onmouseout=function(){n.isOverPoint=!1},a.ondragend=function(){n.points=n.points.filter(function(e){return e.lat!==n.dragPoint.lat&&e.lng!==n.dragPoint.lng});var e=a.getPosition();e.type=n.dragPoint.type,n.points.push(e),n.dragPoint=e;var t=n.points.some(function(e){return"start"===e.type}),i=n.points.some(function(e){return"end"===e.type});t&&i&&n.routeLine()}}},batchCreateTagging:function(){var e=this,t={start:h.a,pass:v.a,end:y.a};this.points.forEach(function(n){var i="start"===n.type||"end"===n.type?9:8;e.createTagging(n,t[n.type],i)})},routeIcon:function(e,t){var n=this;if("start"===t){var i=this.points.find(function(e){return"start"===e.type}),o=this.points.find(function(e){return"end"===e.type});this.map.getOverlays().forEach(function(e){"[object Marker]"===e.toString()&&i&&e.getPosition().lng===i.lng&&e.getPosition().lat===i.lat&&(n.map.removeOverlay(e),n.points=n.points.filter(function(e){return"start"!==e.type}))}),e.type="start",this.points.push(e),this.createTagging(e,h.a,9),o&&(this.createTagging(o,y.a,9),this.routeLine())}if("pass"===t){e.type="pass",this.points.push(e),this.createTagging(e,v.a);var a=this.points.some(function(e){return"start"===e.type}),r=this.points.some(function(e){return"end"===e.type});a&&r&&this.routeLine()}if("end"===t){var l=this.points.find(function(e){return"start"===e.type}),s=this.points.find(function(e){return"end"===e.type});this.map.getOverlays().forEach(function(e){"[object Marker]"===e.toString()&&s&&e.getPosition().lng===s.lng&&e.getPosition().lat===s.lat&&(n.map.removeOverlay(e),n.points=n.points.filter(function(e){return"end"!==e.type}))}),e.type="end",this.points.push(e),this.createTagging(e,y.a,9),l&&(this.createTagging(l,h.a,9),this.routeLine())}},routeLine:function(){this.map.clearOverlays();var e=this.points.find(function(e){return"start"===e.type}),t=this.points.filter(function(e){return"pass"===e.type}),n=this.points.find(function(e){return"end"===e.type});this.opRouteTurns=t.map(function(e,t){return{latitude:e.lat,longitude:e.lng,pointId:t}}),this.driving=new p.a.DrivingRoute(this.map,{renderOptions:{map:this.map,autoViewport:!0},onPolylinesSet:function(e){e[0].getPolyline().setStrokeWeight(8),e[0].getPolyline().setStrokeOpacity(1),e[0].getPolyline().setStrokeColor("#409EFF")}}),this.batchCreateTagging(),this.driving.search(e,n,{waypoints:t})},detailsRoute:function(e){var t=this;this.changeName=this.$t("electronicFence.details"),this.point=JSON.parse(e.discription),this.viewAngle=e.viewAngle,this.map.centerAndZoom(this.point,this.viewAngle),this.formshow=!1,this.ruleForm.startPoint=JSON.parse(e.startPoint),this.ruleForm.endPoint=JSON.parse(e.endPoint),this.ruleForm.opRouteTurns=e.opRouteTurns;var n=new p.a.Point(this.ruleForm.startPoint.lng,this.ruleForm.startPoint.lat),i=new p.a.Point(this.ruleForm.endPoint.lng,this.ruleForm.endPoint.lat);this.routeIcon(n,"start"),this.ruleForm.opRouteTurns.forEach(function(e){var n=new p.a.Point(e.longitude,e.latitude);t.routeIcon(n,"pass")}),this.routeIcon(i,"end")},editRoute:function(e){var t=this;this.changeName=this.$t("operateCommon.edit");var n=e.companyId,i=e.typeId,o=e.entryType,a=e.routeName,l=e.routeId;-1===this.$parent.resetMenus[0].value&&(this.resetMenu=JSON.parse(r()(this.$parent.resetMenus)).splice(-1,1)[0].children),this.routeId=l,this.ruleForm.companyId=n,this.ruleForm.typeId=i,this.ruleForm.entryType=o,this.ruleForm.routeName=a,this.point=JSON.parse(e.discription),this.viewAngle=e.viewAngle,this.map.centerAndZoom(this.point,this.viewAngle),this.formshow=!0,this.ruleForm.startPoint=JSON.parse(e.startPoint),this.ruleForm.endPoint=JSON.parse(e.endPoint),this.ruleForm.opRouteTurns=e.opRouteTurns;var s=new p.a.Point(this.ruleForm.startPoint.lng,this.ruleForm.startPoint.lat),c=new p.a.Point(this.ruleForm.endPoint.lng,this.ruleForm.endPoint.lat);this.routeIcon(s,"start"),this.ruleForm.opRouteTurns.forEach(function(e){var n=new p.a.Point(e.longitude,e.latitude);t.routeIcon(n,"pass")}),this.routeIcon(c,"end")},addAdmin:function(){this.changeName=this.$t("electronicFence.new"),this.addVehicle()},localSearch:function(){var e=this,t=this;new p.a.LocalSearch(t.map,{onSearchComplete:function(n){n.Ir.length>0?(t.point=n.Ir[0].point,t.map.centerAndZoom(t.point,9)):(t.ruleForm.areaId=[],t.ruleForm.adminRegion=null,t.$message.error(e.$t("electronicFence.tip_14")))}}).search(this.ruleForm.adminRegion)},detailAdmin:function(e){var t=this;this.changeName=this.$t("electronicFence.details"),this.formshow=!1;var n=JSON.parse(e.discription);this.viewAngle=e.viewAngle;var i=e.adminRegion;this.map.centerAndZoom(n,this.viewAngle);var o=[];(new p.a.Boundary).get(i,function(e){e.boundaries.forEach(function(e){var n=new p.a.Polygon(e,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6});t.map.addOverlay(n),o=o.concat(n.getPath())}),t.map.setViewport(o)}),this.map.panBy(400,400)},editAdmin:function(e){-1===this.$parent.resetMenus[0].value&&(this.resetMenu=JSON.parse(r()(this.$parent.resetMenus)).splice(-1,1)[0].children);var t=this;this.changeName=this.$t("operateCommon.edit"),this.formshow=!0;var n=e.companyId,i=e.adminName,o=e.areaId,a=e.adminRegion,l=e.entryType,s=e.typeId,c=e.adminId;this.adminId=c,this.ruleForm.adminName=i,this.ruleForm.companyId=n,this.ruleForm.areaId=o,this.ruleForm.adminRegion=a,this.ruleForm.entryType=l,this.ruleForm.typeId=s;var u=JSON.parse(e.discription);this.viewAngle=e.viewAngle;var g=e.adminRegion;this.map.centerAndZoom(u,this.viewAngle);var m=[];(new p.a.Boundary).get(g,function(e){e.boundaries.forEach(function(e){var n=new p.a.Polygon(e,{strokeColor:"#409EFF",strokeWeight:3,fillColor:"#4897ce",fillOpacity:.6});t.map.addOverlay(n),m=m.concat(n.getPath())}),t.map.setViewport(m)}),this.map.panBy(400,400)},onClickMap:function(e){this.formshow||(this.formshow=!0),this.typeTitle===this.$t("electronicFence.label_name")&&this.mapAnalysis(e.Ag)},formClose:function(){this.formshow=!1,this.regionLableMarker=null,this.typeTitle===this.$t("electronicFence.circle")&&this.changeName===this.$t("electronicFence.new")&&(this.map.clearOverlays(),this.circle=null),this.typeTitle===this.$t("electronicFence.rectangle")&&this.changeName===this.$t("electronicFence.new")&&(this.map.clearOverlays(),this.Bounds=null),this.typeTitle===this.$t("electronicFence.polygon")&&this.changeName===this.$t("electronicFence.new")&&(this.map.clearOverlays(),this.polygonFlag=!0,this.Polygon=null,this.PolygonLine=null,this.points=[])},close:function(){this.map.clearOverlays(),this.$parent.show=!1,this.$parent.viewLeft=!1,this.flag=!1,this.$refs.ruleForm&&this.$refs.ruleForm.resetFields(),this.typeTitle!==this.$t("electronicFence.circle")&&this.typeTitle!==this.$t("electronicFence.rectangle")&&this.typeTitle!==this.$t("electronicFence.polygon")||(this.viewAngle=14,this.radius=1200,this.circle=null,this.Bounds=null,this.Polygon=null,this.PolygonLine=null,this.regionLableMarker=null,this.points=[]),this.typeTitle===this.$t("electronicFence.line")&&(this.points=[])},getIds:function(e){return window.document.getElementById(e)},initInput:function(){var e,t=this;this.ac=new p.a.Autocomplete({input:"suggestId",location:t.map}),this.ac.addEventListener("onhighlight",function(e){var n="",i=e.fromitem.value,o="";e.fromitem.index>-1&&(o=i.province+i.city+i.district+i.street+i.business),n="FromItem<br />index = "+e.fromitem.index+"<br />value = "+o,o="",e.toitem.index>-1&&(o=(i=e.toitem.value).province+i.city+i.district+i.street+i.business),n+="<br />ToItem<br />index = "+e.toitem.index+"<br />value = "+o,t.getIds("searchResultPanel").innerHTML=n}),t.ac.addEventListener("onconfirm",function(n){var i=n.item.value;e=i.province+i.city+i.district+i.street+i.business,t.getIds("searchResultPanel").innerHTML="onconfirm<br />index = "+n.item.index+"<br />myValue = "+e,t.setPlace(e)})},setPlace:function(e){var t=this;var n=new p.a.LocalSearch(t.map,{onSearchComplete:function(){var e=n.getResults().getPoi(0).point;t.map.centerAndZoom(e,14),t.typeTitle===this.$t("electronicFence.label_name")&&t.mapAnalysis(e)}});n.search(e)},submitForm:function(e){var t=this;switch(this.typeTitle){case this.$t("electronicFence.label_name"):this.$emit("verificationLabelName",this.ruleForm.typeId,this.ruleForm.labelId,this.ruleForm.labelName,"edit"),this.$nextTick(function(){t.isTaggingExist?t.$message.warning(t.$t("electronicFence.tip_15")):t.labelSubmit(e)});break;case this.$t("electronicFence.circle"):case this.$t("electronicFence.polygon"):case this.$t("electronicFence.rectangle"):this.regionSubmit(e);break;case this.$t("electronicFence.line"):this.routeSubmit(e);break;case this.$t("electronicFence.administration"):this.adminSubmit(e)}},labelSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.changeName===t.$t("electronicFence.new")?t.$http.post("/label/create",t.ruleForm).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$message({message:e.message,type:"success"}),t.close(),t.$parent.$refs.table.emitRequestTableData())}):t.changeName===t.$t("operateCommon.edit")&&t.$http.post("/label/update/"+t.labelId,t.ruleForm).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$message({message:e.message,type:"success"}),t.close(),t.$parent.$refs.table.emitRequestTableData())})})},regionSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;switch(t.typeTitle){case t.$t("electronicFence.circle"):t.ruleForm.regionType=1;break;case t.$t("electronicFence.rectangle"):t.ruleForm.regionType=2;break;case t.$t("electronicFence.polygon"):t.ruleForm.regionType=3}if(t.changeName===t.$t("electronicFence.new")){if(t.typeTitle===t.$t("electronicFence.circle")&&(t.ruleForm.latitude=t.circle.getCenter().lat,t.ruleForm.longitude=t.circle.getCenter().lng,t.ruleForm.viewAngle=t.map.getZoom()),t.typeTitle===t.$t("electronicFence.rectangle")||t.typeTitle===t.$t("electronicFence.polygon")){if(!t.flag)return void t.$message.error(t.$t("electronicFence.tip_16"));var n=null;t.typeTitle===t.$t("electronicFence.rectangle")&&(n=t.Bounds.getPath()),t.typeTitle===t.$t("electronicFence.polygon")&&(n=t.Polygon.getPath()),t.ruleForm.latitude=n.map(function(e){return e.lat}).join(","),t.ruleForm.longitude=n.map(function(e){return e.lng}).join(","),t.ruleForm.discription=r()(t.map.getCenter()),t.ruleForm.viewAngle=t.map.getZoom()}t.$http.post("/region/create",t.ruleForm).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$message({message:e.message,type:"success"}),t.close(),t.$parent.$refs.table.emitRequestTableData())})}else if(t.changeName===t.$t("operateCommon.edit")){if(t.typeTitle===t.$t("electronicFence.circle")&&(t.ruleForm.latitude=t.circle.getCenter().lat,t.ruleForm.longitude=t.circle.getCenter().lng,t.ruleForm.viewAngle=t.map.getZoom()),t.typeTitle===t.$t("electronicFence.rectangle")||t.typeTitle===t.$t("electronicFence.polygon")){var i=null;t.typeTitle===t.$t("electronicFence.rectangle")&&(i=t.Bounds.getPath()),t.typeTitle===t.$t("electronicFence.polygon")&&(i=t.Polygon.getPath()),t.ruleForm.latitude=i.map(function(e){return e.lat}).join(","),t.ruleForm.longitude=i.map(function(e){return e.lng}).join(","),t.ruleForm.discription=r()(t.map.getCenter()),t.ruleForm.viewAngle=t.map.getZoom()}t.$http.post("/region/update/"+t.regionId,t.ruleForm).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$message({message:e.message,type:"success"}),t.close(),t.$parent.$refs.table.emitRequestTableData())})}})},routeSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var n=t.points.some(function(e){return"start"===e.type}),i=t.points.some(function(e){return"end"===e.type});if(t.changeName===t.$t("electronicFence.new")){if(!n||!i)return void t.$message.error(t.$t("electronicFence.tip_17"));t.ruleForm.discription=r()(t.map.getCenter());var o=t.points.find(function(e){return"start"===e.type}),a=t.points.find(function(e){return"end"===e.type});t.ruleForm.startPoint=r()(o),t.ruleForm.endPoint=r()(a),t.ruleForm.opRouteTurns=t.opRouteTurns,t.ruleForm.viewAngle=t.map.getZoom(),t.$http.post("/route/create",t.ruleForm).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$message({message:e.message,type:"success"}),t.close(),t.$parent.$refs.table.emitRequestTableData())})}else if(t.changeName===t.$t("operateCommon.edit")){if(!n||!i)return void t.$message.error(t.$t("electronicFence.tip_17"));t.ruleForm.discription=r()(t.map.getCenter()),t.ruleForm.startPoint=r()(t.points[0]),t.ruleForm.endPoint=r()(t.points[1]),t.ruleForm.opRouteTurns=t.opRouteTurns,t.ruleForm.viewAngle=t.map.getZoom(),t.$http.post("/route/update/"+t.routeId,t.ruleForm).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$message({message:e.message,type:"success"}),t.close(),t.$parent.$refs.table.emitRequestTableData())})}})},adminSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.changeName===t.$t("electronicFence.new")?(t.ruleForm.discription=r()(t.map.getCenter()),t.ruleForm.viewAngle=t.map.getZoom(),t.$http.post("/admin/create",t.ruleForm).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$message({message:e.message,type:"success"}),t.close(),t.$parent.$refs.table.emitRequestTableData())})):t.changeName===t.$t("operateCommon.edit")&&(t.ruleForm.discription=r()(t.map.getCenter()),t.ruleForm.viewAngle=t.map.getZoom(),t.$http.post("/admin/update/"+t.adminId,t.ruleForm).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$message({message:e.message,type:"success"}),t.close(),t.$parent.$refs.table.emitRequestTableData())}))})}}},k=(n("62dZ"),n("7wwX"),n("ZrdR")),T=Object(k.a)($,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"map"}}),e._v(" "),n("el-button",{staticClass:"close",attrs:{plain:"",size:e.elNorms.size,round:e.elNorms.round,circle:e.elNorms.circle},on:{click:e.close}},[n("i",{staticClass:"el-icon-close"})]),e._v(" "),n("el-input",{staticClass:"search",attrs:{id:"suggestId",size:e.elNorms.size,placeholder:e.$t("electronicFence.national_search")},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e._v(" "),n("div",{staticStyle:{border:"1px solid #C0C0C0",width:"150px",height:"auto",display:"none"},attrs:{id:"searchResultPanel"}}),e._v(" "),n("el-select",{staticClass:"maps",attrs:{size:e.elNorms.size,placeholder:e.$t("electronicFence.please_select")},model:{value:e.maps,callback:function(t){e.maps=t},expression:"maps"}},[n("el-option",{attrs:{label:e.$t("electronicFence.baidu_map"),value:"baidu"}})],1),e._v(" "),e.changeName!==this.$t("electronicFence.details")?n("div",{staticClass:"form"},[n("div",{staticClass:"form_title"},[n("span",[e._v(e._s(e.typeTitle))]),e._v(" "),n("span",{staticStyle:{cursor:"pointer"},on:{click:function(t){e.formshow=!e.formshow}}},[n("i",{class:[e.formshow?"el-icon-arrow-up":"el-icon-arrow-down"]})])]),e._v(" "),n("el-form",{directives:[{name:"show",rawName:"v-show",value:e.formshow,expression:"formshow"}],ref:"ruleForm",staticClass:"demo-ruleForm",staticStyle:{"padding-top":"20px"},attrs:{model:e.ruleForm,rules:e.rules,size:e.elNorms.formSize,"label-width":"110px"}},[e.typeTitle!==e.$t("electronicFence.administrative_region")?n("el-form-item",{attrs:{label:e.$t("electronicFence.belong_company"),prop:"companyId"}},[n("el-select",{ref:"companySelect",attrs:{placeholder:e.$t("electronicFence.please_select_active_area"),size:e.elNorms.size},model:{value:e.ruleForm.companyId,callback:function(t){e.$set(e.ruleForm,"companyId",t)},expression:"ruleForm.companyId"}},[n("el-option",{key:"control",staticClass:"tree-select",attrs:{value:e.companyInfo.value,label:e.companyInfo.name}},[n("div",{on:{click:function(e){e.stopPropagation()}}},[n("el-input",{attrs:{placeholder:e.$t("electronicFence.search_name")},model:{value:e.companyFilterText,callback:function(t){e.companyFilterText=t},expression:"companyFilterText"}})],1),e._v(" "),n("el-tree",{ref:"companySelectTree",attrs:{data:e.company,props:e.defaultProps,"filter-node-method":e.companyFilterNode},on:{"node-click":e.nodeClick}})],1)],1)],1):e._e(),e._v(" "),n("el-form-item",{attrs:{label:e.$t("electronicFence.superior_category"),prop:"typeId"}},[n("el-select",{ref:"categorySelect",attrs:{placeholder:e.$t("electronicFence.select_superior_category"),size:e.elNorms.size},model:{value:e.ruleForm.typeId,callback:function(t){e.$set(e.ruleForm,"typeId",t)},expression:"ruleForm.typeId"}},[n("el-option",{key:"category",staticClass:"tree-select",attrs:{value:e.categoryInfo.value,label:e.categoryInfo.name}},[n("el-tree",{ref:"companySelectTree",attrs:{data:e.resetMenu,props:e.categoryProps},on:{"node-click":e.categoryNodeClick}})],1)],1)],1),e._v(" "),e.typeTitle===e.$t("electronicFence.circle")||e.typeTitle===e.$t("electronicFence.rectangle")||e.typeTitle===e.$t("electronicFence.polygon")?n("el-form-item",{attrs:{label:e.$t("electronicFence.region_name"),prop:"regionName"}},[n("el-input",{staticStyle:{width:"193px"},attrs:{size:e.elNorms.size},model:{value:e.ruleForm.regionName,callback:function(t){e.$set(e.ruleForm,"regionName",t)},expression:"ruleForm.regionName"}})],1):e._e(),e._v(" "),e.typeTitle===e.$t("electronicFence.line")?n("el-form-item",{attrs:{label:e.$t("electronicFence.line_name"),prop:"routeName"}},[n("el-input",{staticStyle:{width:"193px"},attrs:{size:e.elNorms.size},model:{value:e.ruleForm.routeName,callback:function(t){e.$set(e.ruleForm,"routeName",t)},expression:"ruleForm.routeName"}})],1):e._e(),e._v(" "),e.typeTitle===e.$t("electronicFence.administration")?n("el-form-item",{attrs:{label:e.$t("electronicFence.administrative_name"),prop:"adminName"}},[n("el-input",{staticStyle:{width:"193px"},attrs:{size:e.elNorms.size},model:{value:e.ruleForm.adminName,callback:function(t){e.$set(e.ruleForm,"adminName",t)},expression:"ruleForm.adminName"}})],1):e._e(),e._v(" "),e.typeTitle===e.$t("electronicFence.administration")?n("el-form-item",{attrs:{label:e.$t("electronicFence.administrative_region"),prop:"areaId"}},[n("el-cascader",{attrs:{"popper-class":"bd-map-area-cascader",size:e.elNorms.size,filterable:"",options:e.options,clearable:"","show-all-levels":!1,props:{checkStrictly:!0}},on:{change:e.handleChange},model:{value:e.ruleForm.areaId,callback:function(t){e.$set(e.ruleForm,"areaId",t)},expression:"ruleForm.areaId"}})],1):e._e(),e._v(" "),e.typeTitle!==e.$t("electronicFence.label_name")?n("el-form-item",{attrs:{label:e.$t("electronicFence.in_out_type"),prop:"entryType"}},[n("el-select",{attrs:{size:e.elNorms.size,clearable:"",filterable:"",placeholder:e.$t("electronicFence.tip_24")},model:{value:e.ruleForm.entryType,callback:function(t){e.$set(e.ruleForm,"entryType",t)},expression:"ruleForm.entryType"}},[n("el-option",{attrs:{label:e.$t("electronicFence.disable"),value:1}}),e._v(" "),n("el-option",{attrs:{label:e.$t("electronicFence.forbidden"),value:2}})],1)],1):e._e(),e._v(" "),e.typeTitle===e.$t("electronicFence.label_name")?n("el-form-item",{attrs:{label:e.$t("electronicFence.label_picture"),prop:"icon"}},[n("el-radio-group",{attrs:{size:e.elNorms.size},on:{change:e.iconFn},model:{value:e.ruleForm.icon,callback:function(t){e.$set(e.ruleForm,"icon",t)},expression:"ruleForm.icon"}},e._l(e.icons,function(e){return n("el-radio",{key:e.index,attrs:{label:e.index}},[n("span",{staticClass:"img_box"},[n("img",{attrs:{src:e.icon,alt:"",srcset:""}})])])}))],1):e._e(),e._v(" "),e.typeTitle===e.$t("electronicFence.label_name")?n("el-form-item",{attrs:{label:e.$t("electronicFence.label_name"),prop:"labelName"}},[n("el-input",{staticStyle:{width:"193px"},attrs:{size:e.elNorms.size},model:{value:e.ruleForm.labelName,callback:function(t){e.$set(e.ruleForm,"labelName",t)},expression:"ruleForm.labelName"}})],1):e._e(),e._v(" "),e.typeTitle===e.$t("electronicFence.label_name")?n("el-form-item",{attrs:{label:e.$t("electronicFence.region")}},[n("el-input",{staticStyle:{width:"193px"},attrs:{size:e.elNorms.size},model:{value:e.ruleForm.region,callback:function(t){e.$set(e.ruleForm,"region",t)},expression:"ruleForm.region"}})],1):e._e(),e._v(" "),e.typeTitle===e.$t("electronicFence.label_name")?n("el-form-item",{attrs:{label:e.$t("electronicFence.detailed_address")}},[n("el-input",{staticStyle:{width:"193px"},attrs:{size:e.elNorms.size},model:{value:e.ruleForm.address,callback:function(t){e.$set(e.ruleForm,"address",t)},expression:"ruleForm.address"}})],1):e._e(),e._v(" "),e.typeTitle===e.$t("electronicFence.label_name")||e.typeTitle===e.$t("electronicFence.circle")||e.typeTitle===e.$t("electronicFence.rectangle")||e.typeTitle===e.$t("electronicFence.polygon")?n("el-form-item",{attrs:{label:e.$t("electronicFence.radius_range")}},[n("el-input",{staticStyle:{width:"193px"},attrs:{size:e.elNorms.size},model:{value:e.ruleForm.radiusRange,callback:function(t){e.$set(e.ruleForm,"radiusRange",t)},expression:"ruleForm.radiusRange"}},[n("template",{slot:"append"},[e._v(e._s(e.$t("electronicFence.meter")))])],2)],1):e._e(),e._v(" "),n("div",{staticStyle:{margin:"20px auto","text-align":"center"}},[n("el-button",{attrs:{type:"primary",size:e.elNorms.size,round:e.elNorms.round,circle:e.elNorms.circle},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v(e._s(e.$t("operateCommon.ok")))]),e._v(" "),n("el-button",{attrs:{size:e.elNorms.size,round:e.elNorms.round,circle:e.elNorms.circle},on:{click:e.close}},[e._v(e._s(e.$t("operateCommon.cancel")))])],1)],1)],1):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowSetPointMenu,expression:"isShowSetPointMenu"}],staticClass:"set-point-menu",style:[e.setPoinntMenuCss]},[n("div",{staticClass:"menu-item",on:{click:e.setStartPoint}},[e._v(e._s(e.$t("electronicFence.from_here")))]),e._v(" "),n("div",{staticClass:"menu-item",on:{click:e.setPassPoint}},[e._v(e._s(e.$t("electronicFence.take_point")))]),e._v(" "),n("div",{staticClass:"menu-item",on:{click:e.setEndPoint}},[e._v(e._s(e.$t("electronicFence.end_here")))])])],1)},[],!1,null,"6eabcf92",null);T.options.__file="bd-map.vue";t.default=T.exports},GNt7:function(e,t,n){e.exports=n.p+"static/img/vehicle_pic_biaozhu_h.c6ebff2.png"},k3dh:function(e,t,n){e.exports=n.p+"static/img/replay_pic_zhong.82d781c.png"},mh7c:function(e,t,n){e.exports=n.p+"static/img/vehicle_pic_zfx.dd5e340.png"}}]);
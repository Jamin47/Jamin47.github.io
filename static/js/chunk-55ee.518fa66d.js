(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-55ee"],{"0yy0":function(e,t,i){"use strict";i.r(t);var a=i("AlM9"),n=i("BHIJ"),s={name:"SIMAdminister",components:{TableView:a.a,drawer:n.a},data:function(){return{title:"",deviceList:[],drawerDisplay:!1,drawerData:{},alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:"序号"},{title:"SIM号码",key:"simNum",sort:"custom",minWidth:"160",type:"text"},{title:"运营商",key:"operator",type:"tag",minWidth:"130",tags:[{value:1,text:"移动"},{value:2,text:"联通"},{value:3,text:"电信"},{value:4,text:"其他"}]},{title:"卡状态",key:"status",type:"tagText",minWidth:"130",tags:[{value:1,text:"已启用"},{value:0,text:"未启用",option:{type:"warning"}}]},{title:"车牌号码",key:"licenseNum",minWidth:"160",type:"text"},{title:"设备号",key:"deviceNum",minWidth:"160",type:"text"},{title:"套餐流量",key:"packageFlow",minWidth:"130",type:"text"},{title:"已用流量",key:"useFlow",minWidth:"130",type:"text"},{title:"发放城市",key:"city",minWidth:"130",type:"text"},{title:"到期时间",key:"timeoutAt",type:"text",minWidth:"220"},{title:"操作",type:"operate",key:"operate",fixed:"right",minWidth:"160",buttons:[{icon:"iconfont Jamin_vehicle_ico_xq",type:"text",size:"mini",funcName:"detail"},{icon:"iconfont Jamin_vehicle_icon_bj",type:"text",size:"mini",funcName:"edit"}]}],buttonControls:[{text:"添加SIM卡",type:"primary",size:"small",round:!1,icon:"el-icon-plus",funcName:"increase"},{text:"导出记录",type:"null",size:"small",round:!1,icon:"el-icon-download",funcName:"export"}],searchControls:[{type:"input",key:"deviceNum",placeholder:"设备号",width:"200px",size:"small"},{type:"input",key:"simNum",placeholder:"SIM号码",width:"200px",size:"small"}],footerButtons:[{text:"删除",type:"danger",size:"small",icon:"el-icon-delete",round:!1,funcName:"delete"}],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1}}},computed:{},created:function(){},mounted:function(){!0===this.$route.params.open&&this.increase()},methods:{getTableData:function(e){var t=this;this.tableOptions.loading=!0;var i={deviceNum:e.deviceNum,simNum:e.simNum};this.$http.post("/sim/list?pageNum="+e.pageNum+"&pageSize="+e.pageSize,i).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.tableOptions.loading=!1,t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total)})},newDevice:function(){var e=this;this.$http.get("/device/list/sim/all").then(function(t){e.deviceList=[],t.code===e.$config.API_STATUS.OK&&(t.data.forEach(function(t,i){e.$set(e.deviceList,i,{value:t.deviceId,name:t.deviceNum})}),e.drawerDisplay=!0,e.increaseData())})},oldDevice:function(e){var t=this;this.$http.get("/device/list/sim/all/"+e.simId).then(function(i){t.deviceList=[],i.code===t.$config.API_STATUS.OK&&(i.data.forEach(function(e,i){t.$set(t.deviceList,i,{value:e.deviceId,name:e.deviceNum})}),t.drawerDisplay=!0,"编辑"===t.title?t.editData(e):t.detailData(e))})},tableResponseFn:function(e,t,i){this[t.funcName].call(function(){},e,t,i)},increase:function(e){this.newDevice()},increaseData:function(){this.drawerData={isShow:!0,title:"添加SIM卡",titleWidth:"120",data:{},defaultData:"",submitAction:"/sim/create",btnAlign:"center",formList:[{title:"SIM号码",type:"input",key:"simNum",offsetWidth:"320",rules:[{required:!0,message:"请输入SIM号码",trigger:"blur"}]},{title:"ICCID",type:"input",offsetWidth:"320",key:"iccid"},{title:"运营商",type:"select",key:"operator",offsetWidth:"320",options:{type:"default",list:[{name:"移动",value:1},{name:"联通",value:2},{name:"电信",value:3},{name:"其他",value:4}]},rules:[{required:!0,message:"请绑定运营商",trigger:"change"}]},{title:"卡状态",type:"select",key:"status",offsetWidth:"320",options:{type:"default",list:[{name:"已启用",value:1},{name:"未启用",value:0}]}},{title:"发放城市",type:"input",offsetWidth:"320",key:"city"},{title:"到期时间",type:"dateSelect",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"timeoutAt",rules:[{required:!0,message:"请选择到期时间",trigger:"change"}]},{title:"套餐流量",type:"input",offsetWidth:"320",key:"packageFlow"},{title:"绑定设备",type:"select",key:"deviceId",clearable:!0,offsetWidth:"320",options:{type:"default",list:this.deviceList}},{title:"备注说明",type:"input",offsetWidth:"320",key:"remark"}],formButton:[{name:"确定",type:"confirm",class:"primary"},{name:"取消",type:"cancel",class:""}],message:{type:"success",message:"添加成功！"}}},delete:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i=[];e.forEach(function(e,t){i[t]=e.simId}),t.$http.deleteApi("/sim/delete",{ids:i.join(",")}).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$refs.table.emitRequestTableData(),t.$message({message:e.message,type:"success"}))})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},edit:function(e){this.title="编辑",this.oldDevice(e)},editData:function(e){this.drawerData={staticData:e,isShow:!0,title:"编辑SIM卡",titleWidth:"120",data:{},defaultData:"",submitAction:"/sim/update/"+e.simId,btnAlign:"center",formList:[{title:"SIM号码",type:"input",offsetWidth:"320",key:"simNum",rules:[{required:!0,message:"请输入SIM号码",trigger:"blur"}]},{title:"ICCID",type:"input",offsetWidth:"320",key:"iccid"},{title:"运营商",type:"select",key:"operator",offsetWidth:"320",options:{type:"default",list:[{name:"移动",value:1},{name:"联通",value:2},{name:"电信",value:3},{name:"其他",value:4}]},rules:[{required:!0,message:"请绑定运营商",trigger:"change"}]},{title:"卡状态",type:"select",key:"status",offsetWidth:"320",options:{type:"default",list:[{name:"已启用",value:1},{name:"未启用",value:0}]},rules:[{required:!0,message:"请选择卡状态",trigger:"change"}]},{title:"发放城市",type:"input",offsetWidth:"320",key:"city"},{title:"到期时间",type:"dateSelect",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"timeoutAt",rules:[{required:!0,message:"请选择到期时间",trigger:"change"}]},{title:"套餐流量",type:"input",offsetWidth:"320",key:"packageFlow"},{title:"绑定设备",type:"select",key:"deviceId",offsetWidth:"320",options:{type:"default",list:this.deviceList}},{title:"备注说明",type:"input",offsetWidth:"320",key:"remark"}],formButton:[{name:"确定",type:"confirm",class:"primary"},{name:"取消",type:"cancel",class:""}],message:{type:"success",message:"编辑成功！"}}},detail:function(e){this.title="详情",this.oldDevice(e)},detailData:function(e){this.drawerData={staticData:e,isShow:!0,title:"SIM卡详情",titleWidth:"120",data:{},defaultData:"",btnAlign:"center",formList:[{title:"SIM号码",type:"text",key:"simNum"},{title:"ICCID",type:"text",key:"iccid"},{title:"运营商",type:"textSelect",key:"operator",offsetWidth:"320",list:[{name:"移动",value:1},{name:"联通",value:2},{name:"电信",value:3},{name:"其他",value:4}]},{title:"卡状态",type:"textSelect",key:"status",offsetWidth:"320",list:[{name:"已启用",value:1},{name:"未启用",value:0}]},{title:"发放城市",type:"text",key:"city"},{title:"到期时间",type:"text",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"timeoutAt"},{title:"套餐流量",type:"text",key:"packageFlow"},{title:"绑定设备",type:"textSelect",key:"deviceId",list:this.deviceList},{title:"备注说明",type:"text",key:"remark"}]}},export:function(){var e=this;this.$confirm("确认导出记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1,beforeClose:function(t,i,a){e.fieldMap={},e.tableOptions.columns.forEach(function(t){e.$refs.table.columnCheckList.forEach(function(i){t.key===i&&"operate"!==t.key&&(e.fieldMap[i]=t.title)})});var n=e.$refs.table._data.searchParams,s=n.deviceNum,l=n.simNum;if("confirm"===t){var o={fieldMap:e.fieldMap,deviceNum:s,simNum:l};e.$http.download("/sim/export?isToken=true",o).then(function(e){}),a()}else a()}}).catch(function(){})},diaClose:function(){this.$refs.table.emitRequestTableData(),this.drawerDisplay=!1},drawerCallback:function(e,t,i,a){this[e.handlerCallback.funcName].call(function(){},t,i,a)}}},l=(i("6Oog"),i("ZrdR")),o=Object(l.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page-wrap"},[i("table-view",{ref:"table",attrs:{stripe:"",center:"","id-key":"id","is-search":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,checked:"","is-shadow":"","column-view":"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[i("el-table-column",{attrs:{slot:"number",label:"序号",type:"index",align:"center"},slot:"number"})],1),e._v(" "),e.drawerDisplay?i("drawer",{attrs:{size:"small","drawer-data":e.drawerData},on:{diaClose:e.diaClose,handlerCallback:e.drawerCallback}}):e._e()],1)},[],!1,null,"ac22867a",null);o.options.__file="SIMAdminister.vue";t.default=o.exports},"6Oog":function(e,t,i){"use strict";var a=i("swZP");i.n(a).a},swZP:function(e,t,i){}}]);
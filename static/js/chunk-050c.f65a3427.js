(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-050c","chunk-3d9e","chunk-6c66","Cy+k"],{"/sbf":function(e,t,i){},"21ia":function(e,t,i){e.exports=i.p+"static/img/17_cb_xs.75e5041.png"},"2LiM":function(e,t,i){e.exports=i.p+"static/img/16_jc_xs.ead5176.png"},"90Lc":function(e,t,i){"use strict";var a=i("u9vl");i.n(a).a},"9ADt":function(e,t,i){e.exports=i.p+"static/img/01_kc_xs.85c19c4.png"},"APD+":function(e,t,i){"use strict";var a=i("/sbf");i.n(a).a},BcvX:function(e,t,i){"use strict";i.r(t);var a=i("bS4n"),n=i.n(a),o=i("ABCu"),s=i("Cy+k"),c=i("mSNy"),r=i("8t5x"),l={components:{treeView:o.a},mixins:[s.default],data:function(){return{drawerObj:{isShow:!1,title:c.a.t("vehicleAdminister.quickly_add_vehicle"),size:"500px",formLabelWidth:"140px",formWidth:"280px",loading:!1},formData:{createType:3,deviceIds:[],deviceNum:null,licenseNum:null,simNum:null,licenseColor:2,motorcadeId:null,motorcadeName:null,deviceType:1,channelNum:0,channelNames:[],icon:"02_czc_"},rules:{deviceNum:[{required:!0,message:c.a.t("vehicleAdminister.device_num_rule"),trigger:"blur"}],licenseNum:[{required:!0,message:c.a.t("vehicleAdminister.enter_license_plate_number"),trigger:"blur"}],motorcadeId:[{required:!0,message:c.a.t("devicePage.form_rule_message_2"),trigger:"blur"}]},channeObj:{},deviceList:[],deviceType:[],licenseColor:[],devNumList:[],channelTotal:37,deviceNumPopover:!1,devNumListSearchStatus:!1,devNumListSearch:"",motorcadeTreeData:[],motorcadeOption:{motorcadeId:null,name:null,filter:"",treeOption:{defaultProps:{children:"opMotorcadeNodes",label:"name"},nodeKey:"motorcadeId",defaultExpandAll:!1,expandClickNode:!1,screenFn:{bindFn:function(e,t){return!e||-1!==t.name.indexOf(e)}}}},iconList:[{name:c.a.t("vehicleAdminister.bus"),value:"01_kc_",iconUrl:i("9ADt")},{name:c.a.t("vehicleAdminister.taxi"),value:"02_czc_",iconUrl:i("yEz2")},{name:c.a.t("vehicleAdminister.school_bus"),value:"03_xc_",iconUrl:i("l+Cu")},{name:c.a.t("vehicleAdminister.truck"),value:"04_hc_",iconUrl:i("j+9R")},{name:c.a.t("vehicleAdminister.container_truck"),value:"05_jzxc_",iconUrl:i("qOkx")},{name:c.a.t("vehicleAdminister.tank_car"),value:"06_gc_",iconUrl:i("YWMK")},{name:c.a.t("vehicleAdminister.tractor_text_1"),value:"07_qyc_",iconUrl:i("lpko")},{name:c.a.t("vehicleAdminister.trailer"),value:"08_gc_",iconUrl:i("bqyo")},{name:c.a.t("vehicleAdminister.flatbed_car"),value:"09_pbc_",iconUrl:i("L+qT")},{name:c.a.t("vehicleAdminister.concrete_mixing_tank_truck"),value:"10_jbgc_",iconUrl:i("aL2/")},{name:c.a.t("vehicleAdminister.dangerous_goods_transport_vehicle"),value:"11_wxpysc_",iconUrl:i("fZjX")},{name:c.a.t("vehicleAdminister.agricultural_vehicles"),value:"12_nyc_",iconUrl:i("p0cv")},{name:c.a.t("vehicleAdminister.tractor_text_2"),value:"13_tlj_",iconUrl:i("iREr")},{name:c.a.t("vehicleAdminister.sanitation_garbage_truck"),value:"14_hwljc_",iconUrl:i("yrqw")},{name:c.a.t("vehicleAdminister.muck_truck"),value:"15_ztc_",iconUrl:i("La+X")},{name:c.a.t("vehicleAdminister.police_car"),value:"16_jc_",iconUrl:i("2LiM")},{name:c.a.t("vehicleAdminister.vessel"),value:"17_cb_",iconUrl:i("21ia")}]}},computed:n()({},Object(r.b)(["elNorms"])),watch:{"motorcadeOption.filter":function(e){this.$refs._motorcade_type_tree.$refs.sonTree.filter(e)},"formData.channelNum":function(e){this.channeObj={};for(var t=[],i=0;i<e;i++)this.$set(this.channeObj,i,"CH"+(i+1)),t.push(this.channeObj[i]);this.formData.channelNames=t}},created:function(){this.getCodesFn(),this.isPermissionShow("vehicleFastCreate")&&this.getMotorcadeTreeDataFn()},methods:{getCodesFn:function(){var e=this;this.$http.get("/dict/list/codes",{dicCodes:"deviceType, licenseColor"}).then(function(t){if(t.code===e.$config.API_STATUS.OK)for(var i in t.data)e[i]=t.data[i].map(function(e){return{value:e.itemName,label:e.itemValue}});e.getDevNumDataFn()})},getDevNumDataFn:function(){var e=this;this.$http.get("/device/list/vehicle/all").then(function(t){t.code===e.$config.API_STATUS.OK&&t.data&&(e.devNumList=t.data.map(function(t){return{deviceNum:t.deviceNum,companyId:t.companyId,companyName:t.companyName,deviceType:t.deviceType,deviceTypeName:e.deviceTypeOfNameFn(t.deviceType)}}))})},deviceTypeOfNameFn:function(e){for(var t="",i=0;i<this.deviceType.length;i++){var a=this.deviceType[i];if(a.value===e){t=a.label;break}}return t},getMotorcadeTreeDataFn:function(){var e=this;this.$http.get("/vehicle/motorcade/treeList").then(function(t){t.code===e.$config.API_STATUS.OK&&(e.motorcadeTreeData=t.data[0].opMotorcadeNodes)})},openFn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;this.formData=this.$options.data().formData,this.motorcadeOption=this.$options.data().motorcadeOption,this.deviceNumPopover=!1,this.devNumListSearchStatus=!1,this.devNumListSearch="",this.deviceList=[],this.formData.createType=t,Array.isArray(e)?(this.deviceList=e,this.formData.deviceIds=e.map(function(e){return e.deviceId})):this.formData.deviceNum=e.deviceNum,1===t&&(e.deviceLicenseNum?this.formData.licenseNum=e.deviceLicenseNum:this.formData.licenseNum=e.deviceNum),this.drawerObj.isShow=!0},motorcadeNodeClick:function(e,t,i){this.$set(this[i],"motorcadeId",e.motorcadeId),this.$set(this[i],"motorcadeName",e.name),this.$set(this.motorcadeOption,"motorcadeId",e.motorcadeId),this.$set(this.motorcadeOption,"name",e.name),this.$refs._motorcade_tree_select.blur()},deviceNumTableRowDblclickFn:function(e){this.formData.deviceNum=e.deviceNum,this.deviceNumPopover=!1},filterDevNumList:function(){var e=this;return this.devNumList.filter(function(t){return!e.devNumListSearch||t.deviceNum.toLowerCase().includes(e.devNumListSearch.toLowerCase())})},submitFn:function(){var e=this;this.$refs._form.validate(function(t){t&&(e.drawerObj.loading=!0,e.$http.post("/vehicle/fastCreate",e.formData).then(function(t){e.drawerObj.loading=!1,t.code===e.$config.API_STATUS.OK&&(e.drawerObj.isShow=!1,e.$message.success(t.message),e.$parent.emitRequestFn&&e.$parent.emitRequestFn())}).catch(function(){e.drawerObj.loading=!1}))})}}},d=(i("APD+"),i("ZrdR")),u=Object(d.a)(l,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-drawer",{attrs:{title:e.drawerObj.title,visible:e.drawerObj.isShow,size:e.drawerObj.size,"wrapper-closable":!1},on:{"update:visible":function(t){e.$set(e.drawerObj,"isShow",t)}}},[i("div",{staticClass:"drawer-body"},[i("el-form",{ref:"_form",attrs:{model:e.formData,rules:e.rules,size:e.elNorms.formSize,"label-width":e.drawerObj.formLabelWidth}},[3===e.formData.createType?i("el-form-item",{attrs:{label:e.$t("vehicleAdminister.equipment_number")+"："}},[i("div",[e._v("已选择未注册设备 "+e._s(e.deviceList.length)+" 个")])]):e._e(),e._v(" "),1===e.formData.createType?i("el-form-item",{attrs:{label:this.$t("vehicleAdminister.equipment_number")+"：",prop:"deviceNum"}},[i("el-input",{style:"width: "+e.drawerObj.formWidth+";",attrs:{size:e.elNorms.size,disabled:!0},model:{value:e.formData.deviceNum,callback:function(t){e.$set(e.formData,"deviceNum",t)},expression:"formData.deviceNum"}},[e._e()],2)],1):e._e(),e._v(" "),1===e.formData.createType?i("el-form-item",{attrs:{label:e.$t("vehicleAdminister.license_plate_number")+"：",prop:"licenseNum"}},[i("el-input",{style:"width: "+e.drawerObj.formWidth+";",attrs:{size:e.elNorms.size},model:{value:e.formData.licenseNum,callback:function(t){e.$set(e.formData,"licenseNum",t)},expression:"formData.licenseNum"}})],1):e._e(),e._v(" "),1===e.formData.createType?i("el-form-item",{attrs:{label:this.$t("vehicleAdminister.sim_number")+"："}},[i("el-input",{style:"width: "+e.drawerObj.formWidth+";",attrs:{size:e.elNorms.size},model:{value:e.formData.simNum,callback:function(t){e.$set(e.formData,"simNum",t)},expression:"formData.simNum"}})],1):e._e(),e._v(" "),1===e.formData.createType?i("el-form-item",{attrs:{label:e.$t("vehicleAdminister.license_plate_color")+"：",prop:"licenseColor"}},[i("el-select",{style:"width: "+e.drawerObj.formWidth+";",attrs:{size:e.elNorms.size,filterable:""},model:{value:e.formData.licenseColor,callback:function(t){e.$set(e.formData,"licenseColor",t)},expression:"formData.licenseColor"}},e._l(e.licenseColor,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:e.$t("vehicleAdminister.fleet")+"：",prop:"motorcadeId"}},[i("el-select",{ref:"_motorcade_tree_select",style:"width: "+e.drawerObj.formWidth+";",attrs:{size:e.elNorms.size},model:{value:e.formData.motorcadeId,callback:function(t){e.$set(e.formData,"motorcadeId",t)},expression:"formData.motorcadeId"}},[i("el-option",{staticClass:"tree-select",attrs:{value:e.formData.motorcadeId,label:e.formData.motorcadeName}},[i("div",{staticClass:"input-query",on:{click:function(e){e.stopPropagation()}}},[i("el-input",{attrs:{size:e.elNorms.size,placeholder:e.$t("vehicleAdminister.fleet"),"prefix-icon":"el-icon-search"},model:{value:e.motorcadeOption.filter,callback:function(t){e.$set(e.motorcadeOption,"filter","string"==typeof t?t.trim():t)},expression:"motorcadeOption.filter"}})],1),e._v(" "),i("tree-view",{ref:"_motorcade_type_tree",attrs:{"tree-data":e.motorcadeOption.treeOption,"defined-data":e.motorcadeTreeData},on:{"node-click":function(t){e.motorcadeNodeClick(arguments[0],arguments[1],"formData")}},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticStyle:{"font-weight":"400"}},[e._v(e._s(t.data.node.label))])]}}])})],1)],1)],1),e._v(" "),i("el-form-item",{attrs:{label:e.$t("devicePage.device_type"),prop:"deviceType"}},[i("el-select",{style:"width: "+e.drawerObj.formWidth+";",attrs:{size:e.elNorms.size},on:{change:function(t){e.formData.channelNum=0}},model:{value:e.formData.deviceType,callback:function(t){e.$set(e.formData,"deviceType",t)},expression:"formData.deviceType"}},e._l(e.deviceType,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),1===e.formData.deviceType?i("el-form-item",{attrs:{label:e.$t("devicePage.channel_number"),prop:"deviceType"}},[i("el-select",{style:"width: "+e.drawerObj.formWidth+";",attrs:{size:e.elNorms.size},model:{value:e.formData.channelNum,callback:function(t){e.$set(e.formData,"channelNum",t)},expression:"formData.channelNum"}},e._l(e.channelTotal,function(e){return i("el-option",{key:e-1,attrs:{label:e-1,value:e-1}})})),e._v(" "),e._l(e.channeObj,function(t,a){return i("el-input",{key:a,staticClass:"channel-input",attrs:{size:e.elNorms.size},model:{value:e.channeObj[a],callback:function(t){e.$set(e.channeObj,a,t)},expression:"channeObj[key]"}})})],2):e._e(),e._v(" "),i("el-form-item",{attrs:{label:e.$t("vehicleAdminister.vehicle_icon")}},[i("el-radio-group",{staticStyle:{width:"340px"},model:{value:e.formData.icon,callback:function(t){e.$set(e.formData,"icon",t)},expression:"formData.icon"}},e._l(e.iconList,function(e){return i("el-radio",{key:e.value,attrs:{label:e.value}},[i("img",{staticStyle:{height:"28px","vertical-align":"middle"},attrs:{src:e.iconUrl,alt:""}})])}))],1)],1)],1),e._v(" "),i("div",{staticClass:"footer-button"},[i("el-button",{attrs:{type:"primary",size:e.elNorms.size,round:e.elNorms.round,circle:e.elNorms.circle,loading:e.drawerObj.loading,disabled:e.drawerObj.loading},on:{click:e.submitFn}},[e._v(e._s(e.$t("operateCommon.ok")))]),e._v(" "),i("el-button",{attrs:{size:e.elNorms.size,round:e.elNorms.round,circle:e.elNorms.circle},on:{click:function(t){e.drawerObj.isShow=!1}}},[e._v(e._s(e.$t("operateCommon.cancel")))])],1)])},[],!1,null,"4745a3e7",null);u.options.__file="vehicleQuicklyAdd.vue";t.default=u.exports},"Cy+k":function(e,t,i){"use strict";i.r(t);var a=i("bS4n"),n=i.n(a),o=i("8t5x");t.default={data:function(){return{permissionList:{deviceList:"/device/list",deviceDetail:"/device/get/**",deviceCreate:"/device/create",deviceUpdate:"/device/update/**",deviceExport:"/device/export",deviceDelete:"/device/delete",vehicleFastCreate:"/vehicle/fastCreate",upgradeList:"/upgrade/list",upgradeListTask:"/upgrade/list/task",upgradeListRecord:"/upgrade/list/record",upgradeUpdate:"/upgrade/update/**",upgradeCreate:"/upgrade/create",upgradeDelete:"/upgrade/delete",upgradePush:"/upgrade/push",resetUpgradePush:"/upgrade/push/**",upgradeTaskPush:"/upgrade/task/push",upgradeTaskFailPush:"/upgrade/task/fail/push",deviceSettings:"/device/settings",deviceControlSetPassword:"/device/control/set/password",deviceControl:"/device/control",deviceControlDiskFormat:"/device/control/disk/format",deviceControlVehicle:"/device/control/vehicle",deviceTerminalText:"/device/terminal/text",deviceTerminalEvents:"/device/terminal/events",deviceTerminalQuestion:"/device/terminal/question",deviceTerminalNews:"/device/terminal/news",deviceTerminalCamera:"/device/terminal/camera",deviceTerminalSoundRecord:"/device/terminal/soundRecord",deviceTerminalVoiceMonitor:"/device/terminal/voiceMonitor",deviceOrderOffline:"/device/order/offline",deviceOrderOfflineExport:"/device/order/offline/export",deviceOrderDelete:"/device/order/delete",deviceOrderHistory:"/device/order/history",deviceOrderHistoryExport:"/device/order/history/export",simList:"/sim/list",simCreate:"/sim/create",simUpdate:"/sim/update/**",simDelete:"/sim/delete",simExport:"/sim/export"}}},computed:n()({},Object(o.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[e])}}}},"L+qT":function(e,t,i){e.exports=i.p+"static/img/09_pbc_xs.063916b.png"},LXQf:function(e,t,i){"use strict";i.r(t);var a=i("bS4n"),n=i.n(a),o=i("AlM9"),s=i("NV8S"),c=i("QWdd"),r=i("BcvX"),l=i("XVnh"),d=i("Cy+k"),u=i("8t5x"),m={name:"DeviceAdminister",components:{TableView:o.a,NotTableView:o.a,DeviceEdit:s.default,AmapPosition:c.default,QuicklyAddVehicle:r.default,notPerm:l.a},mixins:[d.default],data:function(){return{isTable:!0,activeName:"register",alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,checkDisabledOption:[{key:"bindStatus",value:1}],columns:[{type:"slot",name:"number",title:this.$t("devicePage.index")},{title:this.$t("devicePage.device_num"),key:"deviceNum",type:"text",minWidth:"130"},{title:this.$t("devicePage.sim_num"),key:"simNum",type:"text",minWidth:"130"},{title:this.$t("devicePage.device_type"),key:"deviceType",type:"tagText",width:"120",tags:[{value:1,text:this.$t("devicePage.device_type_1")},{value:2,text:this.$t("devicePage.device_type_2")}]},{title:this.$t("devicePage.device_model"),key:"deviceModel",type:"text",minWidth:"100"},{title:this.$t("devicePage.manufacturer"),key:"manufacturer",type:"text",minWidth:"120"},{title:this.$t("devicePage.license_num"),key:"licenseNum",type:"text",width:"140"},{title:this.$t("devicePage.company_name"),key:"companyName",type:"text",minWidth:"120"},{title:this.$t("devicePage.online_status"),key:"onlineStatus",type:"tagText",width:"120",tags:[{value:0,text:this.$t("devicePage.online_status_false"),option:{type:"danger"}},{value:1,text:this.$t("devicePage.online_status_true")}]},{title:this.$t("devicePage.last_time"),key:"lastPositionTime",type:"text",width:"160"},{title:this.$t("operation.operation"),type:"operate",key:"operate",fixed:"right",width:"120",buttons:[]}],buttonControls:[],searchControls:[{type:"treeSelect",key:"companyIds",valueKey:"companyId",placeholder:this.$t("devicePage.company_name"),width:"200px",treeOption:{defaultProps:{children:"sysCompanyNodes",label:"name"},nodeKey:"companyId",defaultExpandAll:!1,expandClickNode:!1,checkbox:!0,screenFn:{bindFn:function(e,t){return!e||-1!==t.name.indexOf(e)}}},treeDefinedData:[]},{type:"input",key:"deviceNum",placeholder:this.$t("devicePage.device_num"),width:"180px"},{type:"input",key:"simNum",placeholder:this.$t("devicePage.sim_num"),width:"180px"},{type:"select",key:"bindVehicle",placeholder:this.$t("devicePage.bind_status"),width:"140px",clearable:!0,options:[{name:this.$t("devicePage.bind_status_false"),value:0},{name:this.$t("devicePage.bind_status_true"),value:1}]},{type:"select",key:"onlineStatus",placeholder:this.$t("devicePage.online_status"),width:"140px",clearable:!0,options:[{name:this.$t("devicePage.online_status_false"),value:0},{name:this.$t("devicePage.online_status_true"),value:1}]}],searchMode:"immediate",footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1},notTableOptions:{data:[],total:0,checkDisabledOption:[{key:"bindStatus",value:1}],columns:[{type:"slot",name:"number",title:this.$t("devicePage.index")},{title:this.$t("devicePage.device_num"),key:"deviceNum",type:"text",minWidth:"130"},{title:this.$t("view.license_num"),key:"deviceLicenseNum",type:"text",minWidth:"130"},{title:this.$t("devicePage.lat_lng"),key:"longitudeOfLatitude",type:"slot",name:"location"},{title:this.$t("devicePage.online_status"),key:"onlineStatus",type:"tagText",width:"120",tags:[{value:0,text:this.$t("devicePage.online_status_false"),option:{type:"danger"}},{value:1,text:this.$t("devicePage.online_status_true")}]},{title:this.$t("devicePage.last_position_time"),key:"lastPositionTime",type:"text",minWidth:"130"},{title:this.$t("devicePage.network"),key:"network",type:"text",minWidth:"130"},{title:this.$t("devicePage.protocol_type"),key:"protocolType",type:"tagText",minWidth:"140",tags:[]},{title:this.$t("devicePage.gateway_ip"),key:"gatewayIp",type:"text",minWidth:"130"},{title:this.$t("devicePage.device_model"),key:"deviceModel",type:"text",minWidth:"130"},{title:this.$t("devicePage.manufacturer"),key:"manufacturer",type:"text",minWidth:"120"},{title:this.$t("operation.operation"),type:"operate",key:"operate",fixed:"right",width:"120",buttons:[]}],buttonControls:[],searchControls:[{type:"input",key:"deviceNum",placeholder:this.$t("devicePage.device_num"),width:"180px"},{type:"input",key:"manufacturer",placeholder:this.$t("devicePage.manufacturer"),width:"180px"},{type:"select",key:"onlineStatus",placeholder:this.$t("devicePage.online_status"),width:"140px",clearable:!0,options:[{name:this.$t("devicePage.online_status_false"),value:0},{name:this.$t("devicePage.online_status_true"),value:1}]}],searchMode:"immediate",footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1},companyTreeData:[],params:null}},computed:n()({},Object(u.b)(["elNorms"])),watch:{activeName:function(e){var t=this;this.isTable=!1,this.$nextTick(function(){t.isTable=!0})}},created:function(){this.getCodeFn(),this.getCompanyTreeDataFn()},mounted:function(){!0===this.$route.params.open&&this.details()},methods:{handlePermissionShow:function(){this.tableOptions.buttonControls=[],this.isPermissionShow("deviceCreate")&&this.tableOptions.buttonControls.push({text:this.$t("devicePage.table_button_add"),icon:"el-icon-plus",size:"small",round:!1,funcName:"details"}),this.isPermissionShow("deviceExport")&&this.tableOptions.buttonControls.push({text:this.$t("devicePage.table_button_export"),type:"null",icon:"el-icon-folder-opened",size:"small",funcName:"exportRecord",dataStatus:!0}),this.tableOptions.footerButtons=[],this.notTableOptions.footerButtons=[],this.isPermissionShow("deviceDelete")&&this.tableOptions.footerButtons.push({text:this.$t("operation.delete"),type:"danger",size:"small",icon:"el-icon-delete",round:!1,funcName:"delete"}),this.isPermissionShow("deviceDelete")&&this.notTableOptions.footerButtons.push({text:this.$t("operation.delete"),type:"danger",size:"small",icon:"el-icon-delete",round:!1,funcName:"delete"}),this.isPermissionShow("vehicleFastCreate")&&this.notTableOptions.footerButtons.push({text:this.$t("vehicleAdminister.quickly_add_vehicle"),icon:"el-icon-plus",funcName:"quicklyAddVehicleFn"});var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});this.tableOptions.columns[e].buttons=[],e>-1&&this.isPermissionShow("deviceDetail")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("operation.detail"),icon:"iconfont Jamin_vehicle_ico_xq",type:"text",funcName:"detail"}),e>-1&&this.isPermissionShow("deviceUpdate")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("operation.edit"),icon:"iconfont Jamin_vehicle_icon_bj",type:"text",funcName:"edit"});var t=this.notTableOptions.columns.findIndex(function(e){return"operate"===e.key});this.notTableOptions.columns[t].buttons=[],t>-1&&this.isPermissionShow("vehicleFastCreate")&&this.notTableOptions.columns[t].buttons.push({tipText:this.$t("operation.authorize"),icon:"iconfont Jamin_vehicle_icon_bj",type:"text",funcName:"authorizeFn"})},getTableData:function(e){var t=this;if(this.tableOptions.loading=!0,this.companyTreeData.length){var i={companyIds:e.companyIds?JSON.parse(e.companyIds):[],deviceNum:e.deviceNum,simNum:e.simNum,bindVehicle:e.bindVehicle,onlineStatus:e.onlineStatus,status:1};this.$http.post("/device/list?pageNum="+e.pageNum+"&pageSize="+e.pageSize,i).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.tableOptions.loading=!1,t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total)}),this.params=e}},getCompanyTreeDataFn:function(){var e=this;this.$http.get("/company/device/treeList").then(function(t){t.code===e.$config.API_STATUS.OK&&(e.companyTreeData=t.data,e.tableOptions.searchControls[0].treeDefinedData=e.companyTreeData,e.notTableOptions.searchControls[0].treeDefinedData=e.companyTreeData,e.isTable=!1,e.$nextTick(function(){e.isTable=!0}))})},getNotTableData:function(e){var t=this;this.notTableOptions.loading=!0;var i={deviceNum:e.deviceNum,manufacturer:e.manufacturer,onlineStatus:e.onlineStatus,status:0};this.$http.post("/device/list?pageNum="+e.pageNum+"&pageSize="+e.pageSize,i).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.notTableOptions.loading=!1,t.notTableOptions.data=e.data.list,t.notTableOptions.total=e.data.total)})},getCodeFn:function(){var e=this;this.$http.get("/dict/list/codes",{dicCodes:"protocolType"}).then(function(t){t.code===e.$config.API_STATUS.OK&&(e.notTableOptions.columns[7].tags=t.data.protocolType.map(function(e){return{text:e.itemValue,value:e.itemName}}))})},tableResponseFn:function(e,t,i){this[t.funcName].call(function(){},e,t,i)},details:function(e){this.$refs._device_edit.details(e)},detail:function(e){this.$refs._device_edit.detail(e)},edit:function(e){this.$refs._device_edit.edit(e)},delete:function(e){var t=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel")}).then(function(){var i=e.map(function(e){return e.deviceId});t.$http.deleteApi("/device/delete",{ids:i.join(",")}).then(function(e){e.code===t.$config.API_STATUS.OK&&("register"===t.activeName?t.$refs.table.emitRequestTableData():t.$refs._not_table.emitRequestTableData(),t.$message.success(t.$t("message.success")))})})},exportRecord:function(){var e=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),closeOnClickModal:!1,beforeClose:function(t,i,a){var n="register"===e.activeName?"table":"_not_table";if(e.fieldMap={},e.tableOptions.columns.forEach(function(t){e.$refs[n].columnCheckList.forEach(function(i){t.key===i&&"operate"!==t.key&&(e.fieldMap[i]=t.title)})}),"confirm"===t){var o=e.params,s=o.companyIds,c=o.deviceNum,r=o.simNum,l=o.bindVehicle,d=o.onlineStatus,u={fieldMap:e.fieldMap,companyIds:s?JSON.parse(s):null,deviceNum:c,simNum:r,bindVehicle:l,onlineStatus:d};e.tableOptions.total<e.$store.getters.userData.realtimeVideoUrl?e.$http.download("/device/export?isToken=true",u):e.$http.post("/device/export/async",u),a()}else a()}}).catch(function(){})},emitRequestFn:function(){var e=this;this.$nextTick(function(){var t="register"===e.activeName?"table":"_not_table";e.$refs[t].initRequestTableData()})},openMapFn:function(e){this.$refs._amap_position.openFn(e)},quicklyAddVehicleFn:function(e){this.$refs._quickly_add_vehicle.openFn(e)},authorizeFn:function(e){this.$refs._quickly_add_vehicle.openFn(e,1)}}},p=(i("j61K"),i("ZrdR")),h=Object(p.a)(m,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page-wrap"},[e.isPermissionShow("deviceList")?[i("el-tabs",{staticClass:"init-tabs",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{name:"register"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"iconfont Jamin_device_icon_yzcsb"}),e._v(" "+e._s(e.$t("devicePage.registered")))])]),e._v(" "),i("el-tab-pane",{attrs:{name:"notRegister"}},[i("span",{attrs:{slot:"label"},slot:"label"},[i("i",{staticClass:"iconfont Jamin_device_icon_wzcsb"}),e._v(" "+e._s(e.$t("devicePage.unregistered")))])])],1),e._v(" "),i("div",{staticClass:"table-view"},[e.isTable&&"register"===e.activeName?i("table-view",{ref:"table",attrs:{center:"","id-key":"deviceId","view-table-key":"register","is-search":!0,"check-memory":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"check-disabled-option":e.tableOptions.checkDisabledOption,checked:"","column-view":"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[i("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"})],1):e._e(),e._v(" "),e.isTable&&"notRegister"===e.activeName?i("not-table-view",{ref:"_not_table",attrs:{center:"","id-key":"deviceId","view-table-key":"notRegister","is-search":!0,"check-memory":!0,data:e.notTableOptions.data,total:e.notTableOptions.total,columns:e.notTableOptions.columns,"search-controls":e.notTableOptions.searchControls,"footer-buttons":e.notTableOptions.footerButtons,"button-controls":e.notTableOptions.buttonControls,"pagination-layout":e.notTableOptions.paginationLayout,loading:e.notTableOptions.loading,"check-disabled-option":e.notTableOptions.checkDisabledOption,checked:"","column-view":"",alias:e.alias},on:{requestTableData:e.getNotTableData,handleCallback:e.tableResponseFn}},[i("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"}),e._v(" "),i("el-table-column",{attrs:{slot:"location",label:e.$t("devicePage.lat_lng"),align:"center",width:"180"},slot:"location",scopedSlots:e._u([{key:"default",fn:function(t){return[null!==t.row.longitude&&null!==t.row.latitude?i("div",{staticClass:"lat_lng",on:{click:function(i){e.openMapFn(t.row)}}},[e._v(e._s(t.row.longitude)+", "+e._s(t.row.latitude))]):e._e()]}}])})],1):e._e()],1)]:e._e(),e._v(" "),e.isPermissionShow("deviceList")||e.$store.state.app.permsDataLoading?e._e():i("notPerm"),e._v(" "),i("DeviceEdit",{ref:"_device_edit"}),e._v(" "),i("AmapPosition",{ref:"_amap_position"}),e._v(" "),i("QuicklyAddVehicle",{ref:"_quickly_add_vehicle"})],2)},[],!1,null,"48e44d4a",null);h.options.__file="device.vue";t.default=h.exports},"La+X":function(e,t,i){e.exports=i.p+"static/img/15_ztc_xs.1ec259e.png"},QWdd:function(e,t,i){"use strict";i.r(t);var a=i("AkzS"),n=i.n(a),o=i("aprb"),s={data:function(){return{drawerObj:{isShow:!1},AMapGL:null,gapdeMap:null,carMarker:null,polyline:null,resData:[],locusData:[],infoWindow:null}},mounted:function(){},methods:{openFn:function(e){var t=this;this.drawerObj.isShow=!0,this.$nextTick(function(){t.gapdeMap?t.createCarMarkerFn(e):(t.createAMap(),t.createCarMarkerFn(e))})},createAMap:function(){var e=this;e.gapdeMap=new n.a.Map("_dev_position_amap",{resizeEnable:!0,center:[105.389814,38.311781],zoom:4}),n.a.plugin(["AMap.Scale","AMap.GraspRoad"],function(){e.gapdeMap.addControl(new n.a.Scale({liteStyle:!0,position:"RB"})),e.graspRoad=new n.a.GraspRoad})},createCarMarkerFn:function(e){this.gapdeMap.clearMap();var t=Object(o.b)(e.longitude,e.latitude);this.carMarker=new n.a.Marker({map:this.gapdeMap,position:t,icon:i("HNzo"),offset:new n.a.Pixel(-16,-16),autoRotation:!0}),this.setFitView()},setFitView:function(){this.gapdeMap.setFitView(),this.gapdeMap.zoomOut()}}},c=(i("90Lc"),i("ZrdR")),r=Object(c.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-drawer",{attrs:{title:"查看地图位置",visible:e.drawerObj.isShow,"wrapper-closable":!1,size:"600px",direction:"rtl"},on:{"update:visible":function(t){e.$set(e.drawerObj,"isShow",t)}}},[i("div",{staticClass:"amap-comtent",attrs:{id:"_dev_position_amap"}})])},[],!1,null,"29690234",null);r.options.__file="devicePositionAmap.vue";t.default=r.exports},YWMK:function(e,t,i){e.exports=i.p+"static/img/06_gc_xs.aa3ede2.png"},"aL2/":function(e,t,i){e.exports=i.p+"static/img/10_jbgc_xs.2448c10.png"},bqyo:function(e,t,i){e.exports=i.p+"static/img/08_gc_xs.c6fad11.png"},fZjX:function(e,t,i){e.exports=i.p+"static/img/11_wxpysc_xs.343b1b8.png"},iREr:function(e,t,i){e.exports=i.p+"static/img/13_tlj_xs.f78b43e.png"},"j+9R":function(e,t,i){e.exports=i.p+"static/img/04_hc_xs.b203d79.png"},j61K:function(e,t,i){"use strict";var a=i("wWqj");i.n(a).a},jcYt:function(e,t,i){e.exports=i.p+"static/img/not-perm.d97c442.png"},"l+Cu":function(e,t,i){e.exports=i.p+"static/img/03_xc_xs.0163428.png"},lpko:function(e,t,i){e.exports=i.p+"static/img/07_qyc_xs.68f60c4.png"},p0cv:function(e,t,i){e.exports=i.p+"static/img/12_nyc_xs.9d68257.png"},qOkx:function(e,t,i){e.exports=i.p+"static/img/05_jzxc_xs.dca079b.png"},u9vl:function(e,t,i){},wWqj:function(e,t,i){},yEz2:function(e,t,i){e.exports=i.p+"static/img/02_czc_xs.f40cc07.png"},yrqw:function(e,t,i){e.exports=i.p+"static/img/14_hwljc_xs.9be384a.png"}}]);
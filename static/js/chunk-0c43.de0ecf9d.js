(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0c43","NVOe"],{"1Drk":function(t,e,a){"use strict";a.r(e);var o=a("AlM9"),i=a("NVOe"),l={components:{TableView:o.a},mixins:[i.default],data:function(){return{fieldMap:{},alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:"序号"},{title:this.$t("logPage.operating_time"),key:"createTime",type:"text"},{title:this.$t("logPage.operation_user"),key:"username",type:"text"},{title:this.$t("logPage.application_terminal"),key:"loginType",type:"tag",tags:[{value:0,text:this.$t("logPage.application_terminal_1")},{value:1,text:this.$t("logPage.application_terminal_2")},{value:2,text:this.$t("logPage.application_terminal_3")},{value:3,text:this.$t("logPage.application_terminal_4")}]},{title:this.$t("logPage.functional_area"),key:"functionArea",type:"text"},{title:this.$t("logPage.operation_type"),key:"operationType",type:"tag",tags:[{value:0,text:this.$t("logPage.operation_type_1")},{value:1,text:this.$t("logPage.operation_type_2")},{value:2,text:this.$t("logPage.operation_type_3")},{value:3,text:this.$t("logPage.operation_type_4")},{value:4,text:this.$t("logPage.operation_type_5")}]},{title:this.$t("logPage.operation_record"),key:"operation",type:"text"},{title:this.$t("logPage.login_ip"),key:"loginIp",type:"text"},{title:this.$t("logPage.operation_result"),type:"tag",key:"status",tags:[{value:1,text:this.$t("logPage.operation_result_true")},{value:0,text:this.$t("logPage.operation_result_false"),option:{type:"dange"}}]}],buttonControls:[],searchControls:[{type:"datetimerange",key:"loginTime",startPlaceholder:this.$t("view.start_time"),endPlaceholder:this.$t("view.end_time"),width:"340px"},{type:"input",key:"username",placeholder:this.$t("logPage.operation_user"),width:"160px"},{type:"input",key:"functionArea",width:"160px",placeholder:this.$t("logPage.functional_area")},{type:"select",key:"loginType",placeholder:this.$t("logPage.application_terminal"),width:"160px",clearable:!0,options:[{name:this.$t("logPage.application_terminal_1"),value:0},{name:this.$t("logPage.application_terminal_2"),value:1},{name:this.$t("logPage.application_terminal_3"),value:2},{name:this.$t("logPage.application_terminal_4"),value:3}]},{type:"select",key:"status",width:"160px",placeholder:this.$t("logPage.operation_result"),clearable:!0,options:[{name:this.$t("logPage.operation_result_true"),value:1},{name:this.$t("logPage.operation_result_false"),value:0}]}],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1}}},computed:{},created:function(){},mounted:function(){},methods:{handlePermissionShow:function(){this.tableOptions.buttonControls=[],this.isPermissionShow("logOperateExport")&&this.tableOptions.buttonControls.push({text:this.$t("operation.export_record"),type:"null",size:"small",round:!1,funcName:"export"})},getTableData:function(t){var e=this;this.tableOptions.loading=!0;var a={startTime:t.loginTime[0],endTime:t.loginTime[1],loginType:t.loginType,functionArea:t.functionArea,status:t.status,username:t.username};this.$http.post("/log/list/operate?pageNum="+t.pageNum+"&pageSize="+t.pageSize,a).then(function(t){t.code===e.$config.API_STATUS.OK&&(e.tableOptions.data=t.data.list,e.tableOptions.total=t.data.total,e.tableOptions.loading=!1)})},tableResponseFn:function(t,e,a){this[e.funcName].call(function(){},t,e,a)},export:function(){var t=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),type:"primary",closeOnClickModal:!1,beforeClose:function(e,a,o){t.fieldMap={},t.tableOptions.columns.forEach(function(e){t.$refs.table.columnCheckList.forEach(function(a){e.key===a&&"operate"!==e.key&&(t.fieldMap[a]=e.title)})});var i=t.$refs.table._data.searchParams,l=i.loginTime,n=i.username,s=i.method,r=i.loginType,p=i.status;if("confirm"===e){var u={fieldMap:t.fieldMap,startTime:l[0],endTime:l[1],username:n,method:s,loginType:r,status:p};t.$http.download("/log/operate/export?isToken=true",u),o()}else o()}}).catch(function(){})}}},n=(a("L6Ho"),a("ZrdR")),s=Object(n.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"operationLog"},[a("table-view",{ref:"table",attrs:{center:"","id-key":"id","is-search":!0,data:t.tableOptions.data,total:t.tableOptions.total,columns:t.tableOptions.columns,"pagination-layout":t.tableOptions.paginationLayout,"search-controls":t.tableOptions.searchControls,"button-controls":t.tableOptions.buttonControls,loading:t.tableOptions.loading,checked:"","is-shadow":"","column-view":"",alias:t.alias},on:{requestTableData:t.getTableData,handleCallback:t.tableResponseFn}},[a("el-table-column",{attrs:{slot:"number",label:t.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"})],1)],1)},[],!1,null,"4e489c2e",null);s.options.__file="operationLog.vue";e.default=s.exports},EYRt:function(t,e,a){},L6Ho:function(t,e,a){"use strict";var o=a("EYRt");a.n(o).a},NVOe:function(t,e,a){"use strict";a.r(e);var o=a("bS4n"),i=a.n(o),l=a("8t5x");e.default={data:function(){return{permissionList:{userList:"/user/list",userCreate:"/user/create",userExport:"/user/export",userUpdate:"/user/update/**",userVehicle:"/user/vehicle/**",userReset:"/user/reset/**",userStatus:"/user/status",userDelete:"/user/delete",userListOnline:"/user/list/online",userOffline:"/user/offline/**/**",roleTreeList:"/role/treeList",roleCreate:"/role/create",roleUpdate:"/role/update",roleDelete:"/role/delete",roleAllocMenuAndPerm:"/role/allocMenuAndPerm",roleUpdateUserRole:"/role/updateUserRole",logListOperate:"/log/list/operate",logOperateExport:"/log/operate/export",logListLogin:"/log/list/login",logLoginExport:"/log/login/export",logListEquipment:"/log/list/equipment",logEquipmentExport:"/log/equipment/export"}}},computed:i()({},Object(l.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[t])}}}}}]);
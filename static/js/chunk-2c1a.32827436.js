(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2c1a","YelX","chunk-cb08","YelX","YelX"],{"22he":function(e,t,a){"use strict";a.r(t);var n=a("Xks0"),i=a("gPle"),r=a("YelX"),s={components:{purchase:n.default,renewal:i.default},mixins:[r.default],data:function(){return{activeName:"purchase"}},computed:{},created:function(){},mounted:function(){},methods:{handlePermissionShow:function(){var e=this.isPermissionShow("insuranceList"),t=this.isPermissionShow("insuranceListAdvance");e?this.activeName="purchase":t&&(this.activeName="renewal")}}},o=(a("R5fy"),a("ZrdR")),l=Object(o.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("div",{staticClass:"main"},[a("el-tabs",{staticClass:"init-tabs",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[e.isPermissionShow("insuranceList")?a("el-tab-pane",{attrs:{name:"purchase"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_vehicle_icon_ksnj"}),e._v(e._s(e.$t("InsurancePage.right_title_2_1"))+" ")]),e._v(" "),"purchase"===e.activeName?a("purchase"):e._e()],1):e._e(),e._v(" "),e.isPermissionShow("insuranceListAdvance")?a("el-tab-pane",{attrs:{name:"renewal"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_vehicle_icon_ksnj"}),e._v(e._s(e.$t("InsurancePage.right_title_2_2"))+" ")]),e._v(" "),"renewal"===e.activeName?a("renewal"):e._e()],1):e._e()],1)],1)])},[],!1,null,"54e2d331",null);l.options.__file="index.vue";t.default=l.exports},"7tXO":function(e,t,a){},"9uUM":function(e,t,a){},Kafa:function(e,t,a){"use strict";var n=a("7tXO");a.n(n).a},R5fy:function(e,t,a){"use strict";var n=a("9uUM");a.n(n).a},YelX:function(e,t,a){"use strict";a.r(t);var n=a("bS4n"),i=a.n(n),r=a("8t5x");t.default={data:function(){return{permissionList:{vehicleUpdate:"/vehicle/update/**",vehicleExport:"/vehicle/export",vehicleDelete:"/vehicle/delete",vehicleList:"/vehicle/list",vehicleCreate:"/vehicle/create",vehicleFastCreate:"/vehicle/fastCreate",vehicleMotorcadeCreate:"/vehicle/motorcade/create",vehicleMotorcadeUpdate:"/vehicle/motorcade/update",vehicleMotorcadeDelete:"/vehicle/motorcade/delete/**",companyList:"/company/list",companyCreate:"/company/create",companyExport:"/company/export",companyDetail:"/company/**",companyUpdate:"/company/update/**",companyPersonalization:"/company/personalization/**",companyDelete:"/company/delete",driverList:"/driver/list",driverCreate:"/driver/create",driverDetail:"/driver/get/**",driverUpdate:"/driver/update/**",driverDelete:"/driver/delete",driverExport:"/driver/export",labelList:"/label/list",labelCreate:"/label/create",labelUpdate:"/label/update/**",labelDelete:"/label/delete",labelExport:"/label/export",regionList:"/region/list",regionCreate:"/region/create",regionUpdate:"/region/update/**",regionDelete:"/region/delete",regionExport:"/region/export",routeList:"/route/list",routeCreate:"/route/create",routeUpdate:"/route/update/**",routeDelete:"/route/delete",routeExport:"/route/export",adminList:"/admin/list",adminCreate:"/admin/create",adminUpdate:"/admin/update/**",adminDelete:"/admin/delete",adminExport:"/admin/export",typeCreate:"/ef/type/create",typeUpdate:"/ef/type/update/**",typeDelete:"/ef/type/delete/**",drivingLicenseList:"/driving/license/list",drivingLicenseCreate:"/driving/license/create",drivingLicenseUpdate:"/driving/license/update/**",drivingLicenseDelete:"/driving/license/delete",drivingLicense:"/driving/license/export",transportList:"/transport/list",transportCreate:"/transport/create",transportUpdate:"/transport/update/**",transportDelete:"/transport/delete",transportExport:"/transport/export",maintainList:"/maintain/list",maintainCreate:"/maintain/create",maintainUpdate:"/maintain/update/**",maintainDelete:"/maintain/delete",maintainExport:"/maintain/export",insuranceList:"/insurance/list",insuranceCreate:"/insurance/create",insuranceUpdate:"/insurance/update/**",insuranceDelete:"/insurance/delete",insuranceExport:"/insurance/export",insuranceListAdvance:"/insurance/list/advance",annualList:"/annual/list",annualCreate:"/annual/create",annualUpdate:"/annual/update/**",annualDelete:"/annual/delete",annualExport:"/annual/export",annualListAdvance:"/annual/list/advance",repairList:"/repair/list",repairCreate:"/repair/create",repairUpdate:"/repair/update/**",repairDelete:"/repair/delete",repairExport:"/repair/export",accidentList:"/accident/list",accidentCreate:"/accident/create",accidentUpdate:"/accident/update/**",accidentDelete:"/accident/delete",accidentExport:"/accident/export",simList:"/sim/list",simCreate:"/sim/create",simUpdate:"/sim/update/**",simDelete:"/sim/delete",simExport:"/sim/export"}}},computed:i()({},Object(r.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[e])}}}},gPle:function(e,t,a){"use strict";a.r(t);var n=a("BHIJ"),i=a("AlM9"),r=a("YelX"),s={components:{TableView:i.a,drawer:n.a},mixins:[r.default],data:function(){return{drawerDisplay:!1,drawerData:{},alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:"序号"},{title:this.$t("InsurancePage.licenseNum"),key:"licenseNum",minWidth:"180",type:"text"},{title:this.$t("InsurancePage.companyName"),key:"companyName",type:"text",minWidth:"180"},{title:this.$t("InsurancePage.insurCompany"),key:"insurCompany",minWidth:"180",type:"text"},{title:this.$t("InsurancePage.insurType"),key:"type",type:"text",minWidth:"180"},{title:this.$t("InsurancePage.effectAt_1"),key:"effectAt",minWidth:"180",type:"text"},{title:this.$t("InsurancePage.timeoutAt_1"),key:"timeoutAt",minWidth:"180",type:"text"},{title:this.$t("InsurancePage.overDayNum"),key:"overDayNum",minWidth:"130",type:"slot",name:"overDayNum"},{title:this.$t("operation.operation"),type:"operate",key:"operate",fixed:"right",width:"160",buttons:[]}],buttonControls:[],searchControls:[{type:"input",key:"licenseNum",placeholder:this.$t("view.license_num"),width:"200px"},{type:"treeSelect",key:"companyIds",valueKey:"companyId",placeholder:this.$t("view.searchControl_company"),width:"200px",clearable:!0,treeOption:{defaultProps:{children:"sysCompanyNodes",label:"name"},nodeKey:"companyId",defaultExpandAll:!1,expandClickNode:!1,checkbox:!0,screenFn:{bindFn:function(e,t){return!e||-1!==t.name.indexOf(e)}}},treeDefinedData:this.$parent.$parent.$parent.$parent.companyTreeData},{type:"input",key:"type",placeholder:this.$t("InsurancePage.searchControls_insurType"),width:"200px"}],footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1}}},computed:{},created:function(){},mounted:function(){},methods:{handlePermissionShow:function(){this.isPermissionShow("insuranceExport")&&this.tableOptions.buttonControls.push({text:this.$t("InsurancePage.buttonControls_export"),type:"null",round:!1,icon:"el-icon-download",funcName:"export"}),this.isPermissionShow("insuranceDelete")&&this.tableOptions.footerButtons.push({text:this.$t("operateCommon.delete"),type:"danger",icon:"el-icon-delete",round:!1,funcName:"delete"});var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});e>-1&&this.isPermissionShow("insuranceUpdate")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("operation.edit"),icon:"iconfont Jamin_vehicle_icon_bj",type:"text",funcName:"edit"})},endTime:function(e){this.$refs.drawer.formData.effectAt?new Date(e).getTime()<=new Date(this.$refs.drawer.formData.effectAt).getTime()&&(this.$message.error(this.$t("InsurancePage.form_rule_3")),this.$refs.drawer.formData.timeoutAt=null):(this.$message.error(this.$t("InsurancePage.form_rule_2")),this.$refs.drawer.formData.timeoutAt=null)},getTableData:function(e){var t=this;this.tableOptions.loading=!0;var a={licenseNum:e.licenseNum,companyIds:e.companyIds?JSON.parse(e.companyIds):[],type:e.type};this.$http.post("/insurance/list/advance?pageNum="+e.pageNum+"&pageSize="+e.pageSize,a).then(function(e){t.tableOptions.loading=!1,e.code===t.$config.API_STATUS.OK&&(t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total)})},tableResponseFn:function(e,t,a){this[t.funcName].call(function(){},e,t,a)},edit:function(e){var t=this;this.$http.get("/insurance/"+e.insurId).then(function(a){if(a.code===t.$config.API_STATUS.OK){e=a.data;var n=function(e,a,n){t.$refs.drawer.formData.effectAt&&t.$refs.drawer.formData.timeoutAt?new Date(t.$refs.drawer.formData.effectAt).getTime()>new Date(t.$refs.drawer.formData.timeoutAt).getTime()?n(new Error(t.$t("confirm.confirm_time_1"))):n():n()};t.drawerDisplay=!0,t.drawerData={staticData:e,isShow:!0,title:t.$t("InsurancePage.form_edit_insur_title"),titleWidth:"120",data:{},defaultData:"",submitAction:"/insurance/update/"+e.insurId,btnAlign:"center",formList:[{title:t.$t("InsurancePage.form_edit_insur_vehicleId"),type:"treeSelect",key:"vehicleId",valueKey:"vehicleId",offsetWidth:"320",label:e.licenseNum,treeOption:{defaultProps:{children:"children",label:"treeName"},nodeKey:"treeId",nodeCode:"iconfont Jamin_vehicle_icon_clgl1",defaultExpandAll:!1,expandClickNode:!1,screenFn:{bindFn:function(e,t){return!e||-1!==t.treeName.indexOf(e)}}},treeDefinedData:t.$parent.$parent.$parent.$parent.carTreeData,rules:[{required:!0,message:t.$t("InsurancePage.form_vehicleId_placeholder"),trigger:"blur"}]},{title:t.$t("InsurancePage.form_edit_insur_insurCompany"),type:"input",key:"insurCompany",offsetWidth:"320",rules:[{required:!0,message:t.$t("InsurancePage.form_edit_insur_insurCompany_placeholder"),trigger:"blur"}]},{title:t.$t("InsurancePage.form_edit_insur_type"),type:"input",key:"type",offsetWidth:"320",rules:[{required:!0,message:t.$t("InsurancePage.form_edit_insur_type_placeholder"),trigger:"blur"}]},{title:t.$t("InsurancePage.form_edit_insur_insurNum"),type:"input",key:"insurNum",offsetWidth:"320",rules:[{required:!0,message:t.$t("InsurancePage.form_edit_insur_insurNum_placeholder"),trigger:"blur"}]},{title:t.$t("InsurancePage.form_edit_insur_price"),type:"input",key:"price",offsetWidth:"320",rules:[{required:!0,message:t.$t("InsurancePage.form_edit_insur_price_placeholder"),trigger:"blur"}]},{title:t.$t("InsurancePage.form_edit_insur_effectAt"),type:"dateSelect",offsetWidth:"320",valueFormat:"yyyy-MM-dd",key:"effectAt",rules:[{required:!0,message:t.$t("InsurancePage.form_edit_insur_effectAt_placeholder"),trigger:"change"},{validator:n,trigger:"change"}]},{title:t.$t("InsurancePage.form_edit_insur_timeoutAt"),type:"dateSelect",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"timeoutAt",handlerCallback:{target:"changeFunction",funcName:"endTime"},rules:[{required:!0,message:t.$t("InsurancePage.form_edit_insur_timeoutAt_placeholder"),trigger:"change"},{validator:n,trigger:"change"}]},{title:t.$t("InsurancePage.form_edit_insur_advanceNum"),type:"input",key:"advanceNum",offsetWidth:"320",rules:[{required:!0,message:t.$t("InsurancePage.form_edit_insur_advanceNum_placeholder"),trigger:"blur"}]},{title:t.$t("InsurancePage.form_payer"),type:"input",offsetWidth:"320",key:"payer"},{title:t.$t("InsurancePage.form_handler"),type:"input",offsetWidth:"320",key:"handler"},{title:t.$t("InsurancePage.form_phone"),type:"input",offsetWidth:"320",key:"phone"},{title:t.$t("InsurancePage.form_description"),type:"input",offsetWidth:"320",key:"remark"},{title:t.$t("InsurancePage.form_attachedPhoto"),type:"imgUpload",offsetWidth:"320",action:t.$config.API_CONFIG.API_ROOT+"/file/upload/attachedPhoto",key:"attachedPhoto",accept:"image/jpeg,image/png",headers:{Authorization:t.$store.getters.userData.tokenHead+t.$store.getters.userData.token},showFileList:!1,beforeUpload:function(e){},onProgress:function(e){},onSuccess:function(e){e.code===t.$config.API_STATUS.OK&&t.$set(t.$refs.drawer.formData,"attachedPhoto",e.data.url)}}],formButton:[{name:t.$t("confirm.determine"),type:"confirm",class:"primary"},{name:t.$t("confirm.cancel"),type:"cancel",class:""}],message:{type:"success",message:t.$t("confirm.editSuccess")}}}})},export:function(){var e=this;this.$confirm(this.$t("confirm.export"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),type:"warning",closeOnClickModal:!1,beforeClose:function(t,a,n){e.fieldMap={},e.tableOptions.columns.forEach(function(t){e.$refs.table.columnCheckList.forEach(function(a){t.key===a&&"operate"!==t.key&&(e.fieldMap[a]=t.title)})});var i=e.$refs.table._data.searchParams,r=i.licenseNum,s=i.companyIds,o=i.type;if("confirm"===t){var l={fieldMap:e.fieldMap,licenseNum:r,companyIds:s?JSON.parse(s):[],type:o};e.$http.download("/insurance/export?isToken=true",l),n()}else n()}}).catch(function(){})},delete:function(e){var t=this;this.$confirm(this.$t("confirm.del"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),type:"warning"}).then(function(){var a=[];e.forEach(function(e,t){a[t]=e.insurId}),t.$http.deleteApi("/insurance/delete",{ids:a.join(",")}).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$refs.table.initRequestTableData(),t.$message({message:e.message,type:"success"}))})})},diaClose:function(e){e&&this.$refs.table.initRequestTableData(),this.drawerDisplay=!1},drawerCallback:function(e,t,a,n){this[e.handlerCallback.funcName].call(function(){},t,a,n)}}},o=(a("Kafa"),a("ZrdR")),l=Object(o.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("table-view",{ref:"table",attrs:{center:"","id-key":"insurId","is-search":!0,"check-memory":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"view-table-key":"renewal",checked:"","column-view":"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[a("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center"},slot:"number"}),e._v(" "),a("el-table-column",{attrs:{slot:"overDayNum",label:e.$t("InsurancePage.overDayNum"),align:"center",width:"130"},slot:"overDayNum",scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.overDayNum>=0?a("span",[e._v("\n          "+e._s(e.$t("common.remaining"))+" "+e._s(t.row.overDayNum)+" "+e._s(e.$t("common.day"))+"\n        ")]):e._e(),e._v(" "),t.row.overDayNum<0?a("span",[e._v("\n          "+e._s(e.$t("common.overdue"))+" "+e._s(Math.abs(t.row.overDayNum))+" "+e._s(e.$t("common.day"))+"\n        ")]):e._e()]}}])})],1),e._v(" "),e.drawerDisplay?a("drawer",{ref:"drawer",attrs:{size:"small","drawer-data":e.drawerData},on:{diaClose:e.diaClose,handlerCallback:e.drawerCallback}}):e._e()],1)},[],!1,null,"831e07ae",null);l.options.__file="renewal.vue";t.default=l.exports}}]);
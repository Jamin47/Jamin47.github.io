(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-fe07"],{"5H96":function(e,t,a){},"6EgD":function(e,t,a){"use strict";a.r(t);var i=a("unDg"),n=a.n(i),s=a("AlM9"),o=a("BHIJ"),r=a("Cy+k"),l={name:"InIssueHistoryComponents",components:{TableView:s.a,drawer:o.a},mixins:[r.default],data:function(){return{isTable:!0,drawerDisplay:!1,drawerData:{},alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:this.$t("upgradePage.index")},{title:this.$t("view.license_num"),key:"licenseNum",type:"text"},{title:this.$t("upgradePage.motorcade_name"),key:"motorcadeName",type:"text"},{title:this.$t("upgradePage.issued_status"),key:"issuedStatus",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.issued_status_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.issued_status_2"),option:{type:"success"}},{value:2,text:this.$t("upgradePage.issued_status_3"),option:{type:"primary"}}]},{title:this.$t("upgradePage.original_version"),key:"originalVersion",type:"text"},{title:this.$t("upgradePage.version_num"),key:"versionNum",type:"text"},{title:this.$t("upgradePage.package_type"),key:"packageType",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.package_type_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.package_type_2"),option:{type:"primary"}}]},{title:this.$t("upgradePage.execution_status"),key:"upgradeStatus",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.execution_status_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.execution_status_2"),option:{type:"success"}},{value:2,text:this.$t("upgradePage.execution_status_3"),option:{type:"primary"}},{value:3,text:this.$t("upgradePage.execution_status_4"),option:{type:"danger"}}]},{title:this.$t("view.start_time"),key:"startTime",type:"text"},{title:this.$t("view.end_time"),key:"endTime",type:"text"},{title:this.$t("upgradePage.username"),key:"username",type:"text"},{title:this.$t("upgradePage.create_time"),key:"createTime",type:"text"},{title:this.$t("operation.operation"),type:"operate",key:"operate",fixed:"right",buttons:[]}],buttonControls:[],searchControls:[{type:"treeSelect",key:"licenseNum",valueKey:"licenseNum",placeholder:this.$t("upgradePage.tree_placeholder"),width:"200px",clearable:!0,treeOption:{defaultProps:{children:"children",label:"treeName"},nodeKey:"treeId",defaultExpandAll:!1,expandClickNode:!1,checkbox:!0,screenFn:{bindFn:function(e,t){return!e||-1!==t.treeName.indexOf(e)}}},treeDefinedData:[]},{type:"input",key:"versionNum",placeholder:this.$t("upgradePage.version_num"),width:"160px"},{type:"select",key:"packageType",placeholder:this.$t("upgradePage.package_type"),width:"160px",clearable:!0,options:[{name:this.$t("upgradePage.package_type_1"),value:0},{name:this.$t("upgradePage.package_type_2"),value:1}]},{type:"select",key:"upgradeStatus",placeholder:this.$t("upgradePage.execution_status"),width:"160px",clearable:!0,options:[{name:this.$t("upgradePage.execution_status_1"),value:0},{name:this.$t("upgradePage.execution_status_2"),value:1},{name:this.$t("upgradePage.execution_status_3"),value:2},{name:this.$t("upgradePage.execution_status_4"),value:3}]},{type:"datetimerange",key:"time",startPlaceholder:this.$t("view.start_time"),endPlaceholder:this.$t("view.end_time"),width:"360px"}],footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1}}},computed:{},created:function(){this.getDevAllTreeDataFn()},mounted:function(){},methods:{handlePermissionShow:function(){var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});this.tableOptions.columns[e].buttons=[],e>-1&&this.isPermissionShow("resetUpgradePush")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("upgradePage.again"),icon:"iconfont Jamin_device_icon_cxts",type:"text",funcName:"againFn"})},getTableData:function(e){var t=this;e.startTime=e.time&&e.time[0]?e.time[0]:"",e.endTime=e.time&&e.time[1]?e.time[1]:"",delete e.time,this.tableOptions.loading=!0,this.$http.post("/upgrade/list/record",e).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.tableOptions.loading=!1,t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total)})},tableResponseFn:function(e,t,a){this[t.funcName].call(function(){},e,t,a)},getDevAllTreeDataFn:function(){var e=this;this.$http.get("/postion/otaUpgrade/vehicleAllTreeList").then(function(t){t.code===e.$config.API_STATUS.OK&&(e.forTreeResetDataFn(t.data.motorcades),e.tableOptions.searchControls[0].treeDefinedData=t.data.motorcades,e.isTable=!1,e.$nextTick(function(){e.isTable=!0}))})},forTreeResetDataFn:function(e){var t=this;e.forEach(function(e){e.vehicleId?(e.treeName=e.licenseNum,e.treeId="v_"+e.vehicleId,e.lezy=!0):(e.treeName=e.motorcadeName,e.treeId="m_"+e.motorcadeId,e.children=[].concat(n()(e.vehicles),n()(e.motorcades)),t.forTreeResetDataFn(e.children))})},againFn:function(e){var t=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel")}).then(function(){t.$http.deleteApi("/upgrade/push/"+e.recordId).then(function(e){e.code===t.$config.API_STATUS.OK&&t.$message.success(t.$t("confirm.message"))})})},diaClose:function(){this.$refs.table.emitRequestTableData(),this.drawerDisplay=!1},drawerCallback:function(e,t,a,i){this[e.handlerCallback.funcName].call(function(){},t,a,i)}}},u=(a("NH45"),a("ZrdR")),p=Object(u.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inIssue-history-components"},[e.isTable?a("table-view",{ref:"table",attrs:{center:"","id-key":"id","is-search":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"is-shadow":"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[a("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"})],1):e._e(),e._v(" "),e.drawerDisplay?a("drawer",{ref:"drawer",attrs:{"drawer-data":e.drawerData},on:{diaClose:e.diaClose,handlerCallback:e.drawerCallback}}):e._e()],1)},[],!1,null,"0d017d48",null);p.options.__file="upgradeRecord.vue";t.default=p.exports},"8+Rj":function(e,t,a){"use strict";var i=a("5H96");a.n(i).a},NH45:function(e,t,a){"use strict";var i=a("NgYC");a.n(i).a},NgYC:function(e,t,a){},P4nX:function(e,t,a){"use strict";var i=a("kR3n");a.n(i).a},PxZR:function(e,t,a){"use strict";a.r(t);var i=a("unDg"),n=a.n(i),s=a("AlM9"),o=a("BHIJ"),r=a("Cy+k"),l={name:"InIssueHistoryComponents",components:{TableView:s.a,drawer:o.a},mixins:[r.default],data:function(){return{drawerDisplay:!1,drawerData:{},alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:this.$t("upgradePage.index")},{title:this.$t("upgradePage.version_num"),key:"versionNum",type:"text"},{title:this.$t("upgradePage.package_type"),key:"packageType",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.package_type_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.package_type_2"),option:{type:"primary"}}]},{title:this.$t("upgradePage.success_num"),key:"successNum",type:"text"},{title:this.$t("upgradePage.failed_num"),key:"failedNum",type:"text"},{title:this.$t("upgradePage.not_num"),key:"notNum",type:"text"},{title:this.$t("upgradePage.execution_status"),key:"status",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.execution_status_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.execution_status_2"),option:{type:"success"}},{value:2,text:this.$t("upgradePage.execution_status_3"),option:{type:"primary"}},{value:3,text:this.$t("upgradePage.execution_status_4"),option:{type:"danger"}}]},{title:this.$t("upgradePage.upgrade_time"),key:"upgradeTime",type:"text"},{title:this.$t("upgradePage.username"),key:"username",type:"text"},{title:this.$t("operation.operation"),type:"operate",key:"operate",fixed:"right",buttons:[]}],buttonControls:[],searchControls:[{type:"input",key:"versionNum",placeholder:this.$t("upgradePage.version_num"),width:"160px"},{type:"select",key:"packageType",placeholder:this.$t("upgradePage.package_type"),width:"160px",clearable:!0,options:[{name:this.$t("upgradePage.package_type_1"),value:0},{name:this.$t("upgradePage.package_type_2"),value:1}]},{type:"select",key:"status",placeholder:this.$t("upgradePage.execution_status"),width:"160px",clearable:!0,options:[{name:this.$t("upgradePage.execution_status_1"),value:0},{name:this.$t("upgradePage.execution_status_2"),value:1},{name:this.$t("upgradePage.execution_status_3"),value:2},{name:this.$t("upgradePage.execution_status_4"),value:3}]},{type:"datetimerange",key:"time",startPlaceholder:this.$t("view.start_time"),endPlaceholder:this.$t("view.end_time"),width:"360px"}],footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1},infoDrawer:!1,activeData:null,infoTableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:"序号"},{title:this.$t("view.license_num"),key:"licenseNum",type:"text"},{title:this.$t("upgradePage.issued_status"),key:"issuedStatus",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.issued_status_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.issued_status_2"),option:{type:"success"}},{value:2,text:this.$t("upgradePage.issued_status_3"),option:{type:"primary"}}]},{title:this.$t("upgradePage.original_version"),key:"originalVersion",type:"text"},{title:this.$t("upgradePage.version_num"),key:"versionNum",type:"text"},{title:this.$t("upgradePage.execution_status"),key:"upgradeStatus",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.execution_status_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.execution_status_2"),option:{type:"success"}},{value:2,text:this.$t("upgradePage.execution_status_3"),option:{type:"primary"}},{value:3,text:this.$t("upgradePage.execution_status_4"),option:{type:"danger"}}]},{title:this.$t("view.start_time"),key:"startTime",type:"text",width:"160"},{title:this.$t("view.end_time"),key:"endTime",type:"text",width:"160"},{title:this.$t("upgradePage.create_time"),key:"createTime",type:"text"},{title:this.$t("operation.operation"),type:"operate",key:"operate",fixed:"right",width:"120",buttons:[]}],buttonControls:[],searchControls:[{type:"treeSelect",key:"licenseNum",valueKey:"licenseNum",placeholder:this.$t("upgradePage.tree_placeholder"),width:"200px",clearable:!0,treeOption:{defaultProps:{children:"children",label:"treeName"},nodeKey:"treeId",defaultExpandAll:!1,expandClickNode:!1,checkbox:!0,screenFn:{bindFn:function(e,t){return!e||-1!==t.treeName.indexOf(e)}}},treeDefinedData:[]},{type:"input",key:"versionNum",placeholder:this.$t("upgradePage.version_num"),width:"160px"},{type:"select",key:"upgradeStatus",placeholder:this.$t("upgradePage.execution_status"),width:"160px",clearable:!0,options:[{name:this.$t("upgradePage.execution_status_1"),value:0},{name:this.$t("upgradePage.execution_status_2"),value:1},{name:this.$t("upgradePage.execution_status_3"),value:2},{name:this.$t("upgradePage.execution_status_4"),value:3}]}],footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1}}},computed:{},created:function(){this.getDevAllTreeDataFn()},mounted:function(){},methods:{handlePermissionShow:function(){var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});this.tableOptions.columns[e].buttons=[],e>-1&&this.isPermissionShow("upgradeListRecord")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("operation.detail"),icon:"iconfont Jamin_vehicle_ico_xq",type:"text",funcName:"detailFn"});var t=this.infoTableOptions.columns.findIndex(function(e){return"operate"===e.key});t>-1&&this.isPermissionShow("resetUpgradePush")&&this.infoTableOptions.columns[t].buttons.push({tipText:this.$t("upgradePage.again"),icon:"iconfont Jamin_device_icon_cxts",type:"text",funcName:"againFn"}),this.tableOptions.footerButtons=[],this.isPermissionShow("upgradeTaskPush")&&this.tableOptions.footerButtons.push({text:this.$t("upgradePage.execute"),type:"",round:!1,funcName:"executeFn"}),this.isPermissionShow("upgradeTaskFailPush")&&this.tableOptions.footerButtons.push({text:this.$t("upgradePage.fail_again"),type:"danger",round:!1,funcName:"againsFn"})},getTableData:function(e){var t=this;e.startTime=e.time&&e.time[0]?e.time[0]:"",e.endTime=e.time&&e.time[1]?e.time[1]:"",delete e.time,this.tableOptions.loading=!0,this.$http.post("/upgrade/list/task",e).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.tableOptions.loading=!1,t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total)})},getInfoTableData:function(e){var t=this;this.infoTableOptions.loading=!0,e.taskId=this.activeData.taskId,this.$http.post("/upgrade/list/record",e).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.infoTableOptions.loading=!1,t.infoTableOptions.data=e.data.list,t.infoTableOptions.total=e.data.total)})},tableResponseFn:function(e,t,a){this[t.funcName].call(function(){},e,t,a)},getDevAllTreeDataFn:function(){var e=this;this.$http.get("/postion/otaUpgrade/vehicleAllTreeList").then(function(t){t.code===e.$config.API_STATUS.OK&&(e.forTreeResetDataFn(t.data.motorcades),e.infoTableOptions.searchControls[0].treeDefinedData=t.data.motorcades,e.isTable=!1,e.$nextTick(function(){e.isTable=!0}))})},forTreeResetDataFn:function(e){var t=this;e.forEach(function(e){e.vehicleId?(e.treeName=e.licenseNum,e.treeId="v_"+e.vehicleId,e.lezy=!0):(e.treeName=e.motorcadeName,e.treeId="m_"+e.motorcadeId,e.children=[].concat(n()(e.vehicles),n()(e.motorcades)),t.forTreeResetDataFn(e.children))})},detailFn:function(e){this.activeData=e,this.infoDrawer=!0},executeFn:function(e){var t=this,a=e.filter(function(e){return 0===e.status});a.length?this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel")}).then(function(){t.$http.deleteApi("/upgrade/task/push",{taskIds:a.map(function(e){return e.taskId}).join(",")}).then(function(e){e.code===t.$config.API_STATUS.OK&&t.$message.success(t.$t("confirm.message"))})}):this.$message.warning(this.$t("upgradePage.error_message_1"))},againFn:function(e){var t=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel")}).then(function(){t.$http.deleteApi("/upgrade/push/"+e.recordId).then(function(e){e.code===t.$config.API_STATUS.OK&&t.$message.success(t.$t("confirm.message"))})})},againsFn:function(e){var t=this,a=e.filter(function(e){return 3===e.status});a.length?this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel")}).then(function(){t.$http.deleteApi("/upgrade/task/fail/push",{taskIds:a.map(function(e){return e.taskId}).join(",")}).then(function(e){e.code===t.$config.API_STATUS.OK&&t.$message.success(t.$t("confirm.message"))})}):this.$message.warning(this.$t("upgradePage.error_message_2"))},diaClose:function(e){e&&this.$refs.table.initRequestTableData(),this.drawerDisplay=!1},drawerCallback:function(e,t,a,i){this[e.handlerCallback.funcName].call(function(){},t,a,i)}}},u=(a("P4nX"),a("ZrdR")),p=Object(u.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inIssue-history-components"},[a("table-view",{ref:"table",attrs:{center:"","id-key":"taskId","is-search":!0,"check-memory":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"is-shadow":"",checked:"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[a("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"})],1),e._v(" "),e.drawerDisplay?a("drawer",{ref:"drawer",attrs:{"drawer-data":e.drawerData},on:{diaClose:e.diaClose,handlerCallback:e.drawerCallback}}):e._e(),e._v(" "),a("el-drawer",{attrs:{title:e.$t("operation.detail"),visible:e.infoDrawer,"wrapper-closable":!1,size:"80%",direction:"rtl"},on:{"update:visible":function(t){e.infoDrawer=t}}},[e.infoDrawer?a("div",{staticClass:"drawer-body"},[a("table-view",{ref:"info_table",attrs:{center:"","id-key":"taskId","is-search":!0,data:e.infoTableOptions.data,total:e.infoTableOptions.total,columns:e.infoTableOptions.columns,"search-controls":e.infoTableOptions.searchControls,"footer-buttons":e.infoTableOptions.footerButtons,"button-controls":e.infoTableOptions.buttonControls,"pagination-layout":e.infoTableOptions.paginationLayout,loading:e.infoTableOptions.loading,"is-border":"",alias:e.alias},on:{requestTableData:e.getInfoTableData,handleCallback:e.tableResponseFn}},[a("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"})],1)],1):e._e()])],1)},[],!1,null,"4e6282d0",null);p.options.__file="upgradeTask.vue";t.default=p.exports},jZgY:function(e,t,a){"use strict";a.r(t);var i=a("O6va"),n=a("PxZR"),s=a("6EgD"),o=a("XVnh"),r=a("Cy+k"),l={components:{upgradeManage:i.default,upgradeTask:n.default,upgradeRecord:s.default,notPerm:o.a},mixins:[r.default],data:function(){return{activeName:"",isPermission:!1}},mounted:function(){},methods:{handlePermissionShow:function(){this.isPermissionShow("upgradeList")?(this.isPermission=!0,this.activeName="upgradeManage"):this.isPermissionShow("upgradeListTask")?(this.isPermission=!0,this.activeName="upgradeTask"):this.isPermissionShow("upgradeListRecord")?(this.isPermission=!0,this.activeName="upgradeRecord"):this.isPermission=!1}}},u=(a("8+Rj"),a("ZrdR")),p=Object(u.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-wrap"},[e.isPermission?a("el-tabs",{staticClass:"init-tabs",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[e.isPermissionShow("upgradeList")?a("el-tab-pane",{attrs:{name:"upgradeManage"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_device_icon_zlxf1"}),e._v(" "+e._s(e.$t("upgradePage.view_type_1")))]),e._v(" "),"upgradeManage"===e.activeName?a("upgradeManage"):e._e()],1):e._e(),e._v(" "),e.isPermissionShow("upgradeListTask")?a("el-tab-pane",{attrs:{name:"upgradeTask"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_device_icon_lxdf"}),e._v(" "+e._s(e.$t("upgradePage.view_type_2")))]),e._v(" "),"upgradeTask"===e.activeName?a("upgradeTask"):e._e()],1):e._e(),e._v(" "),e.isPermissionShow("upgradeListRecord")?a("el-tab-pane",{attrs:{name:"upgradeRecord"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_device_icon_fsls"}),e._v(" "+e._s(e.$t("upgradePage.view_type_3")))]),e._v(" "),"upgradeRecord"===e.activeName?a("upgradeRecord"):e._e()],1):e._e()],1):e._e(),e._v(" "),e.isPermission||e.$store.state.app.permsDataLoading?e._e():a("notPerm")],1)},[],!1,null,"5f7348b8",null);p.options.__file="ota-upgrade.vue";t.default=p.exports},jcYt:function(e,t,a){e.exports=a.p+"static/img/not-perm.d97c442.png"},kR3n:function(e,t,a){}}]);
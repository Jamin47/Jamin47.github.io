(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a146"],{"1ion":function(e,t,a){},CBRM:function(e,t,a){"use strict";var s=a("1ion");a.n(s).a},DDwP:function(e,t,a){"use strict";var s=a("F2zJ");a.n(s).a},F2zJ:function(e,t,a){},jcYt:function(e,t,a){e.exports=a.p+"static/img/not-perm.d97c442.png"},pxNs:function(e,t,a){"use strict";a.r(t);var s=a("LehH"),n=a("r97K"),i=a("XVnh"),o=a("NVOe"),r={name:"UserManagement",components:{userAccount:s.default,onlineUsers:n.default,notPerm:i.a},mixins:[o.default],data:function(){return{activeName:"",isPermission:!1}},created:function(){},mounted:function(){},methods:{handlePermissionShow:function(){this.isPermissionShow("userList")?(this.activeName="userAccount",this.isPermission=!0):this.isPermissionShow("userListOnline")?(this.activeName="onlineUsers",this.isPermission=!0):this.isPermission=!1}}},l=(a("DDwP"),a("ZrdR")),u=Object(l.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-wrap"},[e.isPermission?a("div",{staticClass:"main"},[a("el-tabs",{staticClass:"init-tabs",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"userAccount"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_system_icon_juese"}),e._v(" "+e._s(e.$t("userPage.view_type_1")))]),e._v(" "),"userAccount"===e.activeName?a("userAccount"):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{name:"onlineUsers"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_system_icon_zaixian"}),e._v(" "+e._s(e.$t("userPage.view_type_2")))]),e._v(" "),"onlineUsers"===e.activeName?a("onlineUsers"):e._e()],1)],1)],1):e._e(),e._v(" "),e.isPermission||e.$store.state.app.permsDataLoading?e._e():a("notPerm")],1)},[],!1,null,"55b867ad",null);u.options.__file="userManagement.vue";t.default=u.exports},r97K:function(e,t,a){"use strict";a.r(t);var s=a("AlM9"),n=a("NVOe"),i={components:{TableView:s.a},mixins:[n.default],data:function(){return{companyTreeData:[],num:{androidCount:0,iosCount:0,total:0,weChatCount:0,webCount:0},alias:{pageSize:"pageSize",pageNum:"pageNum"},isSearch:!1,isTable:!0,tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:"序号"},{title:this.$t("userPage.login_account"),key:"username",type:"text"},{title:this.$t("userPage.name"),key:"account",type:"text"},{title:this.$t("userPage.user_role"),key:"roleName",type:"text"},{title:this.$t("userPage.owned_customer"),key:"companyName",type:"text"},{title:this.$t("userPage.application_terminal"),key:"appTerminal",type:"tag",tags:[{value:0,text:this.$t("userPage.search_4_status_1")},{value:1,text:this.$t("userPage.search_4_status_2"),option:{type:"success"}},{value:2,text:this.$t("userPage.search_4_status_3"),option:{type:"warning"}},{value:3,text:this.$t("userPage.search_4_status_4"),option:{type:"danger"}}]},{title:this.$t("userPage.login_language"),key:"language",type:"text"},{title:this.$t("userPage.login_time"),key:"loginTime",type:"text"},{title:this.$t("userPage.online_time"),key:"onlineTime",type:"text"},{title:this.$t("userPage.login_ip"),key:"ip",type:"text"},{title:this.$t("operation.operation"),key:"operate",type:"operate",fixed:"right",width:"100",buttons:[]}],searchControls:[{type:"input",key:"username",placeholder:this.$t("userPage.search_1"),width:"200px",size:"small"},{type:"treeSelect",key:"companyId",valueKey:"companyId",placeholder:this.$t("userPage.search_2"),width:"200px",treeOption:{defaultProps:{children:"sysCompanyNodes",label:"name"},nodeKey:"companyId",defaultExpandAll:!1,expandClickNode:!1,screenFn:{bindFn:function(e,t){return!e||-1!==t.name.indexOf(e)}}},treeDefinedData:[]},{type:"select",key:"appTerminal",placeholder:this.$t("userPage.search_4"),width:"200px",size:"small",clearable:!0,options:[{name:this.$t("userPage.search_4_status_1"),value:0},{name:this.$t("userPage.search_4_status_2"),value:1},{name:this.$t("userPage.search_4_status_3"),value:2},{name:this.$t("userPage.search_4_status_4"),value:3}]}],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1}}},computed:{},watch:{},created:function(){this.getCompanyTreeDataFn()},mounted:function(){},methods:{handlePermissionShow:function(){var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});this.tableOptions.columns[e].buttons=[],e>-1&&this.isPermissionShow("userOffline")&&this.tableOptions.columns[e].buttons.push({text:this.$t("userPage.table_button_11"),type:"text",size:"mini",funcName:"forcedOffline"})},getCompanyTreeDataFn:function(){var e=this;this.$http.get("/company/treeList/userManagement").then(function(t){t.code===e.$config.API_STATUS.OK&&(e.companyTreeData=t.data,e.tableOptions.searchControls[1].treeDefinedData=t.data,e.isSearch=!0,e.isTable=!1,e.$nextTick(function(){e.isTable=!0}))})},getTableData:function(e){var t=this;this.isSearch&&(this.tableOptions.loading=!0,this.$http.post("/user/list/online?pageNum="+e.pageNum+"&pageSize="+e.pageSize,e).then(function(e){if(e.code===t.$config.API_STATUS.OK){t.tableOptions.loading=!1,t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total;var a=e.data,s=a.androidCount,n=a.iosCount,i=a.total,o=a.weChatCount,r=a.webCount;t.num={androidCount:s,iosCount:n,total:i,weChatCount:o,webCount:r}}}))},tableResponseFn:function(e,t,a){this[t.funcName].call(function(){},e,t,a)},forcedOffline:function(e){var t=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),type:"warning"}).then(function(){t.$http.get("/user/offline/"+e.userId+"/"+e.username).then(function(a){a.code===t.$config.API_STATUS.OK&&(t.$refs.table.emitRequestTableData(),t.$message({type:e.message,message:t.$t("confirm.message")}))})})}}},o=(a("CBRM"),a("ZrdR")),r=Object(o.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isPermissionShow("userListOnline")?a("div",{staticClass:"onlineUsers"},[e.isTable?a("table-view",{ref:"table",attrs:{center:"","is-search":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,alias:e.alias,"is-shadow":""},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[a("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"})],1):e._e(),e._v(" "),a("div",{staticClass:"application"},[a("span",[e._v(" "+e._s(e.$t("userPage.online_total"))+": "+e._s(e.num.total)+" ")]),e._v(" "),a("span",[e._v(" "+e._s(e.$t("userPage.search_4_status_1"))+": "+e._s(e.num.webCount)+" ")]),e._v(" "),a("span",[e._v(" "+e._s(e.$t("userPage.search_4_status_2"))+": "+e._s(e.num.androidCount)+" ")]),e._v(" "),a("span",[e._v(" "+e._s(e.$t("userPage.search_4_status_3"))+": "+e._s(e.num.iosCount)+" ")]),e._v(" "),a("span",[e._v(" "+e._s(e.$t("userPage.search_4_status_4"))+": "+e._s(e.num.weChatCount)+" ")])])],1):e._e()},[],!1,null,"28e53217",null);r.options.__file="onlineUsers.vue";t.default=r.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-49e5"],{DtAb:function(e,r,a){"use strict";a.r(r);var t=a("bS4n"),l=a.n(t),o=a("ABCu"),s=a("8t5x"),i={name:"SecuritySetDrawer",components:{treeView:o.a},data:function(){var e=function(e,r,a){if(""===r)a(new Error("请输入触发规则"));else try{var t=Number(r);"ruleTime"===e.fullField&&(t>0&&t<=600?a():a(new Error("触发时间请输入1-600数字"))),"ruleCount"===e.fullField&&(t>0&&t<=10?a():a(new Error("触发次数请输入1-10数字")))}catch(e){a(new Error("输入正确的数字格式"))}};return{itemStyle:"width: 352px;",drawerObj:{isShow:!1,isAdd:!0,title:"添加主动安全报警设置",editData:null,attachData:{motorcadeId:null},formData:{alarmType:"",ruleTime:"",ruleCount:"",riskLevel:null,deduction:"",childEffect:0,reminder:0,status:1,autoHandler:1,handlerType:0,newsDisplay:[],alarmContent:"",solveDesc:""},rules:{alarmType:[{required:!0,message:"请选择报警类型",trigger:"change"}],ruleTime:[{required:!0,message:"请输入触发规则",trigger:"blur"},{validator:e,trigger:"blur"}],ruleCount:[{required:!0,message:"请输入触发规则",trigger:"blur"},{validator:e,trigger:"blur"}],riskLevel:[{required:!0,message:"请选择风险等级",trigger:"change"}],deduction:[{required:!0,message:"请输入扣分规则",trigger:"blur"},{validator:function(e,r,a){if(""===r)a(new Error("请输入扣分规则"));else try{var t=Number(r);t>0&&t<=10?a():a(new Error("输入1-10数字"))}catch(e){a(new Error("输入1-10数字"))}},trigger:"blur"}],childEffect:[{required:!0,message:"请选择下属客户",trigger:"change"}],reminder:[{required:!0,message:"请选择弹框提示",trigger:"change"}],status:[{required:!0,message:"请设置状态",trigger:"change"}],autoHandler:[{required:!0,message:"请选择是否自动处理",trigger:"change"}],handlerType:[{required:!0,message:"请选择处理方式",trigger:"change"}],solveDesc:[{required:!0,message:"请输入处理描述",trigger:"blur"}]}},alarmTree:[],activeAlarmType:{label:"",value:null},treeOption:{defaultProps:{children:"children",label:"typeName"},nodeKey:"typeCode",defaultExpandAll:!1,expandClickNode:!1}}},computed:l()({},Object(s.b)(["elNorms"])),created:function(){this.getSelectDataFn()},methods:{getSelectDataFn:function(){var e=this;this.$http.get("/alarm/setting/type/list",{alarmType:1}).then(function(r){r.code===e.$config.API_STATUS.OK&&(e.alarmTree=r.data)})},openFn:function(e,r){var a=this;if(this.drawerObj.attachData.motorcadeId=r.motorcadeId,"add"===e&&(this.drawerObj.isAdd=!0,this.drawerObj.title="添加主动安全报警设置",this.drawerObj.formData=this.$options.data().drawerObj.formData),"edit"===e){for(var t in this.drawerObj.isAdd=!1,this.drawerObj.title="编辑主动安全报警设置",this.drawerObj.editData=r,this.drawerObj.formData){var l=r[t];void 0!==l&&null!==l&&(this.drawerObj.formData[t]=l)}r.alarmType&&this.$nextTick(function(){var e=a.$refs.tree.$refs.sonTree.getNode(r.alarmType);e.data&&(a.activeAlarmType={label:e.data[a.treeOption.defaultProps.label],value:e.data[a.treeOption.nodeKey]})})}this.drawerObj.isShow=!0},nodeClick:function(e,r){0!==e.parentId&&(this.drawerObj.formData.alarmType=e[this.treeOption.nodeKey],this.activeAlarmType={label:e[this.treeOption.defaultProps.label],value:e[this.treeOption.nodeKey]})},submit:function(){var e=this;this.$refs.handleForm.validate(function(r){if(!r)return!1;var a=e.drawerObj.formData;a.motorcadeId=e.drawerObj.attachData.motorcadeId,e.drawerObj.isAdd?e.$http.post("/alarm/setting/create",a).then(function(r){r.code===e.$config.API_STATUS.OK&&(e.$message.success("添加成功！"),e.drawerObj.isShow=!1,e.$parent.refreshFn&&e.$parent.refreshFn())}):e.$http.post("/alarm/setting/update/"+e.drawerObj.editData.settingId,a).then(function(r){r.code===e.$config.API_STATUS.OK&&(e.$message.success("编辑成功！"),e.drawerObj.isShow=!1,e.$parent.refreshFn&&e.$parent.refreshFn())})})}}},d=(a("MVXZ"),a("ZrdR")),n=Object(d.a)(i,function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("el-drawer",{attrs:{title:e.drawerObj.title,visible:e.drawerObj.isShow,"wrapper-closable":!1,size:"600px",direction:"rtl"},on:{"update:visible":function(r){e.$set(e.drawerObj,"isShow",r)}}},[e.drawerObj.isShow?a("div",{staticClass:"drawer-body",staticStyle:{"margin-bottom":"120px"}},[a("el-form",{ref:"handleForm",attrs:{size:e.elNorms.fromSize,model:e.drawerObj.formData,rules:e.drawerObj.rules,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"报警类型：",prop:"alarmType"}},[a("el-select",{style:e.itemStyle,attrs:{size:e.elNorms.size,placeholder:"请选择"},model:{value:e.drawerObj.formData.alarmType,callback:function(r){e.$set(e.drawerObj.formData,"alarmType",r)},expression:"drawerObj.formData.alarmType"}},[a("el-option",{staticClass:"tree-select",attrs:{value:e.activeAlarmType.value,label:e.activeAlarmType.label}},[a("tree-view",{ref:"tree",attrs:{"tree-data":e.treeOption,"defined-data":e.alarmTree},on:{"node-click":e.nodeClick},scopedSlots:e._u([{key:"default",fn:function(r){return[a("span",{staticStyle:{"font-weight":"400"}},[e._v(e._s(r.data.node.label))])]}}])})],1)],1)],1),e._v(" "),a("el-form-item",{staticClass:"special-form-item",attrs:{label:"触发规则：",required:""}},[a("el-form-item",{attrs:{prop:"ruleTime"}},[a("el-input",{staticStyle:{width:"170px"},attrs:{size:e.elNorms.size,placeholder:"输入1-600数字"},model:{value:e.drawerObj.formData.ruleTime,callback:function(r){e.$set(e.drawerObj.formData,"ruleTime",r)},expression:"drawerObj.formData.ruleTime"}},[a("template",{slot:"append"},[e._v("秒内,")])],2)],1),e._v(" "),a("el-form-item",{attrs:{prop:"ruleCount"}},[a("el-input",{staticClass:"init-input",staticStyle:{width:"185px"},attrs:{size:e.elNorms.size,placeholder:"输入1-10数字"},model:{value:e.drawerObj.formData.ruleCount,callback:function(r){e.$set(e.drawerObj.formData,"ruleCount",r)},expression:"drawerObj.formData.ruleCount"}},[a("template",{slot:"prepend"},[e._v("报警")]),e._v(" "),a("template",{slot:"append"},[e._v("次")])],2)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"风险等级：",prop:"riskLevel"}},[a("el-select",{style:e.itemStyle,attrs:{size:e.elNorms.size,placeholder:"请选择"},model:{value:e.drawerObj.formData.riskLevel,callback:function(r){e.$set(e.drawerObj.formData,"riskLevel",r)},expression:"drawerObj.formData.riskLevel"}},[a("el-option",{attrs:{label:"高风险",value:2}}),e._v(" "),a("el-option",{attrs:{label:"中风险",value:1}}),e._v(" "),a("el-option",{attrs:{label:"低风险",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"扣分系统：",prop:"deduction"}},[a("el-input",{style:e.itemStyle,attrs:{size:e.elNorms.size,placeholder:"输入1-10数字"},model:{value:e.drawerObj.formData.deduction,callback:function(r){e.$set(e.drawerObj.formData,"deduction",r)},expression:"drawerObj.formData.deduction"}},[a("template",{slot:"append"},[e._v("分")])],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"下属客户：",prop:"childEffect"}},[a("el-radio-group",{attrs:{size:e.elNorms.size},model:{value:e.drawerObj.formData.childEffect,callback:function(r){e.$set(e.drawerObj.formData,"childEffect",r)},expression:"drawerObj.formData.childEffect"}},[a("el-radio",{attrs:{label:1}},[e._v("生效")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("不生效")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"弹框提醒：",prop:"reminder"}},[a("el-radio-group",{attrs:{size:e.elNorms.size},model:{value:e.drawerObj.formData.reminder,callback:function(r){e.$set(e.drawerObj.formData,"reminder",r)},expression:"drawerObj.formData.reminder"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"设置状态：",prop:"status"}},[a("el-radio-group",{attrs:{size:e.elNorms.size},model:{value:e.drawerObj.formData.status,callback:function(r){e.$set(e.drawerObj.formData,"status",r)},expression:"drawerObj.formData.status"}},[a("el-radio",{attrs:{label:1}},[e._v("启用")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("禁用")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"自动处理：",prop:"autoHandler"}},[a("el-radio-group",{attrs:{size:e.elNorms.size},model:{value:e.drawerObj.formData.autoHandler,callback:function(r){e.$set(e.drawerObj.formData,"autoHandler",r)},expression:"drawerObj.formData.autoHandler"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"处理方式：",prop:"handlerType"}},[a("el-radio-group",{attrs:{size:e.elNorms.size},model:{value:e.drawerObj.formData.handlerType,callback:function(r){e.$set(e.drawerObj.formData,"handlerType",r)},expression:"drawerObj.formData.handlerType"}},[a("el-radio",{attrs:{label:0}},[e._v("文本消息")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("解除报警")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("误报误判")])],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===e.drawerObj.formData.handlerType,expression:"drawerObj.formData.handlerType === 0"}],attrs:{label:"消息展示："}},[a("el-checkbox-group",{attrs:{size:e.elNorms.size},model:{value:e.drawerObj.formData.newsDisplay,callback:function(r){e.$set(e.drawerObj.formData,"newsDisplay",r)},expression:"drawerObj.formData.newsDisplay"}},[a("el-checkbox",{attrs:{label:0}},[e._v("紧急")]),e._v(" "),a("el-checkbox",{attrs:{label:1}},[e._v("终端显示器显示")]),e._v(" "),a("el-checkbox",{attrs:{label:2}},[e._v("终端TTS播读")]),e._v(" "),a("el-checkbox",{attrs:{label:3}},[e._v("广告屏显示")])],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0===e.drawerObj.formData.handlerType,expression:"drawerObj.formData.handlerType === 0"}],attrs:{label:"消息内容："}},[a("el-input",{attrs:{type:"textarea",rows:5,size:e.elNorms.size,placeholder:"请输入发送内容，内容为空时不下发消息"},model:{value:e.drawerObj.formData.alarmContent,callback:function(r){e.$set(e.drawerObj.formData,"alarmContent","string"==typeof r?r.trim():r)},expression:"drawerObj.formData.alarmContent"}})],1),e._v(" "),0===e.drawerObj.formData.handlerType?a("el-form-item",{attrs:{label:"处理描述",prop:"solveDesc"}},[a("el-input",{attrs:{type:"textarea",rows:5,size:e.elNorms.size,maxlength:"2000","show-word-limit":"",placeholder:"请输入处理描述，内容不超过2000字"},model:{value:e.drawerObj.formData.solveDesc,callback:function(r){e.$set(e.drawerObj.formData,"solveDesc","string"==typeof r?r.trim():r)},expression:"drawerObj.formData.solveDesc"}})],1):e._e()],1),e._v(" "),a("div",{staticClass:"footer-button"},[a("el-button",{attrs:{type:"primary",size:e.elNorms.size,round:e.elNorms.round,circle:e.elNorms.circle},on:{click:e.submit}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{size:e.elNorms.size,round:e.elNorms.round,circle:e.elNorms.circle},on:{click:function(r){e.drawerObj.isShow=!1}}},[e._v("取消")])],1)],1):e._e()])},[],!1,null,"65c8175e",null);n.options.__file="security-set-drawer.vue";r.default=n.exports},Lg8V:function(e,r,a){},MVXZ:function(e,r,a){"use strict";var t=a("Lg8V");a.n(t).a}}]);
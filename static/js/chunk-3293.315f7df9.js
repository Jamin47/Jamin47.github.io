(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3293","NVOe"],{"1ion":function(e,t,a){},CBRM:function(e,t,a){"use strict";var s=a("1ion");a.n(s).a},NVOe:function(e,t,a){"use strict";a.r(t);var s=a("bS4n"),n=a.n(s),i=a("8t5x");t.default={data:function(){return{permissionList:{userList:"/user/list",userCreate:"/user/create",userExport:"/user/export",userUpdate:"/user/update/**",userVehicle:"/user/vehicle/**",userReset:"/user/reset/**",userStatus:"/user/status",userDelete:"/user/delete",userListOnline:"/user/list/online",userOffline:"/user/offline/**/**",roleTreeList:"/role/treeList",roleCreate:"/role/create",roleUpdate:"/role/update",roleDelete:"/role/delete",roleAllocMenuAndPerm:"/role/allocMenuAndPerm",roleUpdateUserRole:"/role/updateUserRole",logListOperate:"/log/list/operate",logOperateExport:"/log/operate/export",logListLogin:"/log/list/login",logLoginExport:"/log/login/export",logListEquipment:"/log/list/equipment",logEquipmentExport:"/log/equipment/export"}}},computed:n()({},Object(i.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[e])}}}},r97K:function(e,t,a){"use strict";a.r(t);var s=a("AlM9"),n=a("NVOe"),i={components:{TableView:s.a},mixins:[n.default],data:function(){return{companyTreeData:[],num:{androidCount:0,iosCount:0,total:0,weChatCount:0,webCount:0},alias:{pageSize:"pageSize",pageNum:"pageNum"},isSearch:!1,isTable:!0,tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:"序号"},{title:this.$t("userPage.login_account"),key:"username",type:"text"},{title:this.$t("userPage.name"),key:"account",type:"text"},{title:this.$t("userPage.user_role"),key:"roleName",type:"text"},{title:this.$t("userPage.owned_customer"),key:"companyName",type:"text"},{title:this.$t("userPage.application_terminal"),key:"appTerminal",type:"tag",tags:[{value:0,text:this.$t("userPage.search_4_status_1")},{value:1,text:this.$t("userPage.search_4_status_2"),option:{type:"success"}},{value:2,text:this.$t("userPage.search_4_status_3"),option:{type:"warning"}},{value:3,text:this.$t("userPage.search_4_status_4"),option:{type:"danger"}}]},{title:this.$t("userPage.login_language"),key:"language",type:"text"},{title:this.$t("userPage.login_time"),key:"loginTime",type:"text"},{title:this.$t("userPage.online_time"),key:"onlineTime",type:"text"},{title:this.$t("userPage.login_ip"),key:"ip",type:"text"},{title:this.$t("operation.operation"),key:"operate",type:"operate",fixed:"right",width:"100",buttons:[]}],searchControls:[{type:"input",key:"username",placeholder:this.$t("userPage.search_1"),width:"200px",size:"small"},{type:"treeSelect",key:"companyId",valueKey:"companyId",placeholder:this.$t("userPage.search_2"),width:"200px",treeOption:{defaultProps:{children:"sysCompanyNodes",label:"name"},nodeKey:"companyId",defaultExpandAll:!1,expandClickNode:!1,screenFn:{bindFn:function(e,t){return!e||-1!==t.name.indexOf(e)}}},treeDefinedData:[]},{type:"select",key:"appTerminal",placeholder:this.$t("userPage.search_4"),width:"200px",size:"small",clearable:!0,options:[{name:this.$t("userPage.search_4_status_1"),value:0},{name:this.$t("userPage.search_4_status_2"),value:1},{name:this.$t("userPage.search_4_status_3"),value:2},{name:this.$t("userPage.search_4_status_4"),value:3}]}],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1}}},computed:{},watch:{},created:function(){this.getCompanyTreeDataFn()},mounted:function(){},methods:{handlePermissionShow:function(){var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});this.tableOptions.columns[e].buttons=[],e>-1&&this.isPermissionShow("userOffline")&&this.tableOptions.columns[e].buttons.push({text:this.$t("userPage.table_button_11"),type:"text",size:"mini",funcName:"forcedOffline"})},getCompanyTreeDataFn:function(){var e=this;this.$http.get("/company/treeList/userManagement").then(function(t){t.code===e.$config.API_STATUS.OK&&(e.companyTreeData=t.data,e.tableOptions.searchControls[1].treeDefinedData=t.data,e.isSearch=!0,e.isTable=!1,e.$nextTick(function(){e.isTable=!0}))})},getTableData:function(e){var t=this;this.isSearch&&(this.tableOptions.loading=!0,this.$http.post("/user/list/online?pageNum="+e.pageNum+"&pageSize="+e.pageSize,e).then(function(e){if(e.code===t.$config.API_STATUS.OK){t.tableOptions.loading=!1,t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total;var a=e.data,s=a.androidCount,n=a.iosCount,i=a.total,o=a.weChatCount,r=a.webCount;t.num={androidCount:s,iosCount:n,total:i,weChatCount:o,webCount:r}}}))},tableResponseFn:function(e,t,a){this[t.funcName].call(function(){},e,t,a)},forcedOffline:function(e){var t=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),type:"warning"}).then(function(){t.$http.get("/user/offline/"+e.userId+"/"+e.username).then(function(a){a.code===t.$config.API_STATUS.OK&&(t.$refs.table.emitRequestTableData(),t.$message({type:e.message,message:t.$t("confirm.message")}))})})}}},o=(a("CBRM"),a("ZrdR")),r=Object(o.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isPermissionShow("userListOnline")?a("div",{staticClass:"onlineUsers"},[e.isTable?a("table-view",{ref:"table",attrs:{center:"","is-search":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,alias:e.alias,"is-shadow":""},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[a("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"})],1):e._e(),e._v(" "),a("div",{staticClass:"application"},[a("span",[e._v(" "+e._s(e.$t("userPage.online_total"))+": "+e._s(e.num.total)+" ")]),e._v(" "),a("span",[e._v(" "+e._s(e.$t("userPage.search_4_status_1"))+": "+e._s(e.num.webCount)+" ")]),e._v(" "),a("span",[e._v(" "+e._s(e.$t("userPage.search_4_status_2"))+": "+e._s(e.num.androidCount)+" ")]),e._v(" "),a("span",[e._v(" "+e._s(e.$t("userPage.search_4_status_3"))+": "+e._s(e.num.iosCount)+" ")]),e._v(" "),a("span",[e._v(" "+e._s(e.$t("userPage.search_4_status_4"))+": "+e._s(e.num.weChatCount)+" ")])])],1):e._e()},[],!1,null,"28e53217",null);r.options.__file="onlineUsers.vue";t.default=r.exports}}]);
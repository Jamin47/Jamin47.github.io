(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0229","YelX","YelX","YelX"],{"45H3":function(e,t,i){},HldY:function(e,t,i){"use strict";var a=i("45H3");i.n(a).a},YelX:function(e,t,i){"use strict";i.r(t);var a=i("bS4n"),r=i.n(a),s=i("8t5x");t.default={data:function(){return{permissionList:{vehicleUpdate:"/vehicle/update/**",vehicleExport:"/vehicle/export",vehicleDelete:"/vehicle/delete",vehicleList:"/vehicle/list",vehicleCreate:"/vehicle/create",vehicleFastCreate:"/vehicle/fastCreate",vehicleMotorcadeCreate:"/vehicle/motorcade/create",vehicleMotorcadeUpdate:"/vehicle/motorcade/update",vehicleMotorcadeDelete:"/vehicle/motorcade/delete/**",companyList:"/company/list",companyCreate:"/company/create",companyExport:"/company/export",companyDetail:"/company/**",companyUpdate:"/company/update/**",companyPersonalization:"/company/personalization/**",companyDelete:"/company/delete",driverList:"/driver/list",driverCreate:"/driver/create",driverDetail:"/driver/get/**",driverUpdate:"/driver/update/**",driverDelete:"/driver/delete",driverExport:"/driver/export",labelList:"/label/list",labelCreate:"/label/create",labelUpdate:"/label/update/**",labelDelete:"/label/delete",labelExport:"/label/export",regionList:"/region/list",regionCreate:"/region/create",regionUpdate:"/region/update/**",regionDelete:"/region/delete",regionExport:"/region/export",routeList:"/route/list",routeCreate:"/route/create",routeUpdate:"/route/update/**",routeDelete:"/route/delete",routeExport:"/route/export",adminList:"/admin/list",adminCreate:"/admin/create",adminUpdate:"/admin/update/**",adminDelete:"/admin/delete",adminExport:"/admin/export",typeCreate:"/ef/type/create",typeUpdate:"/ef/type/update/**",typeDelete:"/ef/type/delete/**",drivingLicenseList:"/driving/license/list",drivingLicenseCreate:"/driving/license/create",drivingLicenseUpdate:"/driving/license/update/**",drivingLicenseDelete:"/driving/license/delete",drivingLicense:"/driving/license/export",transportList:"/transport/list",transportCreate:"/transport/create",transportUpdate:"/transport/update/**",transportDelete:"/transport/delete",transportExport:"/transport/export",maintainList:"/maintain/list",maintainCreate:"/maintain/create",maintainUpdate:"/maintain/update/**",maintainDelete:"/maintain/delete",maintainExport:"/maintain/export",insuranceList:"/insurance/list",insuranceCreate:"/insurance/create",insuranceUpdate:"/insurance/update/**",insuranceDelete:"/insurance/delete",insuranceExport:"/insurance/export",insuranceListAdvance:"/insurance/list/advance",annualList:"/annual/list",annualCreate:"/annual/create",annualUpdate:"/annual/update/**",annualDelete:"/annual/delete",annualExport:"/annual/export",annualListAdvance:"/annual/list/advance",repairList:"/repair/list",repairCreate:"/repair/create",repairUpdate:"/repair/update/**",repairDelete:"/repair/delete",repairExport:"/repair/export",accidentList:"/accident/list",accidentCreate:"/accident/create",accidentUpdate:"/accident/update/**",accidentDelete:"/accident/delete",accidentExport:"/accident/export",simList:"/sim/list",simCreate:"/sim/create",simUpdate:"/sim/update/**",simDelete:"/sim/delete",simExport:"/sim/export"}}},computed:r()({},Object(s.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[e])}}}},ZLLL:function(e,t,i){"use strict";i.r(t);var a=i("unDg"),r=i.n(a),s=i("AlM9"),n=i("BHIJ"),o=i("YelX"),c={components:{TableView:s.a,drawer:n.a},mixins:[o.default],data:function(){return{title:"",fieldMap:{},vehicleTree:[],drawerDisplay:!1,drawerData:{},alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:this.$t("certificatesAdminister.serial_number")},{title:this.$t("certificatesAdminister.license_plate_number"),key:"licenseNum",type:"text"},{title:this.$t("certificatesAdminister.license_plate_color"),key:"licenseColor",type:"tag",tags:[{value:1,text:this.$t("certificatesAdminister.blue")},{value:2,text:this.$t("certificatesAdminister.yellow")},{value:3,text:this.$t("certificatesAdminister.black")},{value:4,text:this.$t("certificatesAdminister.white")},{value:9,text:this.$t("certificatesAdminister.other")}]},{title:this.$t("certificatesAdminister.transport_certificate_no"),key:"transportNum",type:"text"},{title:this.$t("certificatesAdminister.business_scope"),key:"busScope",type:"text"},{title:this.$t("certificatesAdminister.effective_date"),key:"effectAt",type:"text"},{title:this.$t("certificatesAdminister.expiration_date"),key:"timeoutAt",type:"text"},{title:this.$t("certificatesAdminister.days_advance_reminder"),key:"advanceNum",type:"text"},{title:this.$t("operateCommon.operation"),type:"operate",key:"operate",fixed:"right",width:"140",buttons:[]}],buttonControls:[],searchControls:[{type:"input",key:"licenseNum",placeholder:this.$t("certificatesAdminister.license_plate_number"),width:"200px"},{type:"input",key:"transportNum",placeholder:this.$t("certificatesAdminister.transport_certificate_no"),width:"200px"}],footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1},params:null}},computed:{},created:function(){},mounted:function(){},methods:{handlePermissionShow:function(){this.tableOptions.buttonControls=[],this.isPermissionShow("transportCreate")&&this.tableOptions.buttonControls.push({text:this.$t("certificatesAdminister.add_transport_certificate"),type:"primary",icon:"el-icon-plus",funcName:"increase"}),this.isPermissionShow("transportExport")&&this.tableOptions.buttonControls.push({text:this.$t("certificatesAdminister.export_record"),type:"null",icon:"el-icon-download",funcName:"export",dataStatus:!0}),this.tableOptions.footerButtons=[],this.isPermissionShow("transportDelete")&&this.tableOptions.footerButtons.push({text:this.$t("operateCommon.delete"),type:"danger",icon:"el-icon-delete",funcName:"delete"});var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});this.tableOptions.columns[e].buttons=[],e>-1&&this.isPermissionShow("transportList")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("operateCommon.detailed"),icon:"iconfont Jamin_vehicle_ico_xq",type:"text",funcName:"detail"}),e>-1&&this.isPermissionShow("transportUpdate")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("operateCommon.edit"),icon:"iconfont Jamin_vehicle_icon_bj",type:"text",funcName:"edit"})},getTableData:function(e){var t=this;this.tableOptions.loading=!0;var i={licenseNum:e.licenseNum,transportNum:e.transportNum};this.$http.post("/transport/list?pageNum="+e.pageNum+"&pageSize="+e.pageSize,i).then(function(e){e.code===t.$config.API_STATUS.OK?(t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total):(t.tableOptions.data=[],t.tableOptions.total=0),t.tableOptions.loading=!1}).catch(function(){t.tableOptions.data=[],t.tableOptions.total=0,t.tableOptions.loading=!1}),this.params=e},getVehicleTreeData:function(e){var t=this,i=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.$http.get("/postion/transport/vehicleAllTreeList").then(function(a){i.close(),a.code===t.$config.API_STATUS.OK&&(t.vehicleTree=a.data.motorcades,t.forResetDevTreeFn(t.vehicleTree),e(!0))})},forResetDevTreeFn:function(e){var t=this;e.forEach(function(e){e.children=[].concat(r()(e.vehicles?e.vehicles:[]),r()(e.motorcades?e.motorcades:[])),e.children.length&&t.forResetDevTreeFn(e.children),e.vehicleId?(e.treeId="v_"+e.vehicleId,e.treeName=e.licenseNum):(e.treeId="m_"+e.motorcadeId,e.treeName=e.motorcadeName)})},newVehicle:function(){var e=this;this.getVehicleTreeData(function(t){e.drawerDisplay=!0,e.increaseData()})},oldVehicle:function(e){var t=this;this.title===this.$t("operateCommon.edit")?this.getVehicleTreeData(function(i){t.drawerDisplay=!0,t.editData(e)}):(this.drawerDisplay=!0,this.detailData(e))},tableResponseFn:function(e,t,i){this[t.funcName].call(function(){},e,t,i)},increase:function(){this.newVehicle()},increaseData:function(){var e=this,t=function(t,i,a){e.$refs.drawer.formData.effectAt&&e.$refs.drawer.formData.timeoutAt?new Date(e.$refs.drawer.formData.effectAt).getTime()>new Date(e.$refs.drawer.formData.timeoutAt).getTime()?a(new Error(e.$t("certificatesAdminister.expiration_time_text_tip"))):a():a()};this.drawerData={isShow:!0,title:this.$t("certificatesAdminister.add_transport_certificate"),titleWidth:"120",data:{},defaultData:"",submitAction:"/transport/create",btnAlign:"center",formList:[{title:this.$t("certificatesAdminister.bind_vehicle"),type:"treeSelect",key:"vehicleId",valueKey:"vehicleId",offsetWidth:"320",treeOption:{defaultProps:{children:"children",label:"treeName"},nodeKey:"treeId",nodeCode:"iconfont Jamin_vehicle_icon_clgl1",defaultExpandAll:!1,expandClickNode:!1,screenFn:{bindFn:function(e,t){return!e||-1!==t.treeName.indexOf(e)}}},treeDefinedData:this.vehicleTree,rules:[{required:!0,message:this.$t("certificatesAdminister.please_bind__vehicle"),trigger:"blur"}]},{title:this.$t("certificatesAdminister.transport_certificate_no"),type:"input",key:"transportNum",offsetWidth:"320",rules:[{required:!0,message:this.$t("certificatesAdminister.enter_transport_certificate_no"),trigger:"blur"}]},{title:this.$t("certificatesAdminister.business_scope"),type:"input",key:"busScope",offsetWidth:"320",rules:[{required:!0,message:this.$t("certificatesAdminister.enter_usage_nature"),trigger:"blur"}]},{title:this.$t("certificatesAdminister.effective_time"),type:"dateSelect",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"effectAt",rules:[{required:!0,message:this.$t("certificatesAdminister.select_effective_time"),trigger:"change"},{validator:t,trigger:"change"}]},{title:this.$t("certificatesAdminister.expiration_time"),type:"dateSelect",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"timeoutAt",rules:[{required:!0,message:this.$t("certificatesAdminister.select_expiration_time"),trigger:"change"},{validator:t,trigger:"change"}]},{title:this.$t("certificatesAdminister.days_advance_reminder"),type:"input",key:"advanceNum",offsetWidth:"320",rules:[{required:!0,message:this.$t("certificatesAdminister.enter_days_advance"),trigger:"blur"}]},{title:this.$t("certificatesAdminister.remarks_description"),type:"input",offsetWidth:"320",key:"remark"}],formButton:[{name:this.$t("confirm.determine"),type:"confirm",class:"primary"},{name:this.$t("confirm.cancel"),type:"cancel",class:""}],message:{type:"success",message:this.$t("certificatesAdminister.added_successfully")}}},export:function(e){var t=this;this.$confirm(this.$t("operateCommon.confirm_export_record"),this.$t("operateCommon.prompt"),{confirmButtonText:this.$t("operateCommon.ok"),cancelButtonText:this.$t("operateCommon.cancel"),type:"warning",closeOnClickModal:!1,beforeClose:function(e,i,a){t.fieldMap={},t.tableOptions.columns.forEach(function(e){t.$refs.table.columnCheckList.forEach(function(i){e.key===i&&"operate"!==e.key&&(t.fieldMap[i]=e.title)})});var r=t.$refs.table._data.searchParams,s=r.licenseNum,n=r.transportNum;if("confirm"===e){var o={fieldMap:t.fieldMap,licenseNum:s,transportNum:n};t.$http.download("/transport/export?isToken=true",o),a()}else a()}}).catch(function(){})},delete:function(e){var t=this;this.$confirm(this.$t("certificatesAdminister.is_delete"),this.$t("operateCommon.prompt"),{confirmButtonText:this.$t("operateCommon.ok"),cancelButtonText:this.$t("operateCommon.cancel"),type:"warning"}).then(function(){var i=[];e.forEach(function(e,t){i[t]=e.id}),t.$http.deleteApi("/transport/delete",{ids:i.join(",")}).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$refs.table.initRequestTableData(),t.$message({message:e.message,type:"success"}))})})},edit:function(e){this.title=this.$t("operateCommon.edit"),this.oldVehicle(e)},editData:function(e){var t=this,i=function(e,i,a){t.$refs.drawer.formData.effectAt&&t.$refs.drawer.formData.timeoutAt?new Date(t.$refs.drawer.formData.effectAt).getTime()>new Date(t.$refs.drawer.formData.timeoutAt).getTime()?a(new Error(t.$t("certificatesAdminister.expiration_time_text_tip"))):a():a()};this.drawerData={staticData:e,isShow:!0,title:this.$t("certificatesAdminister.edit_transportation_certificate"),titleWidth:"120",data:{},defaultData:"",submitAction:"/transport/update/"+e.id,btnAlign:"center",formList:[{title:this.$t("certificatesAdminister.bind_vehicle"),type:"treeSelect",key:"vehicleId",valueKey:"vehicleId",offsetWidth:"320",label:e.licenseNum,treeOption:{defaultProps:{children:"children",label:"treeName"},nodeKey:"treeId",nodeCode:"iconfont Jamin_vehicle_icon_clgl1",defaultExpandAll:!1,expandClickNode:!1,screenFn:{bindFn:function(e,t){return!e||-1!==t.treeName.indexOf(e)}}},treeDefinedData:this.vehicleTree,rules:[{required:!0,message:this.$t("certificatesAdminister.please_bind__vehicle"),trigger:"blur"}]},{title:this.$t("certificatesAdminister.transport_certificate_no"),type:"input",key:"transportNum",offsetWidth:"320",rules:[{required:!0,message:this.$t("certificatesAdminister.enter_transport_certificate_no"),trigger:"blur"}]},{title:this.$t("certificatesAdminister.business_scope"),type:"input",key:"busScope",offsetWidth:"320",rules:[{required:!0,message:this.$t("certificatesAdminister.enter_usage_nature"),trigger:"blur"}]},{title:this.$t("certificatesAdminister.effective_time"),type:"dateSelect",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"effectAt",rules:[{required:!0,message:this.$t("certificatesAdminister.select_effective_time"),trigger:"change"},{validator:i,trigger:"change"}]},{title:this.$t("certificatesAdminister.expiration_time"),type:"dateSelect",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"timeoutAt",rules:[{required:!0,message:this.$t("certificatesAdminister.select_expiration_time"),trigger:"change"},{validator:i,trigger:"change"}]},{title:this.$t("certificatesAdminister.days_advance_reminder"),type:"input",key:"advanceNum",offsetWidth:"320",rules:[{required:!0,message:this.$t("certificatesAdminister.enter_days_advance"),trigger:"blur"}]},{title:this.$t("certificatesAdminister.remarks_description"),type:"input",offsetWidth:"320",key:"remark"}],formButton:[{name:this.$t("confirm.determine"),type:"confirm",class:"primary"},{name:this.$t("confirm.cancel"),type:"cancel",class:""}],message:{type:"success",message:this.$t("confirm.editSuccess")}}},detail:function(e){this.title=this.$t("operateCommon.detailed"),this.oldVehicle(e)},detailData:function(e){this.drawerData={staticData:e,isShow:!0,title:this.$t("certificatesAdminister.transport_certificate_details"),titleWidth:"120",data:{},defaultData:"",submitAction:"/transport/update/"+e.id,btnAlign:"center",formList:[{title:this.$t("certificatesAdminister.bind_vehicle"),type:"textSelect",key:"vehicleId",offsetWidth:"320",list:this.vehicleIds},{title:this.$t("certificatesAdminister.transport_certificate_no"),type:"text",key:"transportNum",offsetWidth:"320"},{title:this.$t("certificatesAdminister.business_scope"),type:"text",key:"busScope",offsetWidth:"320"},{title:this.$t("certificatesAdminister.effective_time"),type:"text",offsetWidth:"320",key:"effectAt"},{title:this.$t("certificatesAdminister.expiration_time"),type:"text",offsetWidth:"320",key:"timeoutAt"},{title:this.$t("certificatesAdminister.days_advance_reminder"),type:"text",key:"advanceNum",offsetWidth:"320"},{title:this.$t("certificatesAdminister.remarks_description"),type:"text",offsetWidth:"320",key:"remark"}]}},diaClose:function(e){e&&this.$refs.table.initRequestTableData(),this.drawerDisplay=!1},endTime:function(e){this.$refs.drawer.formData.effectAt?new Date(e).getTime()<=new Date(this.$refs.drawer.formData.effectAt).getTime()&&(this.$message.error(this.$t("certificatesAdminister.end_time_text_tip")),this.$refs.drawer.formData.timeoutAt=null):(this.$message.error(this.$t("certificatesAdminister.select_start_time")),this.$refs.drawer.formData.timeoutAt=null)},drawerCallback:function(e,t,i,a){this[e.handlerCallback.funcName].call(function(){},t,i,a)}}},l=(i("HldY"),i("ZrdR")),d=Object(l.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"transportCertificate"},[i("table-view",{ref:"table",attrs:{center:"","id-key":"id","is-search":!0,"check-memory":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"view-table-key":"transportCertificate",checked:"","column-view":"","is-shadow":"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[i("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center"},slot:"number"})],1),e._v(" "),e.drawerDisplay?i("drawer",{ref:"drawer",attrs:{"drawer-data":e.drawerData},on:{diaClose:e.diaClose,handlerCallback:e.drawerCallback}}):e._e()],1)},[],!1,null,"43d837a2",null);d.options.__file="transportCertificate.vue";t.default=d.exports}}]);
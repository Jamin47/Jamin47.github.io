(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-01a1","B8wf"],{"9+Fj":function(e,t,i){},B8wf:function(e,t,i){"use strict";i.r(t);var o=i("bS4n"),r=i.n(o),a=i("8t5x");t.default={data:function(){return{permissionList:{positionPassReport:"/position/pass/rate/report",positionLocusReport:"/position/locus/complete/rate/report",positionDriftRateReport:"/position/vehicle/drift/rate/report",positionDriftReport:"/position/vehicle/drift/detail/report",positionHistoryReport:"/position/history/report",mileageCompanyReport:"/mileage/company/report",mileageVehicleReport:"/mileage/vehicle/report",mileageDriverReport:"/mileage/driver/report",mileageDayReport:"/mileage/vehicle/day/report",mileageMontyReport:"/mileage/vehicle/monty/report",alarmCommonList:"/alarm/common/list",onlineRateSummaryReport:"/online/rate/summary/report",onlineRateReport:"/online/rate/report",onlineSummaryReport:"/online/offline/summary/report",onlineDetailReport:"/online/offline/detail/report",onlineAccStatisticsReport:"/online/acc/ignition/statistics/report",onlineAccReport:"/online/acc/ignition/report",reportTemperatureAlarmStatistics:"/report/temperature/alarmStatistics",reportTemperatureList:"/report/temperature/list",reportTemperatureDetailInfo:"/report/temperature/detailInfo",driverSummaryReport:"/driver/login/logout/summary/report",driverDetailReport:"/driver/login/logout/detail/report",driverVehicleSummaryReport:"/driver/vehicle/login/logout/summary/report",driverVehicleDetailReport:"/driver/vehicle/login/logout/detail/report",driverIdReport:"/driver/id/report",positionPassExport:"/position/pass/rate/report/export",positionLocusExport:"/position/locus/complete/rate/report/export",positionDriftRateExport:"/position/vehicle/drift/rate/report/export",positionDriftDetailExport:"/position/vehicle/drift/detail/report/export",positionHistoryExport:"/position/history/report/export",mileageCompanyExport:"/mileage/company/report/export",mileageVehicleExport:"/mileage/vehicle/report/export",mileageDriverExport:"/mileage/driver/report/export",mileageDayExport:"/mileage/vehicle/day/report/export",mileageMontyExport:"/mileage/vehicle/monty/report/export",alarmReportExport:"/alarm/common/report/export",onlineRateSummaryExport:"/online/rate/summary/report/export",onlineRateExport:"/online/rate/report/export",onlineSummaryExport:"/online/offline/summary/report/export",onlineDetailExport:"/online/offline/detail/report/export",onlineAccStatisticsExport:"/online/acc/ignition/statistics/report/export",onlineAccExport:"/online/acc/ignition/report/export",reportTemperatureAlarmStatisticsExport:"/report/temperature/alarmStatistics/export",reportTemperatureListExport:"/report/temperature/list/export",reportTemperatureDetailInfoExport:"/report/temperature/detailInfo/export",driverSummaryExport:"/driver/login/logout/summary/report/export",driverDetailExport:"/driver/login/logout/detail/report/export",driverVehicleSummaryExport:"/driver/vehicle/login/logout/summary/report/export",driverVehicleDetailExport:"/driver/vehicle/login/logout/detail/report/export",driverIdExport:"/driver/id/report/export"}}},computed:r()({},Object(a.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[e])}}}},DDkG:function(e,t,i){"use strict";i.r(t);var o=i("omC7"),r=i.n(o),a=i("6ZY3"),n=i.n(a),l=i("AlM9"),s=i("B8wf"),p={name:"Tof2of4",components:{TableView:l.a},mixins:[s.default],data:function(){return{isTable:!0,tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:"序号"},{title:this.$t("view.license_num"),key:"licenseNum",type:"text",fixed:"left"},{title:this.$t("statisticsReport.license_color"),key:"licenseColor",type:"tag",tags:[]},{title:this.$t("statisticsReport.motorcade_name"),key:"motorcadeName",type:"text"},{title:this.$t("statisticsReport.total_mileage"),key:"driveMileage",type:"text"}],buttonControls:[],searchControls:[{type:"treeSelect",key:"vehicleIds",valueKey:"vehicleId",placeholder:this.$t("view.license_num"),width:"200px",clearable:!0,treeOption:{defaultProps:{children:"children",label:"treeName"},nodeKey:"treeId",nodeCode:"iconfont Jamin_vehicle_icon_clgl1",defaultExpandAll:!1,expandClickNode:!1,checkbox:!0,screenFn:{bindFn:function(e,t){return!e||-1!==t.treeName.indexOf(e)}}},treeDefinedData:this.$parent.devTreeData},{type:"daterange",key:"time",startPlaceholder:this.$t("view.start_time"),endPlaceholder:this.$t("view.end_time"),width:"280px",condition:{key:"reportType",value:0}},{type:"monthrange",key:"monthTime",startPlaceholder:this.$t("view.start_time"),endPlaceholder:this.$t("view.end_time"),width:"280px",valueFormat:"yyyy-MM",condition:{key:"reportType",value:1}},{type:"select",key:"reportType",width:"120px",clearable:!0,value:0,options:[{name:this.$t("statisticsReport.day_report"),value:0},{name:this.$t("statisticsReport.month_report"),value:1}]}],searchMode:"immediate",footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1},params:null,tableAllData:[]}},methods:{handlePermissionShow:function(){this.tableOptions.buttonControls=[],(this.isPermissionShow("mileageDayExport")||this.isPermissionShow("mileageMontyExport"))&&this.tableOptions.buttonControls.push({text:this.$t("operation.export_record"),type:"null",round:!1,icon:"el-icon-document",funcName:"exportRecord",dataStatus:!0})},getTableData:function(e){var t=this;if(e.vehicleIds)if(e.time||e.monthTime){if(this.tableOptions.loading=!0,!this.params||this.params.page===e.page&&this.params.limit===e.limit||e.reportType!==this.params.reportType){var i=0===e.reportType?"/mileage/vehicle/day/report":"/mileage/vehicle/monty/report",o=0===e.reportType?e.time:e.monthTime,r={vehicleIds:JSON.parse(e.vehicleIds),startTime:o?o[0]:null,endTime:o?o[1]:null};this.$http.post(i,r).then(function(i){t.tableOptions.loading=!1,i.code===t.$config.API_STATUS.OK&&i.data&&(t.tableAllData=i.data,t.tableAllData.length&&t.resetTableColumns(t.tableAllData[0].dateMap),t.initTableDataFn(e),t.tableOptions.total=i.data.length)}).catch(function(){t.tableOptions.loading=!1})}else this.initTableDataFn(e),this.tableOptions.loading=!1;this.params=e}else this.$message.warning(this.$t("statisticsReport.tip_2"))},initTableDataFn:function(e){var t=(e.page-1)*e.limit,i=e.page*e.limit>this.tableAllData.length?this.tableAllData.length:e.page*e.limit,o=this.tableAllData.slice(t,i);o.forEach(function(e){e.dateMap&&n()(e,e.dateMap)}),this.tableOptions.data=JSON.parse(r()(o))},resetTableColumns:function(e){var t=this,i=[{type:"slot",name:"number",title:"序号"},{title:this.$t("view.license_num"),key:"licenseNum",type:"text",fixed:"left",minWidth:120},{title:this.$t("statisticsReport.license_color"),key:"licenseColor",type:"tag",tags:this.$parent.dictObj.licenseColor},{title:this.$t("statisticsReport.motorcade_name"),key:"motorcadeName",type:"text",minWidth:150},{title:this.$t("statisticsReport.total_mileage"),key:"driveMileage",type:"text",minWidth:120}];for(var o in e){var r={title:o+"(km)",key:o,type:"text",minWidth:130};i.push(r)}this.$refs.table.viewColumns=i,this.$refs.table.isTable=!1,this.$nextTick(function(){t.$refs.table.isTable=!0})},tableResponseFn:function(e,t,i){this[t.funcName].call(function(){},e,t,i)},exportRecord:function(){var e=this,t=this.params,i=t.vehicleIds,o=t.time,r=t.monthTime,a=t.reportType;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),closeOnClickModal:!1,beforeClose:function(t,n,l){if(e.fieldMap={},e.tableOptions.columns.forEach(function(t){e.$refs.table.columnCheckList.forEach(function(i){t.key===i&&"operate"!==t.key&&(e.fieldMap[i]=t.title)})}),"confirm"===t){var s=1===a?r:o,p=0===a?"/mileage/vehicle/day/report/export?isToken=true":"/mileage/vehicle/monty/report/export?isToken=true",m=0===a?"/mileage/vehicle/day/report/export/async":"/mileage/vehicle/monty/report/export/async",c={fieldMap:e.fieldMap,vehicleIds:JSON.parse(i),startTime:s?s[0]:null,endTime:s?s[1]:null};e.tableAllData.length<e.$store.getters.userData.realtimeVideoUrl?e.$http.download(p,c):e.$http.post(m,c),l()}else l()}}).catch(function(){})}}},m=(i("tb11"),i("ZrdR")),c=Object(m.a)(p,function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isTable?i("table-view",{ref:"table",attrs:{center:"","id-key":"id","is-search":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"is-shadow":""},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[i("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",fixed:"left",width:"60"},slot:"number"})],1):e._e()},[],!1,null,"4fbcc661",null);c.options.__file="t_2_4.vue";t.default=c.exports},tb11:function(e,t,i){"use strict";var o=i("9+Fj");i.n(o).a}}]);
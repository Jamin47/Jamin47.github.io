(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-452b","Cy+k"],{"6EgD":function(e,t,a){"use strict";a.r(t);var i=a("unDg"),s=a.n(i),n=a("AlM9"),r=a("BHIJ"),o=a("Cy+k"),d={name:"InIssueHistoryComponents",components:{TableView:n.a,drawer:r.a},mixins:[o.default],data:function(){return{isTable:!0,drawerDisplay:!1,drawerData:{},alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:this.$t("upgradePage.index")},{title:this.$t("view.license_num"),key:"licenseNum",type:"text"},{title:this.$t("upgradePage.motorcade_name"),key:"motorcadeName",type:"text"},{title:this.$t("upgradePage.issued_status"),key:"issuedStatus",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.issued_status_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.issued_status_2"),option:{type:"success"}},{value:2,text:this.$t("upgradePage.issued_status_3"),option:{type:"primary"}}]},{title:this.$t("upgradePage.original_version"),key:"originalVersion",type:"text"},{title:this.$t("upgradePage.version_num"),key:"versionNum",type:"text"},{title:this.$t("upgradePage.package_type"),key:"packageType",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.package_type_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.package_type_2"),option:{type:"primary"}}]},{title:this.$t("upgradePage.execution_status"),key:"upgradeStatus",type:"tagText",tags:[{value:0,text:this.$t("upgradePage.execution_status_1"),option:{type:"warning"}},{value:1,text:this.$t("upgradePage.execution_status_2"),option:{type:"success"}},{value:2,text:this.$t("upgradePage.execution_status_3"),option:{type:"primary"}},{value:3,text:this.$t("upgradePage.execution_status_4"),option:{type:"danger"}}]},{title:this.$t("view.start_time"),key:"startTime",type:"text"},{title:this.$t("view.end_time"),key:"endTime",type:"text"},{title:this.$t("upgradePage.username"),key:"username",type:"text"},{title:this.$t("upgradePage.create_time"),key:"createTime",type:"text"},{title:this.$t("operation.operation"),type:"operate",key:"operate",fixed:"right",buttons:[]}],buttonControls:[],searchControls:[{type:"treeSelect",key:"licenseNum",valueKey:"licenseNum",placeholder:this.$t("upgradePage.tree_placeholder"),width:"200px",clearable:!0,treeOption:{defaultProps:{children:"children",label:"treeName"},nodeKey:"treeId",defaultExpandAll:!1,expandClickNode:!1,checkbox:!0,screenFn:{bindFn:function(e,t){return!e||-1!==t.treeName.indexOf(e)}}},treeDefinedData:[]},{type:"input",key:"versionNum",placeholder:this.$t("upgradePage.version_num"),width:"160px"},{type:"select",key:"packageType",placeholder:this.$t("upgradePage.package_type"),width:"160px",clearable:!0,options:[{name:this.$t("upgradePage.package_type_1"),value:0},{name:this.$t("upgradePage.package_type_2"),value:1}]},{type:"select",key:"upgradeStatus",placeholder:this.$t("upgradePage.execution_status"),width:"160px",clearable:!0,options:[{name:this.$t("upgradePage.execution_status_1"),value:0},{name:this.$t("upgradePage.execution_status_2"),value:1},{name:this.$t("upgradePage.execution_status_3"),value:2},{name:this.$t("upgradePage.execution_status_4"),value:3}]},{type:"datetimerange",key:"time",startPlaceholder:this.$t("view.start_time"),endPlaceholder:this.$t("view.end_time"),width:"360px"}],footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1}}},computed:{},created:function(){this.getDevAllTreeDataFn()},mounted:function(){},methods:{handlePermissionShow:function(){var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});this.tableOptions.columns[e].buttons=[],e>-1&&this.isPermissionShow("resetUpgradePush")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("upgradePage.again"),icon:"iconfont Jamin_device_icon_cxts",type:"text",funcName:"againFn"})},getTableData:function(e){var t=this;e.startTime=e.time&&e.time[0]?e.time[0]:"",e.endTime=e.time&&e.time[1]?e.time[1]:"",delete e.time,this.tableOptions.loading=!0,this.$http.post("/upgrade/list/record",e).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.tableOptions.loading=!1,t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total)})},tableResponseFn:function(e,t,a){this[t.funcName].call(function(){},e,t,a)},getDevAllTreeDataFn:function(){var e=this;this.$http.get("/postion/otaUpgrade/vehicleAllTreeList").then(function(t){t.code===e.$config.API_STATUS.OK&&(e.forTreeResetDataFn(t.data.motorcades),e.tableOptions.searchControls[0].treeDefinedData=t.data.motorcades,e.isTable=!1,e.$nextTick(function(){e.isTable=!0}))})},forTreeResetDataFn:function(e){var t=this;e.forEach(function(e){e.vehicleId?(e.treeName=e.licenseNum,e.treeId="v_"+e.vehicleId,e.lezy=!0):(e.treeName=e.motorcadeName,e.treeId="m_"+e.motorcadeId,e.children=[].concat(s()(e.vehicles),s()(e.motorcades)),t.forTreeResetDataFn(e.children))})},againFn:function(e){var t=this;this.$confirm(this.$t("confirm.content"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel")}).then(function(){t.$http.deleteApi("/upgrade/push/"+e.recordId).then(function(e){e.code===t.$config.API_STATUS.OK&&t.$message.success(t.$t("confirm.message"))})})},diaClose:function(){this.$refs.table.emitRequestTableData(),this.drawerDisplay=!1},drawerCallback:function(e,t,a,i){this[e.handlerCallback.funcName].call(function(){},t,a,i)}}},l=(a("NH45"),a("ZrdR")),c=Object(l.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"inIssue-history-components"},[e.isTable?a("table-view",{ref:"table",attrs:{center:"","id-key":"id","is-search":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"is-shadow":"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[a("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center",width:"60"},slot:"number"})],1):e._e(),e._v(" "),e.drawerDisplay?a("drawer",{ref:"drawer",attrs:{"drawer-data":e.drawerData},on:{diaClose:e.diaClose,handlerCallback:e.drawerCallback}}):e._e()],1)},[],!1,null,"0d017d48",null);c.options.__file="upgradeRecord.vue";t.default=c.exports},"Cy+k":function(e,t,a){"use strict";a.r(t);var i=a("bS4n"),s=a.n(i),n=a("8t5x");t.default={data:function(){return{permissionList:{deviceList:"/device/list",deviceDetail:"/device/get/**",deviceCreate:"/device/create",deviceUpdate:"/device/update/**",deviceExport:"/device/export",deviceDelete:"/device/delete",vehicleFastCreate:"/vehicle/fastCreate",upgradeList:"/upgrade/list",upgradeListTask:"/upgrade/list/task",upgradeListRecord:"/upgrade/list/record",upgradeUpdate:"/upgrade/update/**",upgradeCreate:"/upgrade/create",upgradeDelete:"/upgrade/delete",upgradePush:"/upgrade/push",resetUpgradePush:"/upgrade/push/**",upgradeTaskPush:"/upgrade/task/push",upgradeTaskFailPush:"/upgrade/task/fail/push",deviceSettings:"/device/settings",deviceControlSetPassword:"/device/control/set/password",deviceControl:"/device/control",deviceControlDiskFormat:"/device/control/disk/format",deviceControlVehicle:"/device/control/vehicle",deviceTerminalText:"/device/terminal/text",deviceTerminalEvents:"/device/terminal/events",deviceTerminalQuestion:"/device/terminal/question",deviceTerminalNews:"/device/terminal/news",deviceTerminalCamera:"/device/terminal/camera",deviceTerminalSoundRecord:"/device/terminal/soundRecord",deviceTerminalVoiceMonitor:"/device/terminal/voiceMonitor",deviceOrderOffline:"/device/order/offline",deviceOrderOfflineExport:"/device/order/offline/export",deviceOrderDelete:"/device/order/delete",deviceOrderHistory:"/device/order/history",deviceOrderHistoryExport:"/device/order/history/export",simList:"/sim/list",simCreate:"/sim/create",simUpdate:"/sim/update/**",simDelete:"/sim/delete",simExport:"/sim/export"}}},computed:s()({},Object(n.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[e])}}}},NH45:function(e,t,a){"use strict";var i=a("NgYC");a.n(i).a},NgYC:function(e,t,a){}}]);
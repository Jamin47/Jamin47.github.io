(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2837","chunk-572e","Cili"],{"70mJ":function(t,a,i){"use strict";i.r(a);var e=i("JyS4"),s=i("Cili"),r=i("XVnh"),n={components:{alarmDistribution:e.default,notPerm:r.a},mixins:[s.default],data:function(){return{userScoreRankingData:[],alarmTypeData:[],alarmCarData:[],todayRiskData:{highRiskAlarmCount:0,highRiskVehicleCount:0,lowRiskAlarmCount:0,lowRiskVehicleCount:0,mediumRiskAlarmCount:0,mediumRiskVehicleCount:0},alarmDistributionData:{alarmTotal:0,vehicleTotal:0,onlineVehicle:0,asAlarmTodayDataList:[]},todayAlarmData:[],weekAlarmData:[],alarmDistributionDataLoading:!1,isPermission:!1}},computed:{alarmTypeCount:function(){return this.alarmTypeData.reduce(function(t,a){return t+a.alarmCount},0)},alarmCarCount:function(){return this.alarmCarData.reduce(function(t,a){return t+a.alarmCount},0)}},mounted:function(){},methods:{handlePermissionShow:function(){var t=this,a=[{permission:"alarmPreviewTodayRisk",functionName:"handleTodayRiskData"},{permission:"alarmPreviewYesterdayScore",functionName:"handleUserScoreRankingData"},{permission:"alarmPreviewTodayType",functionName:"handleAlarmTypeData"},{permission:"alarmPreviewTodayLocation",functionName:"handleAlarmDistributionData"},{permission:"alarmPreviewTodayAnalyze",functionName:"getLinkChartData"},{permission:"alarmPreviewTodayAnalyze",functionName:"getWeekLineChartData"},{permission:"alarmPreviewTodayHandle",functionName:"getPieChartData"},{permission:"alarmPreviewTodayVehicle",functionName:"handleAlarmTopData"}];this.isPermission=a.some(function(a){return t.isPermissionShow(a.permission)}),this.$nextTick(function(){a.forEach(function(a){t.isPermissionShow(a.permission)&&t[a.functionName]()})})},initAlarmLineChart:function(){var t=document.getElementById("lineChart"),a=this.$echarts.init(t),i=this.todayAlarmData.map(function(t){return t.time}),e=this.todayAlarmData.map(function(t){return t.count}),s={grid:{top:51,right:46,bottom:40,left:66},xAxis:{type:"category",boundaryGap:!1,axisLabel:{color:"#999999"},data:i},yAxis:{name:this.$t("securitySurvey.unit_times"),axisLabel:{color:"#999999"},nameTextStyle:{color:"#999999",padding:[4,52,0,0]},minInterval:1},tooltip:{trigger:"axis",padding:0,backgroundColor:"#0058FF",borderColor:"#0058FF",formatter:function(t,a,i){return'\n              <div class="chart-tooltip">\n                <p>'+t[0].axisValue+"</p>\n                <p>"+t[0].data+"次</p>\n              </div>\n            "}},series:[{data:e,type:"line",areaStyle:{},itemStyle:{normal:{areaStyle:{type:"default",color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(6, 137, 255, 0.11)"},{offset:1,color:"rgba(255, 255, 255, 0.5)"}])},lineStyle:{color:"#5282EE"}}}}]};s&&a.setOption(s)},initWeekAlarmLineChart:function(){var t=document.getElementById("weekLineChart"),a=this.$echarts.init(t),i=this.weekAlarmData.map(function(t){return t.time.replace(/\d{4}-/,"")}),e=this.weekAlarmData.map(function(t){return t.count}),s={grid:{top:50,bottom:50,left:70},xAxis:{type:"category",boundaryGap:!1,axisLabel:{color:"#999999"},data:i},yAxis:{name:this.$t("securitySurvey.unit_times"),axisLabel:{color:"#999999"},nameTextStyle:{color:"#999999",padding:[4,52,0,0]},minInterval:1},tooltip:{trigger:"axis",padding:0,backgroundColor:"#FE8327",borderColor:"#FE8327",formatter:function(t,a,i){return'\n              <div class="chart-tooltip week-link-chart">\n                <p>'+t[0].axisValue+"</p>\n                <p>"+t[0].data+"次</p>\n              </div>\n            "}},series:[{data:e,type:"line",areaStyle:{},itemStyle:{normal:{color:"#F4AD70",areaStyle:{type:"default",color:new this.$echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(238, 124, 83, 0.15)"},{offset:1,color:"rgba(255, 255, 255, 0.5)"}])},lineStyle:{color:"#F4AD70"}}}}]};s&&a.setOption(s)},initAlarmPieChart:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=document.getElementById("pieChart"),i=this.$echarts.init(a),e={grid:{top:60,left:70},title:{titleStyle:"#999999"},tooltip:{trigger:"item"},legend:{icon:"circle",orient:"vertical",top:20,left:20},color:["#FFB140","#3277FF"],series:[{type:"pie",radius:[45,60],left:"center",top:60,width:400,itemStyle:{borderColor:"#fff",borderWidth:1},label:{alignTo:"edge",formatter:this.$t("securitySurvey.total")+":{c}\n"+this.$t("securitySurvey.proportion")+":{d}%",minMargin:5,edgeDistance:50,lineHeight:15,rich:{time:{fontSize:10,color:"#999"}}},labelLine:{normal:{length:0,length2:0}},labelLayout:function(t){var a=t.labelRect.x<i.getWidth()/2,e=t.labelLinePoints;return e[2][0]=a?t.labelRect.x:t.labelRect.x+t.labelRect.width,{labelLinePoints:e}},data:t}]};e&&i.setOption(e)},getLinkChartData:function(){var t=this;this.$http.get("/alarm/preview/today/analyze").then(function(a){a.code===t.$config.API_STATUS.OK&&(t.todayAlarmData=a.data||[],t.$nextTick(function(){t.initAlarmLineChart()}))})},getWeekLineChartData:function(){var t=this;this.$http.get("/alarm/preview/today/analyze/7").then(function(a){a.code===t.$config.API_STATUS.OK&&(t.weekAlarmData=a.data||[],t.$nextTick(function(){t.initWeekAlarmLineChart()}))})},getPieChartData:function(){var t=this;this.$http.get("/alarm/preview/today/handle").then(function(a){if(a.code===t.$config.API_STATUS.OK){var i=[{value:a.data.handleTotal||0,name:t.$t("securitySurvey.processed")},{value:a.data.untreatedTotal||0,name:t.$t("securitySurvey.untreated")}];t.initAlarmPieChart(i)}else{var e=[{value:0,name:t.$t("securitySurvey.processed")},{value:0,name:t.$t("securitySurvey.untreated")}];t.initAlarmPieChart(e)}})},handleAlarmTopData:function(){var t=this;this.$http.get("/alarm/preview/today/vehicle").then(function(a){a.code===t.$config.API_STATUS.OK&&(t.alarmCarData=a.data||[])})},handleUserScoreRankingData:function(){var t=this;this.$http.get("/alarm/preview/yesterday/score").then(function(a){a.code===t.$config.API_STATUS.OK&&(t.userScoreRankingData=a.data||[])})},handleAlarmTypeData:function(){var t=this;this.$http.get("/alarm/preview/today/type").then(function(a){a.code===t.$config.API_STATUS.OK&&(t.alarmTypeData=a.data)})},handleTodayRiskData:function(){var t=this;this.$http.get("/alarm/preview/today/risk").then(function(a){a.code===t.$config.API_STATUS.OK&&(t.todayRiskData=a.data||{})})},handleAlarmDistributionData:function(){var t=this;this.alarmDistributionDataLoading=!0,this.$http.get("/alarm/preview/today/location").then(function(a){t.alarmDistributionDataLoading=!1,a.code===t.$config.API_STATUS.OK&&(t.alarmDistributionData=a.data)}).catch(function(){t.alarmDistributionDataLoading=!1})}}},l=(i("9cr+"),i("ZrdR")),o=Object(l.a)(n,function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"page-view security-survey-page"},[t.isPermission?i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("div",{staticClass:"item-view"},[i("div",{staticClass:"item-title"},[i("div",{staticClass:"decorate"}),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.today_risk_profile")))])]),t._v(" "),i("div",{staticClass:"item-body view-modular item-padding",staticStyle:{padding:"25px"}},[i("div",{staticClass:"row-view"},[i("div",{staticClass:"risk-view",staticStyle:{border:"2px solid #fe2759","border-left":"4px solid #fe2759"}},[i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.high_risk_alarm_count")))]),t._v(" "),i("div",{staticClass:"num",staticStyle:{color:"#fe2759"}},[t._v(t._s(t.todayRiskData.highRiskAlarmCount))])]),t._v(" "),i("div",{staticClass:"risk-view",staticStyle:{border:"2px solid #fe3976","border-left":"4px solid #fe3976"}},[i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.high_risk_car_count")))]),t._v(" "),i("div",{staticClass:"num",staticStyle:{color:"#fe3976"}},[t._v(t._s(t.todayRiskData.highRiskVehicleCount))])])]),t._v(" "),i("div",{staticClass:"row-view"},[i("div",{staticClass:"risk-view",staticStyle:{border:"2px solid #fe8a1c","border-left":"4px solid #fe8a1c"}},[i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.medium_risk_alarm_count")))]),t._v(" "),i("div",{staticClass:"num",staticStyle:{color:"#fe8a1c"}},[t._v(t._s(t.todayRiskData.mediumRiskAlarmCount))])]),t._v(" "),i("div",{staticClass:"risk-view",staticStyle:{border:"2px solid #fec11c","border-left":"4px solid #fec11c"}},[i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.medium_risk_car_count")))]),t._v(" "),i("div",{staticClass:"num",staticStyle:{color:"#fec11c"}},[t._v(t._s(t.todayRiskData.mediumRiskVehicleCount))])])]),t._v(" "),i("div",{staticClass:"row-view"},[i("div",{staticClass:"risk-view",staticStyle:{border:"2px solid #19c972","border-left":"4px solid #19c972"}},[i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.low_risk_alarm_count")))]),t._v(" "),i("div",{staticClass:"num",staticStyle:{color:"#19c972"}},[t._v(t._s(t.todayRiskData.lowRiskAlarmCount))])]),t._v(" "),i("div",{staticClass:"risk-view",staticStyle:{border:"2px solid #19c9ae","border-left":"4px solid #19c9ae"}},[i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.low_risk_car_count")))]),t._v(" "),i("div",{staticClass:"num",staticStyle:{color:"#19c9ae"}},[t._v(t._s(t.todayRiskData.lowRiskVehicleCount))])])])])]),t._v(" "),i("div",{staticClass:"item-view"},[i("div",{staticClass:"item-title"},[i("div",{staticClass:"decorate"}),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.user_scope_ranking")))])]),t._v(" "),i("div",{staticClass:"item-body view-modular item-padding"},[t.userScoreRankingData.length>0?i("div",{staticClass:"scrollbar-view"},t._l(t.userScoreRankingData,function(a,e){return i("div",{key:a.companyId,staticClass:"score-ranking-item",class:{"active-ranking":e%2==0}},[i("span",{staticClass:"text text-ellipsis"},[i("span",[t._v(t._s(e+1))]),t._v("\n                "+t._s(a.companyName)+"\n              ")]),t._v(" "),i("span",{staticClass:"num"},[t._v(t._s(a.score))])])})):i("el-empty",{attrs:{"image-size":100,description:t.$t("securitySurvey.no_data")}})],1)]),t._v(" "),i("div",{staticClass:"item-view"},[i("div",{staticClass:"item-title"},[i("div",{staticClass:"decorate"}),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.today_alarm_type")))])]),t._v(" "),i("div",{staticClass:"item-body view-modular item-padding"},[t.alarmTypeData.length>0?i("div",{staticClass:"scrollbar-view"},t._l(t.alarmTypeData,function(a,e){return i("div",{key:a.typeCode,staticClass:"alarm-type-item"},[i("div",[i("span",{staticClass:"text text-ellipsis"},[i("span",[t._v(t._s(e+1))]),t._v("\n                  "+t._s(a.typeName)+"\n                ")]),t._v(" "),i("span",{staticClass:"num"},[t._v(t._s(a.alarmCount))])]),t._v(" "),i("el-progress",{staticClass:"progress-view",attrs:{percentage:a.alarmCount/t.alarmTypeCount*100||0,color:"#36C5C4","show-text":!1}})],1)})):i("el-empty",{attrs:{"image-size":100,description:t.$t("securitySurvey.no_data")}})],1)])]),t._v(" "),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"item-view",staticStyle:{"margin-bottom":"16px"}},[i("div",{staticClass:"item-cards"},[i("div",{staticClass:"item-card"},[i("div",{staticClass:"count"},[t._v(t._s(t.alarmDistributionData.alarmTotal))]),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.today_alarm_count")))])]),t._v(" "),i("div",{staticClass:"item-card"},[i("div",{staticClass:"count"},[t._v(t._s(t.alarmDistributionData.vehicleTotal))]),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.total_car_count")))])]),t._v(" "),i("div",{staticClass:"item-card"},[i("div",{staticClass:"count"},[t._v(t._s(t.alarmDistributionData.onlineVehicle+"%"))]),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.car_online_rate")))])])])]),t._v(" "),i("div",{staticClass:"item-view"},[i("div",{staticClass:"item-title"},[i("div",{staticClass:"decorate"}),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.alarm_distribution")))])]),t._v(" "),i("div",{staticClass:"item-map"},[i("alarmDistribution",{directives:[{name:"loading",rawName:"v-loading",value:t.alarmDistributionDataLoading,expression:"alarmDistributionDataLoading"}],attrs:{"alarm-distribution-data-loading":t.alarmDistributionDataLoading,"distribution-data":t.alarmDistributionData.asAlarmTodayDataList}})],1)]),t._v(" "),i("div",{staticClass:"item-view"},[i("div",{staticClass:"item-title"},[i("div",{staticClass:"decorate"}),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.today_alarm_analysis")))])]),t._v(" "),i("div",{staticClass:"item-analysis"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.todayAlarmData.length>0,expression:"todayAlarmData.length > 0"}],staticClass:"chart",attrs:{id:"lineChart"}}),t._v(" "),i("el-empty",{directives:[{name:"show",rawName:"v-show",value:0===t.todayAlarmData.length,expression:"todayAlarmData.length === 0"}],attrs:{"image-size":100,description:t.$t("securitySurvey.no_data")}})],1)])]),t._v(" "),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"item-view"},[i("div",{staticClass:"item-title"},[i("div",{staticClass:"decorate"}),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.week_alarm")))])]),t._v(" "),i("div",{staticClass:"item-body view-modular"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.weekAlarmData.length>0,expression:"weekAlarmData.length > 0"}],staticClass:"line-chart",attrs:{id:"weekLineChart"}}),t._v(" "),i("el-empty",{directives:[{name:"show",rawName:"v-show",value:0===t.weekAlarmData.length,expression:"weekAlarmData.length === 0"}],attrs:{"image-size":100,description:t.$t("securitySurvey.no_data")}})],1)]),t._v(" "),i("div",{staticClass:"item-view"},[i("div",{staticClass:"item-title"},[i("div",{staticClass:"decorate"}),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.today_alarm_handle")))])]),t._v(" "),i("div",{staticClass:"item-body view-modular"},[i("div",{staticClass:"pie-chart",attrs:{id:"pieChart"}})])]),t._v(" "),i("div",{staticClass:"item-view"},[i("div",{staticClass:"item-title"},[i("div",{staticClass:"decorate"}),t._v(" "),i("div",{staticClass:"text"},[t._v(t._s(t.$t("securitySurvey.today_alarm_car_top")))])]),t._v(" "),i("div",{staticClass:"item-body view-modular item-padding"},[t.alarmCarData.length>0?i("div",{staticClass:"call-police-top scrollbar-view"},t._l(t.alarmCarData,function(a,e){return i("div",{key:a.vehicleId,staticClass:"call-police-top-item"},[i("span",{staticClass:"ranking-icon",class:{"ranking-icon-bg":e<3}},[t._v(t._s(e+1))]),t._v(" "),i("span",{staticClass:"car"},[t._v(t._s(a.licenseNum))]),t._v(" "),i("el-progress",{staticClass:"progress",attrs:{percentage:a.alarmCount/t.alarmCarCount*100||0,color:"#FE6968","show-text":!1}}),t._v(" "),i("span",{staticClass:"count"},[t._v(t._s(a.alarmCount))])],1)})):i("el-empty",{attrs:{"image-size":100,description:t.$t("securitySurvey.no_data")}})],1)])])],1):t._e(),t._v(" "),t.isPermission||t.$store.state.app.permsDataLoading?t._e():i("notPerm")],1)},[],!1,null,"48e24e14",null);o.options.__file="security-survey.vue";a.default=o.exports},"9B5p":function(t,a,i){},"9cr+":function(t,a,i){"use strict";var e=i("9B5p");i.n(e).a},Cili:function(t,a,i){"use strict";i.r(a);var e=i("bS4n"),s=i.n(e),r=i("8t5x");a.default={data:function(){return{permissionList:{alarmPreviewTodayRisk:"/alarm/preview/today/risk",alarmPreviewYesterdayScore:"/alarm/preview/yesterday/score",alarmPreviewTodayType:"/alarm/preview/today/type",alarmPreviewTodayLocation:"/alarm/preview/today/location",alarmPreviewTodayAnalyze:"/alarm/preview/today/analyze",alarmPreviewTodayHandle:"/alarm/preview/today/handle",alarmPreviewTodayVehicle:"/alarm/preview/today/vehicle",alarmRealtimeList:"/alarm/realtime/list",alarmRealtimeExport:"/alarm/realtime/export",alarmRealtimeAgg:"alarm/realtime/agg",alarmSummaryTypeList:"/alarm/summary/type/list/**",alarmRealtimeListCommonDetail:"alarm/realtime/list/common/detail",alarmPopUpSettingCreateOrUpdate:"/alarmPopUp/setting/createOrUpdate",alarmRealtimeSolveAlarm:"/alarm/realtime/solveAlarm",alarmSettingList:"/alarm/setting/list",alarmSettingUpdate:"/alarm/setting/update/**",alarmSettingDelete:"/alarm/setting/delete",alarmSettingCreate:"/alarm/setting/create",alarmStatisticsListVehicle:"/alarm/statistics/list/vehicle",alarmStatisticsExportVehicle:"/alarm/statistics/export/vehicle",alarmStatisticsListCompany:"/alarm/statistics/list/company",alarmStatisticsExportCompany:"/alarm/statistics/export/company"}}},computed:s()({},Object(r.b)(["permsData"]),{isAdministrator:function(){return[-1,-2].includes(Number(this.$store.getters.userData.userType))}}),watch:{permsData:{handler:function(){this.handlePermissionShow&&this.handlePermissionShow()},immediate:!0}},methods:{isPermissionShow:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!!this.isAdministrator||this.permsData.includes(this.permissionList[t])}}}},JyS4:function(t,a,i){"use strict";i.r(a);var e=i("cfOQ"),s=i.n(e),r=i("ZN1E"),n=i.n(r),l={name:"AlarmDistribution",props:{alarmDistributionDataLoading:{type:Boolean,default:!1},distributionData:{type:Array,default:function(){return[]}}},data:function(){return{markerList:[]}},watch:{distributionData:function(t){(t.length>0||!this.alarmDistributionDataLoading)&&this.initMap()}},mounted:function(){},methods:{initMap:function(){var t=new s.a.Map("map");t.centerAndZoom(new s.a.Point(105.39,36.55),5),t.enableScrollWheelZoom(!0),this.createMarkersFn(this.distributionData,t)},createMarkersFn:function(t,a){var e=this;this.markerList=[];var r=i("rNui");t.forEach(function(t){var a=new s.a.Icon(r,new s.a.Size(30,30)),i=new s.a.Point(t.longitude,t.latitude),n=new s.a.Marker(i,{icon:a});e.markerList.push(n)}),new n.a.MarkerClusterer(a,{markers:this.markerList})}}},o=(i("S5Rc"),i("ZrdR")),c=Object(o.a)(l,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"map-container",attrs:{id:"map"}})},[],!1,null,"45a21caf",null);c.options.__file="alarmDistribution.vue";a.default=c.exports},RtIc:function(t,a,i){},S5Rc:function(t,a,i){"use strict";var e=i("RtIc");i.n(e).a},jcYt:function(t,a,i){t.exports=i.p+"static/img/not-perm.d97c442.png"},rNui:function(t,a,i){t.exports=i.p+"static/img/16_jc_lx_ydw_tc_bj.6b589d9.png"}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7ef5"],{"2EUx":function(e,t,a){"use strict";a.r(t);var n=a("53CJ"),i=a("ulo4"),s=a("5JdB"),o={components:{times:n.default,mileage:i.default,remind:s.default},props:{permsData:{type:Array,default:function(){return[]}}},data:function(){return{activeName:"times"}},computed:{},created:function(){},mounted:function(){},methods:{}},r=(a("xfox"),a("ZrdR")),l=Object(r.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"box"},[a("div",{staticClass:"main"},[a("el-tabs",{staticClass:"init-tabs",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"times"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_vehicle_icon_ksnj"}),e._v(" "+e._s(e.$t("InsurancePage.right_title_1_1"))+" ")]),e._v(" "),"times"===e.activeName?a("times"):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{name:"mileage"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_vehicle_icon_ksnj"}),e._v(" "+e._s(e.$t("InsurancePage.right_title_1_2")))]),e._v(" "),"mileage"===e.activeName?a("mileage"):e._e()],1),e._v(" "),a("el-tab-pane",{attrs:{name:"remind"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("i",{staticClass:"iconfont Jamin_vehicle_icon_ksnj"}),e._v(" "+e._s(e.$t("InsurancePage.right_title_1_3")))]),e._v(" "),"remind"===e.activeName?a("remind"):e._e()],1)],1)],1)])},[],!1,null,"150162b2",null);l.options.__file="index.vue";t.default=l.exports},"5JdB":function(e,t,a){"use strict";a.r(t);var n=a("BHIJ"),i=a("AlM9"),s=a("YelX"),o={components:{TableView:i.a,drawer:n.a},mixins:[s.default],data:function(){return{drawerDisplay:!1,drawerData:{},alias:{pageSize:"pageSize",pageNum:"pageNum"},tableOptions:{data:[],total:0,columns:[{type:"slot",name:"number",title:"序号"},{title:this.$t("InsurancePage.licenseNum"),key:"licenseNum",minWidth:"130",type:"text"},{title:this.$t("InsurancePage.companyName"),key:"companyName",type:"text",minWidth:"130"},{title:this.$t("InsurancePage.deliveryDate"),key:"deliveryDate",minWidth:"130",type:"text"},{title:this.$t("InsurancePage.maintainMileage"),key:"maintainMileage",minWidth:"130",type:"text"},{title:this.$t("InsurancePage.searchControls_maintainType"),key:"maintainType",type:"tag",minWidth:"160",tags:[{value:1,text:this.$t("InsurancePage.searchControls_maintainType_key_1")},{value:2,text:this.$t("InsurancePage.searchControls_maintainType_key_2")},{value:3,text:this.$t("InsurancePage.searchControls_maintainType_key_3")}]},{title:this.$t("InsurancePage.advanceTime"),key:"advanceTime",minWidth:"220",type:"text"},{title:this.$t("operation.operation"),type:"operate",key:"operate",fixed:"right",width:"160",buttons:[]}],buttonControls:[],searchControls:[{type:"input",key:"licenseNum",placeholder:this.$t("view.license_num"),width:"200px"},{type:"treeSelect",key:"companyIds",valueKey:"companyId",placeholder:this.$t("view.searchControl_company"),width:"200px",clearable:!0,treeOption:{defaultProps:{children:"sysCompanyNodes",label:"name"},nodeKey:"companyId",defaultExpandAll:!1,expandClickNode:!1,checkbox:!0,screenFn:{bindFn:function(e,t){return!e||-1!==t.name.indexOf(e)}}},treeDefinedData:this.$parent.$parent.$parent.$parent.companyTreeData},{type:"select",key:"maintainType",placeholder:this.$t("InsurancePage.searchControls_maintainType"),width:"200px",filterable:!0,clearable:!0,options:[{name:this.$t("InsurancePage.searchControls_maintainType_key_1"),value:1},{name:this.$t("InsurancePage.searchControls_maintainType_key_2"),value:2},{name:this.$t("InsurancePage.searchControls_maintainType_key_3"),value:3}]}],footerButtons:[],paginationLayout:"total, sizes, prev, pager, next, jumper",loading:!1},params:null}},computed:{},created:function(){},mounted:function(){},methods:{handlePermissionShow:function(){this.tableOptions.buttonControls=[],this.isPermissionShow("maintainExport")&&this.tableOptions.buttonControls.push({text:this.$t("InsurancePage.buttonControls_export"),type:"null",icon:"el-icon-download",funcName:"export",dataStatus:!0}),this.tableOptions.footerButtons=[],this.isPermissionShow("maintainDelete")&&this.tableOptions.footerButtons.push({text:this.$t("operateCommon.delete"),type:"danger",icon:"el-icon-delete",funcName:"delete"});var e=this.tableOptions.columns.findIndex(function(e){return"operate"===e.key});this.tableOptions.columns[e].buttons=[],e>-1&&this.isPermissionShow("maintainUpdate")&&this.tableOptions.columns[e].buttons.push({tipText:this.$t("operation.edit"),icon:"iconfont Jamin_vehicle_icon_bj",type:"text",funcName:"edit"})},getTableData:function(e){var t=this;this.tableOptions.loading=!0;var a={licenseNum:e.licenseNum,companyIds:e.companyIds?JSON.parse(e.companyIds):[],maintainType:e.maintainType,type:2};this.$http.post("/maintain/list/advance?pageNum="+e.pageNum+"&pageSize="+e.pageSize,a).then(function(e){e.code===t.$config.API_STATUS.OK?(t.tableOptions.data=e.data.list,t.tableOptions.total=e.data.total):(t.tableOptions.data=[],t.tableOptions.total=0),t.tableOptions.loading=!1}).catch(function(){t.tableOptions.data=[],t.tableOptions.total=0,t.tableOptions.loading=!1}),this.params=e},tableResponseFn:function(e,t,a){this[t.funcName].call(function(){},e,t,a)},edit:function(e){var t=this;this.$http.get("/maintain/"+e.maintainId).then(function(a){a.code===t.$config.API_STATUS.OK&&(e=a.data,t.editData(e))})},editData:function(e){var t=this,a=function(e,a,n){t.$refs.drawer.formData.deliveryDate&&t.$refs.drawer.formData.endDate?new Date(t.$refs.drawer.formData.deliveryDate).getTime()>new Date(t.$refs.drawer.formData.endDate).getTime()?n(new Error(t.$t("confirm.confirm"))):n():n()};this.drawerDisplay=!0,this.drawerData={staticData:e,isShow:!0,title:this.$t("InsurancePage.form_editTitle"),titleWidth:"120",data:{},defaultData:"",submitAction:"/maintain/update/"+e.maintainId,btnAlign:"center",formList:[{title:this.$t("InsurancePage.form_vehicleId"),type:"treeSelect",key:"vehicleId",valueKey:"vehicleId",offsetWidth:"320",label:e.licenseNum,disabled:!0,treeOption:{defaultProps:{children:"children",label:"treeName"},nodeKey:"treeId",nodeCode:"iconfont Jamin_vehicle_icon_clgl1",defaultExpandAll:!1,expandClickNode:!1,screenFn:{bindFn:function(e,t){return!e||-1!==t.treeName.indexOf(e)}}},treeDefinedData:this.$parent.$parent.$parent.$parent.carTreeData,rules:[{required:!0,message:this.$t("InsurancePage.form_vehicleId_placeholder"),trigger:"blur"}]},{title:this.$t("InsurancePage.form_maintainType"),type:"select",key:"maintainType",offsetWidth:"320",filterable:!0,options:{type:"default",list:[{name:this.$t("InsurancePage.searchControls_maintainType_key_1"),value:1},{name:this.$t("InsurancePage.searchControls_maintainType_key_2"),value:2},{name:this.$t("InsurancePage.searchControls_maintainType_key_3"),value:3}]},rules:[{required:!0,message:this.$t("InsurancePage.form_maintainType_placeholder"),trigger:"change"}]},{title:this.$t("InsurancePage.form_maintainMileage"),type:"input",key:"maintainMileage",offsetWidth:"320",rules:[{required:!0,message:this.$t("InsurancePage.form_maintainMileage_placeholder"),trigger:"blur"}]},{title:this.$t("InsurancePage.form_deliveryDate"),type:"dateSelect",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"deliveryDate",rules:[{required:!0,message:this.$t("InsurancePage.form_deliveryDate_placeholder"),trigger:"change"},{validator:a,trigger:"change"}]},{title:this.$t("InsurancePage.form_endDate"),type:"dateSelect",valueFormat:"yyyy-MM-dd",offsetWidth:"320",key:"endDate",rules:[{required:!0,message:this.$t("InsurancePage.form_endDate_placeholder"),trigger:"change"},{validator:a,trigger:"change"}]},{title:this.$t("InsurancePage.form_cost"),type:"input",offsetWidth:"320",key:"cost"},{title:this.$t("InsurancePage.form_payer"),type:"input",offsetWidth:"320",key:"payer"},{title:this.$t("InsurancePage.form_handler"),type:"input",offsetWidth:"320",key:"handler"},{title:this.$t("InsurancePage.form_phone"),type:"input",offsetWidth:"320",key:"phone"},0===e.type?{title:this.$t("InsurancePage.form_advanceNum"),type:"input",offsetWidth:"320",key:"advanceNum",rules:[{required:!0,message:this.$t("InsurancePage.form_advanceNum_placeholder"),trigger:"blur"}]}:{title:this.$t("InsurancePage.form_intervalMileage"),type:"input",offsetWidth:"320",key:"intervalMileage",rules:[{required:!0,message:this.$t("InsurancePage.form_intervalMileage_placeholder"),trigger:"blur"}]},{title:this.$t("InsurancePage.form_content"),type:"input",offsetWidth:"320",key:"content"},{title:this.$t("InsurancePage.form_description"),type:"input",offsetWidth:"320",key:"description"},{title:this.$t("InsurancePage.form_attachedPhoto"),type:"imgUpload",offsetWidth:"320",action:this.$config.API_CONFIG.API_ROOT+"/file/upload/attachedPhoto",key:"attachedPhoto",disabled:!0,accept:"image/jpeg,image/png",headers:{Authorization:this.$store.getters.userData.tokenHead+this.$store.getters.userData.token},showFileList:!1,beforeUpload:function(e){},onProgress:function(e){},onSuccess:function(e){e.code===t.$config.API_STATUS.OK&&t.$set(t.$refs.drawer.formData,"attachedPhoto",e.data.url)}}],formButton:[{name:this.$t("confirm.determine"),type:"confirm",class:"primary"},{name:this.$t("confirm.cancel"),type:"cancel",class:""}],message:{type:"success",message:this.$t("confirm.editSuccess")}}},export:function(){var e=this;this.$confirm(this.$t("confirm.export"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),type:"warning",closeOnClickModal:!1,beforeClose:function(t,a,n){e.fieldMap={},e.tableOptions.columns.forEach(function(t){e.$refs.table.columnCheckList.forEach(function(a){t.key===a&&"operate"!==t.key&&(e.fieldMap[a]=t.title)})});var i=e.params,s=i.licenseNum,o=i.companyIds,r=i.maintainType;if("confirm"===t){var l={type:2,fieldMap:e.fieldMap,licenseNum:s,companyIds:o?JSON.parse(o):[],maintainType:r};e.tableOptions.total<e.$store.getters.userData.realtimeVideoUrl?e.$http.download("/maintain/export?isToken=true",l):e.$http.post("/maintain/export/async",l),n()}else n()}}).catch(function(){})},delete:function(e){var t=this;this.$confirm(this.$t("confirm.del"),this.$t("confirm.title"),{confirmButtonText:this.$t("confirm.determine"),cancelButtonText:this.$t("confirm.cancel"),type:"warning"}).then(function(){var a=[];e.forEach(function(e,t){a[t]=e.maintainId}),t.$http.deleteApi("/maintain/delete",{ids:a.join(",")}).then(function(e){e.code===t.$config.API_STATUS.OK&&(t.$refs.table.initRequestTableData(),t.$message({message:e.message,type:"success"}))})})},diaClose:function(e){e&&this.$refs.table.initRequestTableData(),this.drawerDisplay=!1},drawerCallback:function(e,t,a,n){this[e.handlerCallback.funcName].call(function(){},t,a,n)}}},r=(a("z9bg"),a("ZrdR")),l=Object(r.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("table-view",{ref:"table",attrs:{center:"","id-key":"maintainId","is-search":!0,"check-memory":!0,data:e.tableOptions.data,total:e.tableOptions.total,columns:e.tableOptions.columns,"search-controls":e.tableOptions.searchControls,"footer-buttons":e.tableOptions.footerButtons,"button-controls":e.tableOptions.buttonControls,"pagination-layout":e.tableOptions.paginationLayout,loading:e.tableOptions.loading,"view-table-key":"remind",checked:"","column-view":"",alias:e.alias},on:{requestTableData:e.getTableData,handleCallback:e.tableResponseFn}},[a("el-table-column",{attrs:{slot:"number",label:e.$t("view.index"),type:"index",align:"center"},slot:"number"})],1),e._v(" "),e.drawerDisplay?a("drawer",{ref:"drawer",attrs:{size:"small","drawer-data":e.drawerData},on:{diaClose:e.diaClose,handlerCallback:e.drawerCallback}}):e._e()],1)},[],!1,null,"46c2210f",null);l.options.__file="remind.vue";t.default=l.exports},"6Y/C":function(e,t,a){},dYnp:function(e,t,a){},xfox:function(e,t,a){"use strict";var n=a("6Y/C");a.n(n).a},z9bg:function(e,t,a){"use strict";var n=a("dYnp");a.n(n).a}}]);